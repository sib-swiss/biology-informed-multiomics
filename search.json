[
  {
    "objectID": "precourse_preparations.html",
    "href": "precourse_preparations.html",
    "title": "Precourse preparations",
    "section": "",
    "text": "You should meet the learning outcomes of First Steps with R in Life Sciences.\nThis course is designed for beginners in multi-omics analysis, thus no requirement for prior experience in multi-omics analysis is needed. A basic understanding of R programming and fundamental biological concepts related to gene expression and epigenetics is highly recommended. Please evaluate your R skills here."
  },
  {
    "objectID": "precourse_preparations.html#required-competences",
    "href": "precourse_preparations.html#required-competences",
    "title": "Precourse preparations",
    "section": "",
    "text": "You should meet the learning outcomes of First Steps with R in Life Sciences.\nThis course is designed for beginners in multi-omics analysis, thus no requirement for prior experience in multi-omics analysis is needed. A basic understanding of R programming and fundamental biological concepts related to gene expression and epigenetics is highly recommended. Please evaluate your R skills here."
  },
  {
    "objectID": "precourse_preparations.html#software",
    "href": "precourse_preparations.html#software",
    "title": "Precourse preparations",
    "section": "Software",
    "text": "Software\nAttendees should have a Wi-Fi enabled computer. An online R and RStudio environment will be provided. In order to access that environment your computer needs to be able to access http websites (not https). You can check this by browsing to http://www.httpforever.com. However, in case you wish to perform the practical exercises on your own computer, please take a moment to install the following before the course:\n\nR version &gt; 4.2.\nLatest RStudio version, the free version is perfectly fine.\nThe R packages necessary for the course. Find the renv to install them here."
  },
  {
    "objectID": "day2/day2-2_atac_rna.html",
    "href": "day2/day2-2_atac_rna.html",
    "title": "Exercise 5",
    "section": "",
    "text": "library(ComplexHeatmap)\nlibrary(EnrichedHeatmap)\nlibrary(circlize)\nlibrary(SummarizedExperiment)\n\n\nHere we load the SummarizedExperiment for the ChIP-seq data\n\natac &lt;- readRDS(\"data/atac_se.rds\")\nrna &lt;- readRDS(\"data/rna_se.rds\")\nrownames(colData(rna)) &lt;- gsub(pattern = \"\\\\.tsv.gz\", replacement = \"\", x = rownames(colData(rna)))\n\noverlap &lt;- readRDS(\"output/overlap_data.rds\")\n\nmat_ATAC &lt;- readRDS(\"./output/mat_atac.rds\")\nmat_RNA &lt;- readRDS(\"./output/mat_rna.rds\")\n\n\n\noverlap$ATAC_RNA &lt;- NULL\n\n# Increased accessibility and increased expression\noverlap$ATAC_RNA[overlap$ATAC_logFC &gt; 0 & overlap$RNA_logFC &gt; 0] &lt;- \"Active\"\n\n# Increased accessibility and decreased expression\noverlap$ATAC_RNA[overlap$ATAC_logFC &gt; 0 & overlap$RNA_logFC &lt; 0] &lt;- \"Repressed\"\n\n# Decreased accessibility and decreased expression\noverlap$ATAC_RNA[overlap$ATAC_logFC &lt; 0 & overlap$RNA_logFC &lt; 0] &lt;- \"Silent\"\n\n# Decreased accessibility and increased expression (incongruent)\noverlap$ATAC_RNA[overlap$ATAC_logFC &lt; 0 & overlap$RNA_logFC &gt; 0] &lt;- \"Incongruent\"\n\n# Accessibility changes, but no gene expression info\noverlap$ATAC_RNA[overlap$ATAC_logFC &lt; 0 & is.na(overlap$RNA_logFC)] &lt;- \"Dec. Acc.\"\noverlap$ATAC_RNA[overlap$ATAC_logFC &gt; 0 & is.na(overlap$RNA_logFC)] &lt;- \"Inc. Acc.\"\n\nsaveRDS(object = overlap, file = \"output/overlap_anno.rds\")\n\n\n\n\nmake_EH &lt;- function(norm_mat, heatmap_cols = c(\"white\", \"red\"), split_rows = NULL, hm_name, col_fill = \"#ffcccc\"){\n  col_fun &lt;- colorRamp2(quantile(norm_mat, c(0.01, 0.99)), heatmap_cols)  \n  \n  vmin &lt;- as.numeric(quantile(norm_mat, c(0.01)))\n  vmax &lt;- as.numeric(quantile(norm_mat, c(0.99)))\n  vmid &lt;- (vmin + vmax) / 2\n  legend_ticks &lt;- c(vmin, vmid, vmax)\n\nEnrichedHeatmap(\n  mat = norm_mat,\n  name = hm_name,\n  row_split = split_rows,\n  col = col_fun,\n  width = unit(2, \"cm\"),\n  height = unit(8, \"cm\"),\n  column_title = hm_name,\n  column_title_gp = gpar(fontsize = 8, fill = col_fill),\n  axis_name = c(\"-1kb\", \"mid\", \"1kb\"),\n  heatmap_legend_param = list(\n    at = legend_ticks,\n    legend_height = unit(0.5, \"cm\"),\n    legend_width = unit(0.1, \"cm\"),\n    labels = round(legend_ticks, digits = 1),\n    title_gp = gpar(fontsize = 8),\n    labels_gp = gpar(fontsize = 7)\n  ),\n  top_annotation = HeatmapAnnotation(\n    lines = anno_enriched(\n      height = unit(1, \"cm\"),\n      axis_param = list(\n        side = \"right\",\n        facing = \"inside\",\n        gp = gpar(\n          fontsize = 7,\n          lwd = 0.4\n        )\n      )\n    )\n  )\n)\n}\n\n\n\nsplit_anno &lt;- overlap$ATAC_RNA\nnames(split_anno) &lt;- names(overlap)\n\nhead(split_anno)\n\n     peak_1      peak_2      peak_3      peak_4      peak_5      peak_6 \n   \"Active\" \"Inc. Acc.\" \"Dec. Acc.\" \"Dec. Acc.\" \"Inc. Acc.\" \"Dec. Acc.\" \n\ncols_an &lt;- RColorBrewer::brewer.pal(n = length(unique(split_anno)), name = \"Set1\")\n\neh_11h &lt;- make_EH(norm_mat = mat_ATAC$ATAC_11half, hm_name = \"AS-E11.5\", col_fill = \"#ffcccc\")\neh_15h &lt;- make_EH(norm_mat = mat_ATAC$ATAC_15half, hm_name = \"AS-E15.5\", col_fill = \"#e6fff2\")\n\nrow_order_eh &lt;- row_order(eh_11h)\n\nanno_hm &lt;- Heatmap(\n  mat = split_anno,\n  col = cols_an, \n  name = \"Annotation\",\n  show_row_names = FALSE, \n  show_column_names = FALSE, \n  width = unit(2, \"mm\"),\n  height = unit(8, \"cm\"),\n  row_order = row_order_eh,\n  row_title_gp = gpar(fontsize = 0)\n)\n\nThere are 6 unique colors in the vector `col` and 6 unique values in\n`matrix`. `Heatmap()` will treat it as an exact discrete one-to-one\nmapping. If this is not what you want, slightly change the number of\ncolors, e.g. by adding one more color or removing a color.\n\ndraw(anno_hm + eh_11h + eh_15h, split = split_anno, merge_legend = TRUE)\n\n\n\n\n\n\n\n\n\nrna_hm &lt;- Heatmap(matrix = mat_RNA, \n        name = \"RNA\", \n        cluster_columns = FALSE, \n        cluster_rows = FALSE,\n        na_col = \"grey\",\n        row_order = row_order_eh,\n        show_row_names = FALSE, \n        show_column_names = FALSE,\n        row_title_rot = 0,\n        top_annotation = HeatmapAnnotation(\n          df = colData(rna)[,2,drop = FALSE], \n          annotation_name_gp = gpar(fontsize = 0)\n        ),\n        width = unit(2, \"cm\"),\n        height = unit(8, \"cm\"),\n        heatmap_legend_param = list(\n          legend_height = unit(0.5, \"cm\"),\n          legend_width = unit(0.1, \"cm\"),\n          at = c(-10,0,10), \n          title = \"RNA\",\n          title_gp = gpar(fontsize = 8),\n          labels_gp = gpar(fontsize = 7)\n        )\n)\n\ndraw(rna_hm, split = split_anno, merge_legend = TRUE)\n\n\n\n\n\n\n\n\n\ndraw(anno_hm + eh_11h + eh_15h + rna_hm, split = split_anno, merge_legend = TRUE)\n\n\n\n\n\n\n\n\nCan you change order of the regions? 1. Active 2. Repressed 3. Silent 4. Incongruent 5. Dec. Acc. 6. Inc. Acc.\nHint: You would have to change the factor levels of split_anno.\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\nunique(split_anno)\n\n[1] \"Active\"      \"Inc. Acc.\"   \"Dec. Acc.\"   \"Incongruent\" \"Silent\"     \n[6] \"Repressed\"  \n\nsplit_anno &lt;- factor(split_anno, levels = unique(split_anno)[c(1,6,5,4,2,3)])\n\ndraw(anno_hm + eh_11h + eh_15h + rna_hm, split = split_anno, merge_legend = FALSE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nImportant\n\n\n\nTo make the plots a bit prettier, you can run these codes before makeing the plot. You only need to run these once while you are in an R session, not before making every plot.\n\nht_opt$TITLE_PADDING &lt;- unit(1, \"mm\")\nht_opt$legend_gap &lt;- unit(3, \"mm\")\nht_opt$legend_grid_height &lt;- unit(2, \"mm\")\nht_opt$legend_grid_width &lt;- unit(2, \"mm\")\nht_opt$HEATMAP_LEGEND_PADDING &lt;- unit(1, \"mm\")\nht_opt$heatmap_border &lt;- TRUE"
  },
  {
    "objectID": "day2/day2-2_atac_rna.html#load-libraries",
    "href": "day2/day2-2_atac_rna.html#load-libraries",
    "title": "Exercise 5",
    "section": "",
    "text": "library(ComplexHeatmap)\nlibrary(EnrichedHeatmap)\nlibrary(circlize)\nlibrary(SummarizedExperiment)"
  },
  {
    "objectID": "day2/day2-2_atac_rna.html#load-required-objects-from-previous-exercises",
    "href": "day2/day2-2_atac_rna.html#load-required-objects-from-previous-exercises",
    "title": "Exercise 5",
    "section": "",
    "text": "Here we load the SummarizedExperiment for the ChIP-seq data\n\natac &lt;- readRDS(\"data/atac_se.rds\")\nrna &lt;- readRDS(\"data/rna_se.rds\")\nrownames(colData(rna)) &lt;- gsub(pattern = \"\\\\.tsv.gz\", replacement = \"\", x = rownames(colData(rna)))\n\noverlap &lt;- readRDS(\"output/overlap_data.rds\")\n\nmat_ATAC &lt;- readRDS(\"./output/mat_atac.rds\")\nmat_RNA &lt;- readRDS(\"./output/mat_rna.rds\")"
  },
  {
    "objectID": "day2/day2-2_atac_rna.html#add-possible-genomic-regions-for-atac-and-rna",
    "href": "day2/day2-2_atac_rna.html#add-possible-genomic-regions-for-atac-and-rna",
    "title": "Exercise 5",
    "section": "",
    "text": "overlap$ATAC_RNA &lt;- NULL\n\n# Increased accessibility and increased expression\noverlap$ATAC_RNA[overlap$ATAC_logFC &gt; 0 & overlap$RNA_logFC &gt; 0] &lt;- \"Active\"\n\n# Increased accessibility and decreased expression\noverlap$ATAC_RNA[overlap$ATAC_logFC &gt; 0 & overlap$RNA_logFC &lt; 0] &lt;- \"Repressed\"\n\n# Decreased accessibility and decreased expression\noverlap$ATAC_RNA[overlap$ATAC_logFC &lt; 0 & overlap$RNA_logFC &lt; 0] &lt;- \"Silent\"\n\n# Decreased accessibility and increased expression (incongruent)\noverlap$ATAC_RNA[overlap$ATAC_logFC &lt; 0 & overlap$RNA_logFC &gt; 0] &lt;- \"Incongruent\"\n\n# Accessibility changes, but no gene expression info\noverlap$ATAC_RNA[overlap$ATAC_logFC &lt; 0 & is.na(overlap$RNA_logFC)] &lt;- \"Dec. Acc.\"\noverlap$ATAC_RNA[overlap$ATAC_logFC &gt; 0 & is.na(overlap$RNA_logFC)] &lt;- \"Inc. Acc.\"\n\nsaveRDS(object = overlap, file = \"output/overlap_anno.rds\")"
  },
  {
    "objectID": "day2/day2-2_atac_rna.html#enrichedheatmap-complexheatmap",
    "href": "day2/day2-2_atac_rna.html#enrichedheatmap-complexheatmap",
    "title": "Exercise 5",
    "section": "",
    "text": "make_EH &lt;- function(norm_mat, heatmap_cols = c(\"white\", \"red\"), split_rows = NULL, hm_name, col_fill = \"#ffcccc\"){\n  col_fun &lt;- colorRamp2(quantile(norm_mat, c(0.01, 0.99)), heatmap_cols)  \n  \n  vmin &lt;- as.numeric(quantile(norm_mat, c(0.01)))\n  vmax &lt;- as.numeric(quantile(norm_mat, c(0.99)))\n  vmid &lt;- (vmin + vmax) / 2\n  legend_ticks &lt;- c(vmin, vmid, vmax)\n\nEnrichedHeatmap(\n  mat = norm_mat,\n  name = hm_name,\n  row_split = split_rows,\n  col = col_fun,\n  width = unit(2, \"cm\"),\n  height = unit(8, \"cm\"),\n  column_title = hm_name,\n  column_title_gp = gpar(fontsize = 8, fill = col_fill),\n  axis_name = c(\"-1kb\", \"mid\", \"1kb\"),\n  heatmap_legend_param = list(\n    at = legend_ticks,\n    legend_height = unit(0.5, \"cm\"),\n    legend_width = unit(0.1, \"cm\"),\n    labels = round(legend_ticks, digits = 1),\n    title_gp = gpar(fontsize = 8),\n    labels_gp = gpar(fontsize = 7)\n  ),\n  top_annotation = HeatmapAnnotation(\n    lines = anno_enriched(\n      height = unit(1, \"cm\"),\n      axis_param = list(\n        side = \"right\",\n        facing = \"inside\",\n        gp = gpar(\n          fontsize = 7,\n          lwd = 0.4\n        )\n      )\n    )\n  )\n)\n}\n\n\n\nsplit_anno &lt;- overlap$ATAC_RNA\nnames(split_anno) &lt;- names(overlap)\n\nhead(split_anno)\n\n     peak_1      peak_2      peak_3      peak_4      peak_5      peak_6 \n   \"Active\" \"Inc. Acc.\" \"Dec. Acc.\" \"Dec. Acc.\" \"Inc. Acc.\" \"Dec. Acc.\" \n\ncols_an &lt;- RColorBrewer::brewer.pal(n = length(unique(split_anno)), name = \"Set1\")\n\neh_11h &lt;- make_EH(norm_mat = mat_ATAC$ATAC_11half, hm_name = \"AS-E11.5\", col_fill = \"#ffcccc\")\neh_15h &lt;- make_EH(norm_mat = mat_ATAC$ATAC_15half, hm_name = \"AS-E15.5\", col_fill = \"#e6fff2\")\n\nrow_order_eh &lt;- row_order(eh_11h)\n\nanno_hm &lt;- Heatmap(\n  mat = split_anno,\n  col = cols_an, \n  name = \"Annotation\",\n  show_row_names = FALSE, \n  show_column_names = FALSE, \n  width = unit(2, \"mm\"),\n  height = unit(8, \"cm\"),\n  row_order = row_order_eh,\n  row_title_gp = gpar(fontsize = 0)\n)\n\nThere are 6 unique colors in the vector `col` and 6 unique values in\n`matrix`. `Heatmap()` will treat it as an exact discrete one-to-one\nmapping. If this is not what you want, slightly change the number of\ncolors, e.g. by adding one more color or removing a color.\n\ndraw(anno_hm + eh_11h + eh_15h, split = split_anno, merge_legend = TRUE)\n\n\n\n\n\n\n\n\n\nrna_hm &lt;- Heatmap(matrix = mat_RNA, \n        name = \"RNA\", \n        cluster_columns = FALSE, \n        cluster_rows = FALSE,\n        na_col = \"grey\",\n        row_order = row_order_eh,\n        show_row_names = FALSE, \n        show_column_names = FALSE,\n        row_title_rot = 0,\n        top_annotation = HeatmapAnnotation(\n          df = colData(rna)[,2,drop = FALSE], \n          annotation_name_gp = gpar(fontsize = 0)\n        ),\n        width = unit(2, \"cm\"),\n        height = unit(8, \"cm\"),\n        heatmap_legend_param = list(\n          legend_height = unit(0.5, \"cm\"),\n          legend_width = unit(0.1, \"cm\"),\n          at = c(-10,0,10), \n          title = \"RNA\",\n          title_gp = gpar(fontsize = 8),\n          labels_gp = gpar(fontsize = 7)\n        )\n)\n\ndraw(rna_hm, split = split_anno, merge_legend = TRUE)\n\n\n\n\n\n\n\n\n\ndraw(anno_hm + eh_11h + eh_15h + rna_hm, split = split_anno, merge_legend = TRUE)"
  },
  {
    "objectID": "day2/day2-2_atac_rna.html#question",
    "href": "day2/day2-2_atac_rna.html#question",
    "title": "Exercise 5",
    "section": "",
    "text": "Can you change order of the regions? 1. Active 2. Repressed 3. Silent 4. Incongruent 5. Dec. Acc. 6. Inc. Acc.\nHint: You would have to change the factor levels of split_anno.\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\nunique(split_anno)\n\n[1] \"Active\"      \"Inc. Acc.\"   \"Dec. Acc.\"   \"Incongruent\" \"Silent\"     \n[6] \"Repressed\"  \n\nsplit_anno &lt;- factor(split_anno, levels = unique(split_anno)[c(1,6,5,4,2,3)])\n\ndraw(anno_hm + eh_11h + eh_15h + rna_hm, split = split_anno, merge_legend = FALSE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nImportant\n\n\n\nTo make the plots a bit prettier, you can run these codes before makeing the plot. You only need to run these once while you are in an R session, not before making every plot.\n\nht_opt$TITLE_PADDING &lt;- unit(1, \"mm\")\nht_opt$legend_gap &lt;- unit(3, \"mm\")\nht_opt$legend_grid_height &lt;- unit(2, \"mm\")\nht_opt$legend_grid_width &lt;- unit(2, \"mm\")\nht_opt$HEATMAP_LEGEND_PADDING &lt;- unit(1, \"mm\")\nht_opt$heatmap_border &lt;- TRUE"
  },
  {
    "objectID": "day1/day1-3_chip_rna.html",
    "href": "day1/day1-3_chip_rna.html",
    "title": "Exercise 3",
    "section": "",
    "text": "By the end of this exercise, you will be able to:\n\nLoad and explore SummarizedExperiment objects for ChIP-seq and RNA-seq data.\nVisualize ChIP-seq signal enrichment across genomic regions using the EnrichedHeatmap package.\nGenerate and interpret RNA-seq expression heatmaps using the ComplexHeatmap package.\nTransform RNA-seq data to highlight differential expression using log fold-change.\nAnnotate heatmaps with sample metadata to enhance interpretability.\nSplit and visualize RNA-seq data based on gene regulation status (up- or down-regulated).\nCompare and reflect on the similarities and differences in visualization techniques between ChIP-seq and RNA-seq data.\n\n\nlibrary(SummarizedExperiment)\nlibrary(EnrichedHeatmap)\nlibrary(gUtils)\nlibrary(rtracklayer)\nlibrary(circlize)\n\n\nHere we load the SummarizedExperiment for the ChIP-seq data\n\nh3k4me3 &lt;- readRDS(\"data/h3k4me3_se.rds\")\nh3k4me1 &lt;- readRDS(\"data/h3k4me1_se.rds\")\nh3k27me3 &lt;- readRDS(\"data/h3k27me3_se.rds\")\nh3k27ac &lt;- readRDS(\"data/h3k27ac_se.rds\")\n\n\nSimilar to ATAC-seq data, please create EnrichedHeatmap for all ChIP-seq datasets and observe difference in genome activity at different genomic regions.\n\n\nrna &lt;- readRDS(\"data/rna_se.rds\")\n\n\nFor RNA-seq data, we use ComplexHeatmap package to make heatmaps\n\nHeatmap(matrix = assay(rna, \"logCPM\"), \n        name = \"RNA\", \n        cluster_columns = FALSE, \n        show_row_names = FALSE\n)\n\nWarning: The input is a data frame-like object, convert it to a matrix.\n\n\n\n\n\n\n\n\n\n\ncounts &lt;- assay(rna, \"logCPM\") - rowMeans(\n  assay(rna, \"logCPM\")[, grep(pattern = \"11half\", x = colnames(assay(rna, \"logCPM\")),\n                              value = T)]\n)\n\n\nHeatmap(matrix = counts, \n        name = \"RNA\", \n        cluster_columns = FALSE, \n        show_row_names = FALSE\n)\n\nWarning: The input is a data frame-like object, convert it to a matrix.\n\n\n\n\n\n\n\n\nIt is now more clear, which genes are up-regulated and which are down-regulated.\n\n\ncolData(rna)\n\nDataFrame with 4 rows and 2 columns\n                                 sample    group\n                            &lt;character&gt; &lt;factor&gt;\nRNA_11half_1.tsv.gz RNA_11half_1.tsv.gz   11half\nRNA_11half_2.tsv.gz RNA_11half_2.tsv.gz   11half\nRNA_15half_1.tsv.gz RNA_15half_1.tsv.gz   15half\nRNA_15half_2.tsv.gz RNA_15half_2.tsv.gz   15half\n\n\nWe can add groups information to the heatmap\n\nHeatmap(matrix = counts, \n        name = \"RNA\", \n        cluster_columns = FALSE, \n        show_row_names = FALSE, \n        show_column_names = FALSE,\n        top_annotation = HeatmapAnnotation(df = colData(rna)[,2,drop = FALSE]),\n        width = unit(4, \"cm\"),\n        height = unit(8, \"cm\"),\n        heatmap_legend_param = list(\n            at = scales::pretty_breaks(n = 3)(range(counts, na.rm = TRUE)), \n            title = \"RNA\"\n        )\n)\n\nWarning: The input is a data frame-like object, convert it to a matrix.\n\n\n\n\n\n\n\n\n\nSimilar to EnrichedHeatmap, we can also split RNA-seq data based on logFC. Can you try to do this?\n\n\n\n\n\n\nTip\n\n\n\n\n\n\nlogFC &lt;- rowData(rna)[,\"logFC\"]\nnames(logFC) &lt;- rownames(rowData(rna))\n\nlogFC &lt;- ifelse(logFC &gt; 0, \"Up regulated\", \"Down regulated\")\n\nHeatmap(matrix = counts, \n        name = \"RNA\", \n        cluster_columns = FALSE, \n        show_row_names = FALSE, \n        show_column_names = FALSE,\n        top_annotation = HeatmapAnnotation(df = colData(rna)[,2,drop = FALSE]),\n        width = unit(4, \"cm\"),\n        height = unit(8, \"cm\"),\n        heatmap_legend_param = list(\n            at = scales::pretty_breaks(n = 3)(range(counts, na.rm = TRUE)), \n            title = \"RNA\"\n        ),\n        row_split = logFC\n)\n\nWarning: The input is a data frame-like object, convert it to a matrix.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nImportant\n\n\n\nHeatmap and EnrichedHeatmap have a lot of options common."
  },
  {
    "objectID": "day1/day1-3_chip_rna.html#learning-objectives",
    "href": "day1/day1-3_chip_rna.html#learning-objectives",
    "title": "Exercise 3",
    "section": "",
    "text": "By the end of this exercise, you will be able to:\n\nLoad and explore SummarizedExperiment objects for ChIP-seq and RNA-seq data.\nVisualize ChIP-seq signal enrichment across genomic regions using the EnrichedHeatmap package.\nGenerate and interpret RNA-seq expression heatmaps using the ComplexHeatmap package.\nTransform RNA-seq data to highlight differential expression using log fold-change.\nAnnotate heatmaps with sample metadata to enhance interpretability.\nSplit and visualize RNA-seq data based on gene regulation status (up- or down-regulated).\nCompare and reflect on the similarities and differences in visualization techniques between ChIP-seq and RNA-seq data."
  },
  {
    "objectID": "day1/day1-3_chip_rna.html#load-libraries",
    "href": "day1/day1-3_chip_rna.html#load-libraries",
    "title": "Exercise 3",
    "section": "",
    "text": "library(SummarizedExperiment)\nlibrary(EnrichedHeatmap)\nlibrary(gUtils)\nlibrary(rtracklayer)\nlibrary(circlize)"
  },
  {
    "objectID": "day1/day1-3_chip_rna.html#chip-seq-se-object",
    "href": "day1/day1-3_chip_rna.html#chip-seq-se-object",
    "title": "Exercise 3",
    "section": "",
    "text": "Here we load the SummarizedExperiment for the ChIP-seq data\n\nh3k4me3 &lt;- readRDS(\"data/h3k4me3_se.rds\")\nh3k4me1 &lt;- readRDS(\"data/h3k4me1_se.rds\")\nh3k27me3 &lt;- readRDS(\"data/h3k27me3_se.rds\")\nh3k27ac &lt;- readRDS(\"data/h3k27ac_se.rds\")"
  },
  {
    "objectID": "day1/day1-3_chip_rna.html#question-1",
    "href": "day1/day1-3_chip_rna.html#question-1",
    "title": "Exercise 3",
    "section": "",
    "text": "Similar to ATAC-seq data, please create EnrichedHeatmap for all ChIP-seq datasets and observe difference in genome activity at different genomic regions."
  },
  {
    "objectID": "day1/day1-3_chip_rna.html#rna-seq-data",
    "href": "day1/day1-3_chip_rna.html#rna-seq-data",
    "title": "Exercise 3",
    "section": "",
    "text": "rna &lt;- readRDS(\"data/rna_se.rds\")"
  },
  {
    "objectID": "day1/day1-3_chip_rna.html#heatmap-of-counts",
    "href": "day1/day1-3_chip_rna.html#heatmap-of-counts",
    "title": "Exercise 3",
    "section": "",
    "text": "For RNA-seq data, we use ComplexHeatmap package to make heatmaps\n\nHeatmap(matrix = assay(rna, \"logCPM\"), \n        name = \"RNA\", \n        cluster_columns = FALSE, \n        show_row_names = FALSE\n)\n\nWarning: The input is a data frame-like object, convert it to a matrix.\n\n\n\n\n\n\n\n\n\n\ncounts &lt;- assay(rna, \"logCPM\") - rowMeans(\n  assay(rna, \"logCPM\")[, grep(pattern = \"11half\", x = colnames(assay(rna, \"logCPM\")),\n                              value = T)]\n)\n\n\nHeatmap(matrix = counts, \n        name = \"RNA\", \n        cluster_columns = FALSE, \n        show_row_names = FALSE\n)\n\nWarning: The input is a data frame-like object, convert it to a matrix.\n\n\n\n\n\n\n\n\nIt is now more clear, which genes are up-regulated and which are down-regulated.\n\n\ncolData(rna)\n\nDataFrame with 4 rows and 2 columns\n                                 sample    group\n                            &lt;character&gt; &lt;factor&gt;\nRNA_11half_1.tsv.gz RNA_11half_1.tsv.gz   11half\nRNA_11half_2.tsv.gz RNA_11half_2.tsv.gz   11half\nRNA_15half_1.tsv.gz RNA_15half_1.tsv.gz   15half\nRNA_15half_2.tsv.gz RNA_15half_2.tsv.gz   15half\n\n\nWe can add groups information to the heatmap\n\nHeatmap(matrix = counts, \n        name = \"RNA\", \n        cluster_columns = FALSE, \n        show_row_names = FALSE, \n        show_column_names = FALSE,\n        top_annotation = HeatmapAnnotation(df = colData(rna)[,2,drop = FALSE]),\n        width = unit(4, \"cm\"),\n        height = unit(8, \"cm\"),\n        heatmap_legend_param = list(\n            at = scales::pretty_breaks(n = 3)(range(counts, na.rm = TRUE)), \n            title = \"RNA\"\n        )\n)\n\nWarning: The input is a data frame-like object, convert it to a matrix."
  },
  {
    "objectID": "day1/day1-3_chip_rna.html#question-2",
    "href": "day1/day1-3_chip_rna.html#question-2",
    "title": "Exercise 3",
    "section": "",
    "text": "Similar to EnrichedHeatmap, we can also split RNA-seq data based on logFC. Can you try to do this?\n\n\n\n\n\n\nTip\n\n\n\n\n\n\nlogFC &lt;- rowData(rna)[,\"logFC\"]\nnames(logFC) &lt;- rownames(rowData(rna))\n\nlogFC &lt;- ifelse(logFC &gt; 0, \"Up regulated\", \"Down regulated\")\n\nHeatmap(matrix = counts, \n        name = \"RNA\", \n        cluster_columns = FALSE, \n        show_row_names = FALSE, \n        show_column_names = FALSE,\n        top_annotation = HeatmapAnnotation(df = colData(rna)[,2,drop = FALSE]),\n        width = unit(4, \"cm\"),\n        height = unit(8, \"cm\"),\n        heatmap_legend_param = list(\n            at = scales::pretty_breaks(n = 3)(range(counts, na.rm = TRUE)), \n            title = \"RNA\"\n        ),\n        row_split = logFC\n)\n\nWarning: The input is a data frame-like object, convert it to a matrix.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nImportant\n\n\n\nHeatmap and EnrichedHeatmap have a lot of options common."
  },
  {
    "objectID": "day1/day1-1_dataset.html",
    "href": "day1/day1-1_dataset.html",
    "title": "Exercise 1",
    "section": "",
    "text": "By the end of this notebook, you will be able to:\n\nUnderstand the structure of SummarizedExperiment and GRanges objects in R.\nAccess and manipulate metadata and assays within SummarizedExperiment.\nVisualize and subset genomic intervals using GRanges.\nRecognize how even RNA expression data can be stored as genomic ranges.\n\n\n\n\n\n\n\nNote\n\n\n\nNote: Genomic data types like RNA-seq are often stored as SummarizedExperiment or GRanges, which are efficient for multi-omics integration."
  },
  {
    "objectID": "day1/day1-1_dataset.html#learning-outcomes",
    "href": "day1/day1-1_dataset.html#learning-outcomes",
    "title": "Exercise 1",
    "section": "",
    "text": "By the end of this notebook, you will be able to:\n\nUnderstand the structure of SummarizedExperiment and GRanges objects in R.\nAccess and manipulate metadata and assays within SummarizedExperiment.\nVisualize and subset genomic intervals using GRanges.\nRecognize how even RNA expression data can be stored as genomic ranges.\n\n\n\n\n\n\n\nNote\n\n\n\nNote: Genomic data types like RNA-seq are often stored as SummarizedExperiment or GRanges, which are efficient for multi-omics integration."
  },
  {
    "objectID": "day1/day1-1_dataset.html#download-and-extract-data",
    "href": "day1/day1-1_dataset.html#download-and-extract-data",
    "title": "Exercise 1",
    "section": "Download and Extract Data",
    "text": "Download and Extract Data\n\n# Create a new directory\ndir.create(\"data\")\n\n# Set download limit higher\noptions(timeout=1000)\n\n# Download file\ndownload.file(\n  url = \"https://biology-informed-multiomics.s3.eu-central-1.amazonaws.com/biology-informed-multiomics.tar\",\n  destfile = \"data/data.tar\"\n)\n\n# Unzip file\nuntar(tarfile = \"data/data.tar\", exdir = \"data\")\n\n# Remove tar file\nfile.remove(\"data/data.tar\")"
  },
  {
    "objectID": "day1/day1-1_dataset.html#load-libraries",
    "href": "day1/day1-1_dataset.html#load-libraries",
    "title": "Exercise 1",
    "section": "Load Libraries",
    "text": "Load Libraries\n\nlibrary(ComplexHeatmap)\nlibrary(SummarizedExperiment)\nlibrary(ggplot2)"
  },
  {
    "objectID": "day1/day1-1_dataset.html#load-summarizedexperiment-objects",
    "href": "day1/day1-1_dataset.html#load-summarizedexperiment-objects",
    "title": "Exercise 1",
    "section": "Load SummarizedExperiment Objects",
    "text": "Load SummarizedExperiment Objects\n\nrna &lt;- readRDS(\"data/rna_se.rds\")\natac &lt;- readRDS(\"data/atac_se.rds\")\nh3k4me3 &lt;- readRDS(\"data/h3k4me3_se.rds\")\nh3k4me1 &lt;- readRDS(\"data/h3k4me1_se.rds\")\nh3k27me3 &lt;- readRDS(\"data/h3k27me3_se.rds\")\nh3k27ac &lt;- readRDS(\"data/h3k27ac_se.rds\")"
  },
  {
    "objectID": "day1/day1-1_dataset.html#exercise-1-working-with-summarizedexperiment-se",
    "href": "day1/day1-1_dataset.html#exercise-1-working-with-summarizedexperiment-se",
    "title": "Exercise 1",
    "section": "🧪 Exercise 1: Working with SummarizedExperiment (SE)",
    "text": "🧪 Exercise 1: Working with SummarizedExperiment (SE)\n1. Inspect the RNA SE Object\n\nrna\n\nclass: RangedSummarizedExperiment \ndim: 2216 4 \nmetadata(0):\nassays(2): counts logCPM\nrownames(2216): ENSMUSG00000000194 ENSMUSG00000000247 ...\n  ENSMUSG00000103948 ENSMUSG00000104257\nrowData names(18): Row.names gene_id ... PValue qvalue\ncolnames(4): RNA_11half_1.tsv.gz RNA_11half_2.tsv.gz\n  RNA_15half_1.tsv.gz RNA_15half_2.tsv.gz\ncolData names(2): sample group\n\n\n2. Access rowRanges, colData, and assays\n\n\nrowRanges(rna)[1:5]\n\nGRanges object with 5 ranges and 18 metadata columns:\n                     seqnames              ranges strand |          Row.names\n                        &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; |        &lt;character&gt;\n  ENSMUSG00000000194     chr2   31152316-31218775      + | ENSMUSG00000000194\n  ENSMUSG00000000247     chr2   38339281-38369733      + | ENSMUSG00000000247\n  ENSMUSG00000000305     chr2 179442431-179899373      + | ENSMUSG00000000305\n  ENSMUSG00000000308     chr2 121357714-121363737      + | ENSMUSG00000000308\n  ENSMUSG00000000359     chr2 152626951-152635198      + | ENSMUSG00000000359\n                         gene_id      SYMBOL               GENENAME\n                     &lt;character&gt; &lt;character&gt;            &lt;character&gt;\n  ENSMUSG00000000194      277463      Gpr107 G protein-coupled re..\n  ENSMUSG00000000247       16870        Lhx2 LIM homeobox protein 2\n  ENSMUSG00000000305       12561        Cdh4             cadherin 4\n  ENSMUSG00000000308       12716       Ckmt1 creatine kinase, mit..\n  ENSMUSG00000000359       19700        Rem1 rad and gem related ..\n                                ENSEMBL geneLength     geneChr geneStart\n                            &lt;character&gt;  &lt;integer&gt; &lt;character&gt; &lt;integer&gt;\n  ENSMUSG00000000194 ENSMUSG00000000194      66460        chr2  31152316\n  ENSMUSG00000000247 ENSMUSG00000000247      30453        chr2  38339281\n  ENSMUSG00000000305 ENSMUSG00000000305     456943        chr2 179442431\n  ENSMUSG00000000308 ENSMUSG00000000308       6024        chr2 121357714\n  ENSMUSG00000000359 ENSMUSG00000000359       8248        chr2 152626951\n                       geneEnd  geneStrand      geneId          transcriptId\n                     &lt;integer&gt; &lt;character&gt; &lt;character&gt;           &lt;character&gt;\n  ENSMUSG00000000194  31218775           +      277463  ENSMUST00000056433.6\n  ENSMUSG00000000247  38369733           +       16870  ENSMUST00000143783.8\n  ENSMUSG00000000305 179899373           +       12561 ENSMUST00000000314.12\n  ENSMUSG00000000308 121363737           +       12716  ENSMUST00000125812.7\n  ENSMUSG00000000359 152635198           +       19700  ENSMUST00000000369.3\n                            anno     logFC    logCPM         F      PValue\n                     &lt;character&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;   &lt;numeric&gt;\n  ENSMUSG00000000194        Gene   1.12372   8.74812 137.26552 8.72516e-05\n  ENSMUSG00000000247        Gene  -1.60859   5.40640  11.86742 1.87646e-02\n  ENSMUSG00000000305        Gene   2.11822   9.25294 504.51658 3.72434e-06\n  ENSMUSG00000000308        Gene   3.79826   8.63364 420.96960 5.79582e-06\n  ENSMUSG00000000359        Gene   1.90855   3.12253   2.67341 1.64139e-01\n                          qvalue\n                       &lt;numeric&gt;\n  ENSMUSG00000000194 0.000834921\n  ENSMUSG00000000247 0.033322641\n  ENSMUSG00000000305 0.000490337\n  ENSMUSG00000000308 0.000490337\n  ENSMUSG00000000359 0.211786009\n  -------\n  seqinfo: 66 sequences from an unspecified genome; no seqlengths\n\ncolData(rna)\n\nDataFrame with 4 rows and 2 columns\n                                 sample    group\n                            &lt;character&gt; &lt;factor&gt;\nRNA_11half_1.tsv.gz RNA_11half_1.tsv.gz   11half\nRNA_11half_2.tsv.gz RNA_11half_2.tsv.gz   11half\nRNA_15half_1.tsv.gz RNA_15half_1.tsv.gz   15half\nRNA_15half_2.tsv.gz RNA_15half_2.tsv.gz   15half\n\nassay(rna)[1:5,]\n\n                   RNA_11half_1.tsv.gz RNA_11half_2.tsv.gz RNA_15half_1.tsv.gz\nENSMUSG00000000194                 848              893.35             2619.55\nENSMUSG00000000247                 169              246.00               51.00\nENSMUSG00000000305                 694              778.00             4431.00\nENSMUSG00000000308                 148              195.00             3011.00\nENSMUSG00000000359                   8               13.00              101.00\n                   RNA_15half_2.tsv.gz\nENSMUSG00000000194             3046.41\nENSMUSG00000000247              153.00\nENSMUSG00000000305             5102.00\nENSMUSG00000000308             4131.00\nENSMUSG00000000359               16.00\n\nassays(rna)\n\nList of length 2\nnames(2): counts logCPM\n\n\n3. Boxplot of Expression for a Few Genes\n\ndf &lt;- as.data.frame(t(assay(rna)[1:5, ]))\ndf$sample &lt;- rownames(df)\ndf_long &lt;- pivot_longer(df, -sample, names_to = \"gene\", values_to = \"expression\")\n\nggplot(df_long, aes(x = gene, y = expression)) +\n  geom_boxplot(aes(fill = gene)) +\n  theme_bw() +\n  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +\n  labs(title = \"Expression Distribution of Selected Genes\",\n       y = \"Expression\", x = \"Genes\") +\n  scale_fill_brewer(palette = \"Set2\")"
  },
  {
    "objectID": "day1/day1-1_dataset.html#question-1",
    "href": "day1/day1-1_dataset.html#question-1",
    "title": "Exercise 1",
    "section": "Question 1",
    "text": "Question 1\nPlease make a boxplot of samples, before and after normalization.\nHint: Check assays of rna object. Raw counts should be converted to log2 to make a comparison.\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\n# Extract assays\nraw_counts &lt;- assay(rna, \"counts\")\nlogcpm &lt;- assay(rna, \"logCPM\")\n\n# Convert to long data frames for ggplot\ndf_raw &lt;- as.data.frame(raw_counts)\ndf_raw$gene &lt;- rownames(df_raw)\ndf_raw_long &lt;- pivot_longer(df_raw, -gene, names_to = \"sample\", values_to = \"expression\")\ndf_raw_long$assay &lt;- \"Raw Counts\"\ndf_raw_long$expression &lt;- log2(df_raw_long$expression + 1)\n\ndf_log &lt;- as.data.frame(logcpm)\ndf_log$gene &lt;- rownames(df_log)\ndf_log_long &lt;- pivot_longer(df_log, -gene, names_to = \"sample\", values_to = \"expression\")\ndf_log_long$assay &lt;- \"logCPM\"\n\n# Combine both\ndf_combined &lt;- rbind(df_raw_long, df_log_long)\n\n# Set factor for names to make Raw counts to be plotted first\ndf_combined$assay &lt;- factor(df_combined$assay, levels = unique(df_combined$assay))\n\n# Plot boxplot across samples\nggplot(df_combined, aes(x = sample, y = expression, fill = assay)) +\n  geom_boxplot(outlier.size = 0.5, lwd = 0.3) +\n  theme_bw() +\n  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +\n  facet_wrap(~ assay, scales = \"free_y\") +\n  labs(title = \"Sample-wise Expression: Raw vs Normalized\",\n       x = \"Samples\", y = \"Expression\") +\n  scale_fill_brewer(palette = \"Set2\")"
  },
  {
    "objectID": "day1/day1-1_dataset.html#question-2",
    "href": "day1/day1-1_dataset.html#question-2",
    "title": "Exercise 1",
    "section": "Question 2",
    "text": "Question 2\nMake a new SummarizedExperiment object by subsetting rna. Take only first 2 samples and first 10 genes. Check the assays, row and column metadata.\n\n\n\n\n\n\nTip\n\n\n\n\n\n\nrna_subset &lt;- rna[1:10, 1:2]\nrna_subset\n\nclass: RangedSummarizedExperiment \ndim: 10 2 \nmetadata(0):\nassays(2): counts logCPM\nrownames(10): ENSMUSG00000000194 ENSMUSG00000000247 ...\n  ENSMUSG00000000827 ENSMUSG00000000876\nrowData names(18): Row.names gene_id ... PValue qvalue\ncolnames(2): RNA_11half_1.tsv.gz RNA_11half_2.tsv.gz\ncolData names(2): sample group\n\nassays(rna_subset)\n\nList of length 2\nnames(2): counts logCPM\n\nassay(rna_subset, \"counts\")\n\n                   RNA_11half_1.tsv.gz RNA_11half_2.tsv.gz\nENSMUSG00000000194              848.00              893.35\nENSMUSG00000000247              169.00              246.00\nENSMUSG00000000305              694.00              778.00\nENSMUSG00000000308              148.00              195.00\nENSMUSG00000000359                8.00               13.00\nENSMUSG00000000392              349.00              333.00\nENSMUSG00000000823             1851.87             2077.29\nENSMUSG00000000826             5908.00             7011.00\nENSMUSG00000000827             2788.23             2998.49\nENSMUSG00000000876              374.00              400.00\n\nassay(rna_subset, \"logCPM\")\n\n                   RNA_11half_1.tsv.gz RNA_11half_2.tsv.gz\nENSMUSG00000000194            8.086697            8.068900\nENSMUSG00000000247            5.764953            6.211847\nENSMUSG00000000305            7.797861            7.869643\nENSMUSG00000000308            5.574463            5.877929\nENSMUSG00000000359            1.491187            2.054079\nENSMUSG00000000392            6.807747            6.647445\nENSMUSG00000000823            9.212828            9.285543\nENSMUSG00000000826           10.886099           11.040056\nENSMUSG00000000827            9.802991            9.814900\nENSMUSG00000000876            6.907344            6.911323\n\ncolData(rna_subset)\n\nDataFrame with 2 rows and 2 columns\n                                 sample    group\n                            &lt;character&gt; &lt;factor&gt;\nRNA_11half_1.tsv.gz RNA_11half_1.tsv.gz   11half\nRNA_11half_2.tsv.gz RNA_11half_2.tsv.gz   11half\n\nrowData(rna_subset)\n\nDataFrame with 10 rows and 18 columns\n                            Row.names     gene_id      SYMBOL\n                          &lt;character&gt; &lt;character&gt; &lt;character&gt;\nENSMUSG00000000194 ENSMUSG00000000194      277463      Gpr107\nENSMUSG00000000247 ENSMUSG00000000247       16870        Lhx2\nENSMUSG00000000305 ENSMUSG00000000305       12561        Cdh4\nENSMUSG00000000308 ENSMUSG00000000308       12716       Ckmt1\nENSMUSG00000000359 ENSMUSG00000000359       19700        Rem1\nENSMUSG00000000392 ENSMUSG00000000392       14089         Fap\nENSMUSG00000000823 ENSMUSG00000000823      269401     Zfp512b\nENSMUSG00000000826 ENSMUSG00000000826       13002      Dnajc5\nENSMUSG00000000827 ENSMUSG00000000827       66314     Tpd52l2\nENSMUSG00000000876 ENSMUSG00000000876       59038       Pxmp4\n                                 GENENAME            ENSEMBL geneLength\n                              &lt;character&gt;        &lt;character&gt;  &lt;integer&gt;\nENSMUSG00000000194 G protein-coupled re.. ENSMUSG00000000194      66460\nENSMUSG00000000247 LIM homeobox protein 2 ENSMUSG00000000247      30453\nENSMUSG00000000305             cadherin 4 ENSMUSG00000000305     456943\nENSMUSG00000000308 creatine kinase, mit.. ENSMUSG00000000308       6024\nENSMUSG00000000359 rad and gem related .. ENSMUSG00000000359       8248\nENSMUSG00000000392 fibroblast activatio.. ENSMUSG00000000392      73133\nENSMUSG00000000823 zinc finger protein .. ENSMUSG00000000823      10701\nENSMUSG00000000826 DnaJ heat shock prot.. ENSMUSG00000000826      34649\nENSMUSG00000000827 tumor protein D52-li.. ENSMUSG00000000827      20825\nENSMUSG00000000876 peroxisomal membrane.. ENSMUSG00000000876      17951\n                       geneChr geneStart   geneEnd  geneStrand      geneId\n                   &lt;character&gt; &lt;integer&gt; &lt;integer&gt; &lt;character&gt; &lt;character&gt;\nENSMUSG00000000194        chr2  31152316  31218775           +      277463\nENSMUSG00000000247        chr2  38339281  38369733           +       16870\nENSMUSG00000000305        chr2 179442431 179899373           +       12561\nENSMUSG00000000308        chr2 121357714 121363737           +       12716\nENSMUSG00000000359        chr2 152626951 152635198           +       19700\nENSMUSG00000000392        chr2  62500943  62574075           -       14089\nENSMUSG00000000823        chr2 181582103 181592803           -      269401\nENSMUSG00000000826        chr2 181520485 181555133           +       13002\nENSMUSG00000000827        chr2 181497142 181517966           +       66314\nENSMUSG00000000876        chr2 154585758 154603708           -       59038\n                            transcriptId        anno     logFC    logCPM\n                             &lt;character&gt; &lt;character&gt; &lt;numeric&gt; &lt;numeric&gt;\nENSMUSG00000000194  ENSMUST00000056433.6        Gene  1.123717   8.74812\nENSMUSG00000000247  ENSMUST00000143783.8        Gene -1.608592   5.40640\nENSMUSG00000000305 ENSMUST00000000314.12        Gene  2.118219   9.25294\nENSMUSG00000000308  ENSMUST00000125812.7        Gene  3.798256   8.63364\nENSMUSG00000000359  ENSMUST00000000369.3        Gene  1.908545   3.12253\nENSMUSG00000000392  ENSMUST00000102732.9        Gene -2.102269   6.02595\nENSMUSG00000000823  ENSMUST00000108789.8        Gene  0.776790   9.69040\nENSMUSG00000000826 ENSMUST00000072334.11        Gene  0.991148  11.54446\nENSMUSG00000000827  ENSMUST00000184588.7        Gene -0.557763   9.55700\nENSMUSG00000000876 ENSMUST00000000896.10        Gene  0.304488   7.07357\n                           F      PValue      qvalue\n                   &lt;numeric&gt;   &lt;numeric&gt;   &lt;numeric&gt;\nENSMUSG00000000194 137.26552 8.72516e-05 0.000834921\nENSMUSG00000000247  11.86742 1.87646e-02 0.033322641\nENSMUSG00000000305 504.51658 3.72434e-06 0.000490337\nENSMUSG00000000308 420.96960 5.79582e-06 0.000490337\nENSMUSG00000000359   2.67341 1.64139e-01 0.211786009\nENSMUSG00000000392  82.37588 2.92695e-04 0.001579555\nENSMUSG00000000823  21.64298 5.77573e-03 0.012874947\nENSMUSG00000000826  77.71581 3.35396e-04 0.001683051\nENSMUSG00000000827  46.64975 1.08655e-03 0.003701948\nENSMUSG00000000876   4.36632 9.17564e-02 0.127276923\n\nrowRanges(rna_subset)\n\nGRanges object with 10 ranges and 18 metadata columns:\n                     seqnames              ranges strand |          Row.names\n                        &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; |        &lt;character&gt;\n  ENSMUSG00000000194     chr2   31152316-31218775      + | ENSMUSG00000000194\n  ENSMUSG00000000247     chr2   38339281-38369733      + | ENSMUSG00000000247\n  ENSMUSG00000000305     chr2 179442431-179899373      + | ENSMUSG00000000305\n  ENSMUSG00000000308     chr2 121357714-121363737      + | ENSMUSG00000000308\n  ENSMUSG00000000359     chr2 152626951-152635198      + | ENSMUSG00000000359\n  ENSMUSG00000000392     chr2   62500943-62574075      - | ENSMUSG00000000392\n  ENSMUSG00000000823     chr2 181582103-181592803      - | ENSMUSG00000000823\n  ENSMUSG00000000826     chr2 181520485-181555133      + | ENSMUSG00000000826\n  ENSMUSG00000000827     chr2 181497142-181517966      + | ENSMUSG00000000827\n  ENSMUSG00000000876     chr2 154585758-154603708      - | ENSMUSG00000000876\n                         gene_id      SYMBOL               GENENAME\n                     &lt;character&gt; &lt;character&gt;            &lt;character&gt;\n  ENSMUSG00000000194      277463      Gpr107 G protein-coupled re..\n  ENSMUSG00000000247       16870        Lhx2 LIM homeobox protein 2\n  ENSMUSG00000000305       12561        Cdh4             cadherin 4\n  ENSMUSG00000000308       12716       Ckmt1 creatine kinase, mit..\n  ENSMUSG00000000359       19700        Rem1 rad and gem related ..\n  ENSMUSG00000000392       14089         Fap fibroblast activatio..\n  ENSMUSG00000000823      269401     Zfp512b zinc finger protein ..\n  ENSMUSG00000000826       13002      Dnajc5 DnaJ heat shock prot..\n  ENSMUSG00000000827       66314     Tpd52l2 tumor protein D52-li..\n  ENSMUSG00000000876       59038       Pxmp4 peroxisomal membrane..\n                                ENSEMBL geneLength     geneChr geneStart\n                            &lt;character&gt;  &lt;integer&gt; &lt;character&gt; &lt;integer&gt;\n  ENSMUSG00000000194 ENSMUSG00000000194      66460        chr2  31152316\n  ENSMUSG00000000247 ENSMUSG00000000247      30453        chr2  38339281\n  ENSMUSG00000000305 ENSMUSG00000000305     456943        chr2 179442431\n  ENSMUSG00000000308 ENSMUSG00000000308       6024        chr2 121357714\n  ENSMUSG00000000359 ENSMUSG00000000359       8248        chr2 152626951\n  ENSMUSG00000000392 ENSMUSG00000000392      73133        chr2  62500943\n  ENSMUSG00000000823 ENSMUSG00000000823      10701        chr2 181582103\n  ENSMUSG00000000826 ENSMUSG00000000826      34649        chr2 181520485\n  ENSMUSG00000000827 ENSMUSG00000000827      20825        chr2 181497142\n  ENSMUSG00000000876 ENSMUSG00000000876      17951        chr2 154585758\n                       geneEnd  geneStrand      geneId          transcriptId\n                     &lt;integer&gt; &lt;character&gt; &lt;character&gt;           &lt;character&gt;\n  ENSMUSG00000000194  31218775           +      277463  ENSMUST00000056433.6\n  ENSMUSG00000000247  38369733           +       16870  ENSMUST00000143783.8\n  ENSMUSG00000000305 179899373           +       12561 ENSMUST00000000314.12\n  ENSMUSG00000000308 121363737           +       12716  ENSMUST00000125812.7\n  ENSMUSG00000000359 152635198           +       19700  ENSMUST00000000369.3\n  ENSMUSG00000000392  62574075           -       14089  ENSMUST00000102732.9\n  ENSMUSG00000000823 181592803           -      269401  ENSMUST00000108789.8\n  ENSMUSG00000000826 181555133           +       13002 ENSMUST00000072334.11\n  ENSMUSG00000000827 181517966           +       66314  ENSMUST00000184588.7\n  ENSMUSG00000000876 154603708           -       59038 ENSMUST00000000896.10\n                            anno     logFC    logCPM         F      PValue\n                     &lt;character&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;   &lt;numeric&gt;\n  ENSMUSG00000000194        Gene  1.123717   8.74812 137.26552 8.72516e-05\n  ENSMUSG00000000247        Gene -1.608592   5.40640  11.86742 1.87646e-02\n  ENSMUSG00000000305        Gene  2.118219   9.25294 504.51658 3.72434e-06\n  ENSMUSG00000000308        Gene  3.798256   8.63364 420.96960 5.79582e-06\n  ENSMUSG00000000359        Gene  1.908545   3.12253   2.67341 1.64139e-01\n  ENSMUSG00000000392        Gene -2.102269   6.02595  82.37588 2.92695e-04\n  ENSMUSG00000000823        Gene  0.776790   9.69040  21.64298 5.77573e-03\n  ENSMUSG00000000826        Gene  0.991148  11.54446  77.71581 3.35396e-04\n  ENSMUSG00000000827        Gene -0.557763   9.55700  46.64975 1.08655e-03\n  ENSMUSG00000000876        Gene  0.304488   7.07357   4.36632 9.17564e-02\n                          qvalue\n                       &lt;numeric&gt;\n  ENSMUSG00000000194 0.000834921\n  ENSMUSG00000000247 0.033322641\n  ENSMUSG00000000305 0.000490337\n  ENSMUSG00000000308 0.000490337\n  ENSMUSG00000000359 0.211786009\n  ENSMUSG00000000392 0.001579555\n  ENSMUSG00000000823 0.012874947\n  ENSMUSG00000000826 0.001683051\n  ENSMUSG00000000827 0.003701948\n  ENSMUSG00000000876 0.127276923\n  -------\n  seqinfo: 66 sequences from an unspecified genome; no seqlengths"
  },
  {
    "objectID": "day1/day1-1_dataset.html#question-3",
    "href": "day1/day1-1_dataset.html#question-3",
    "title": "Exercise 1",
    "section": "Question 3",
    "text": "Question 3\nTry to run all other commands from the following image on other SE objects as well"
  },
  {
    "objectID": "day1/day1-1_dataset.html#exercise-2-working-with-granges",
    "href": "day1/day1-1_dataset.html#exercise-2-working-with-granges",
    "title": "Exercise 1",
    "section": "🧪 Exercise 2: Working with GRanges\n",
    "text": "🧪 Exercise 2: Working with GRanges\n\n1. Extract and Inspect GRanges from ATAC-seq\n\ngr &lt;- rowRanges(atac)\ngr\n\nGRanges object with 3656 ranges and 18 metadata columns:\n         seqnames              ranges strand |             annotation   geneChr\n            &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; |            &lt;character&gt; &lt;integer&gt;\n     [1]     chr1     3670547-3672665      * |       Promoter (&lt;=1kb)         1\n     [2]     chr1     4332510-4332710      * | Intron (ENSMUST00000..         1\n     [3]     chr1     4491755-4492573      * |       Promoter (1-2kb)         1\n     [4]     chr1     4571186-4572423      * |      Distal Intergenic         1\n     [5]     chr1     4785062-4786325      * |       Promoter (&lt;=1kb)         1\n     ...      ...                 ...    ... .                    ...       ...\n  [3652]     chr2 181764664-181764891      * |       Promoter (1-2kb)         2\n  [3653]     chr2 181766881-181767875      * |       Promoter (&lt;=1kb)         2\n  [3654]     chr2 181837244-181838655      * |       Promoter (&lt;=1kb)         2\n  [3655]     chr2 181863853-181865066      * |       Promoter (&lt;=1kb)         2\n  [3656]     chr2 181918525-181918853      * |      Distal Intergenic         2\n         geneStart   geneEnd geneLength geneStrand      geneId\n         &lt;integer&gt; &lt;integer&gt;  &lt;integer&gt;  &lt;integer&gt; &lt;character&gt;\n     [1]   3214482   3671498     457017          2      497097\n     [2]   4344146   4360314      16169          2       19888\n     [3]   4492465   4493735       1271          2       20671\n     [4]   4491390   4497354       5965          2       20671\n     [5]   4773206   4785710      12505          2       27395\n     ...       ...       ...        ...        ...         ...\n  [3652] 181763332 181827797      64466          1       17932\n  [3653] 181767029 181795892      28864          1       17932\n  [3654] 181837854 181857461      19608          1      245867\n  [3655] 181864337 181870830       6494          1       67005\n  [3656] 181864360 181866209       1850          1       67005\n                  transcriptId distanceToTSS            ENSEMBL      SYMBOL\n                   &lt;character&gt;     &lt;numeric&gt;        &lt;character&gt; &lt;character&gt;\n     [1]  ENSMUST00000070533.4             0 ENSMUSG00000051951        Xkr4\n     [2]  ENSMUST00000027032.5         27604 ENSMUSG00000025900         Rp1\n     [3]  ENSMUST00000191939.1          1162 ENSMUSG00000025902       Sox17\n     [4]  ENSMUST00000192650.5        -73832 ENSMUSG00000025902       Sox17\n     [5]  ENSMUST00000130201.7             0 ENSMUSG00000033845      Mrpl15\n     ...                   ...           ...                ...         ...\n  [3652] ENSMUST00000081125.10          1332 ENSMUSG00000010505        Myt1\n  [3653]  ENSMUST00000156190.7             0 ENSMUSG00000010505        Myt1\n  [3654] ENSMUST00000029116.13             0 ENSMUSG00000027589      Pcmtd2\n  [3655]  ENSMUST00000039551.8             0 ENSMUSG00000038628      Polr3k\n  [3656]  ENSMUST00000153214.1         54165 ENSMUSG00000038628      Polr3k\n                       GENENAME        anno     logFC    logCPM         F\n                    &lt;character&gt; &lt;character&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;\n     [1] X-linked Kx blood gr..    Promoter  0.602984  10.45378  41.78446\n     [2] retinitis pigmentosa..      Intron  0.855748   5.18424   3.68371\n     [3] SRY (sex determining..    Promoter -0.620926   7.13469   9.14522\n     [4] SRY (sex determining..  Intergenic -0.511046   8.90885  15.15688\n     [5] mitochondrial riboso..    Promoter  0.540908   8.63469  15.08892\n     ...                    ...         ...       ...       ...       ...\n  [3652] myelin transcription..    Promoter -1.275275   5.54135  10.44866\n  [3653] myelin transcription..    Promoter  0.477658   7.56969   6.03877\n  [3654] protein-L-isoasparta..    Promoter  0.689247   7.92175  16.67881\n  [3655] polymerase (RNA) III..    Promoter  0.241693   9.05746   4.06676\n  [3656] polymerase (RNA) III..  Intergenic  0.394577   6.84745   2.73331\n              PValue      qvalue\n           &lt;numeric&gt;   &lt;numeric&gt;\n     [1] 6.58453e-08 4.81983e-07\n     [2] 6.13517e-02 9.28785e-02\n     [3] 4.12368e-03 8.38540e-03\n     [4] 3.27158e-04 8.67115e-04\n     [5] 3.36058e-04 8.82634e-04\n     ...         ...         ...\n  [3652] 0.002309221  0.00497558\n  [3653] 0.017945118  0.03116850\n  [3654] 0.000181039  0.00051468\n  [3655] 0.049773014  0.07677364\n  [3656] 0.105289776  0.15077925\n  -------\n  seqinfo: 21 sequences from an unspecified genome; no seqlengths\n\n\n2. Subset Regions on chr1 with Width &gt; 1000 bp\n\nsubset_gr &lt;- gr[seqnames(gr) == \"chr1\" & width(gr) &gt; 1000]\nsubset_gr\n\nGRanges object with 838 ranges and 18 metadata columns:\n        seqnames              ranges strand |        annotation   geneChr\n           &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; |       &lt;character&gt; &lt;integer&gt;\n    [1]     chr1     3670547-3672665      * |  Promoter (&lt;=1kb)         1\n    [2]     chr1     4571186-4572423      * | Distal Intergenic         1\n    [3]     chr1     4785062-4786325      * |  Promoter (&lt;=1kb)         1\n    [4]     chr1     4807268-4808558      * |  Promoter (&lt;=1kb)         1\n    [5]     chr1     4857303-4858480      * |  Promoter (&lt;=1kb)         1\n    ...      ...                 ...    ... .               ...       ...\n  [834]     chr1 193968000-193969035      * | Distal Intergenic         1\n  [835]     chr1 194160689-194161978      * | Distal Intergenic         1\n  [836]     chr1 194619386-194621007      * |  Promoter (&lt;=1kb)         1\n  [837]     chr1 194879295-194880523      * | Distal Intergenic         1\n  [838]     chr1 194976000-194977461      * |  Promoter (&lt;=1kb)         1\n        geneStart   geneEnd geneLength geneStrand      geneId\n        &lt;integer&gt; &lt;integer&gt;  &lt;integer&gt;  &lt;integer&gt; &lt;character&gt;\n    [1]   3214482   3671498     457017          2      497097\n    [2]   4491390   4497354       5965          2       20671\n    [3]   4773206   4785710      12505          2       27395\n    [4]   4807788   4848410      40623          1       18777\n    [5]   4857814   4897905      40092          1       21399\n    ...       ...       ...        ...        ...         ...\n  [834] 194212187 194222759      10573          2       74942\n  [835] 194212187 194222759      10573          2       74942\n  [836] 194619825 194816869     197045          1       18845\n  [837] 194822001 194822064         64          1   100628615\n  [838] 194955759 194976960      21202          2      320400\n                 transcriptId distanceToTSS            ENSEMBL        SYMBOL\n                  &lt;character&gt;     &lt;numeric&gt;        &lt;character&gt;   &lt;character&gt;\n    [1]  ENSMUST00000070533.4             0 ENSMUSG00000051951          Xkr4\n    [2]  ENSMUST00000192650.5        -73832 ENSMUSG00000025902         Sox17\n    [3]  ENSMUST00000130201.7             0 ENSMUSG00000033845        Mrpl15\n    [4]  ENSMUST00000134384.7             0 ENSMUSG00000025903        Lypla1\n    [5] ENSMUST00000081551.13             0 ENSMUSG00000033813         Tcea1\n    ...                   ...           ...                ...           ...\n  [834]  ENSMUST00000193395.1        253724 ENSMUSG00000103692 4930503O07Rik\n  [835]  ENSMUST00000193395.1         60781 ENSMUSG00000103692 4930503O07Rik\n  [836] ENSMUST00000027952.11             0 ENSMUSG00000026640        Plxna2\n  [837]  ENSMUST00000174892.1         57294 ENSMUSG00000092633       Mir3962\n  [838]  ENSMUST00000180780.2             0 ENSMUSG00000097325       Gm16897\n                      GENENAME        anno      logFC    logCPM         F\n                   &lt;character&gt; &lt;character&gt;  &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;\n    [1] X-linked Kx blood gr..    Promoter  0.6029841  10.45378 41.784460\n    [2] SRY (sex determining..  Intergenic -0.5110459   8.90885 15.156883\n    [3] mitochondrial riboso..    Promoter  0.5409079   8.63469 15.088922\n    [4]    lysophospholipase 1    Promoter  0.0485083   9.02241  0.158018\n    [5] transcription elonga..    Promoter  0.4092797   9.92134 14.681270\n    ...                    ...         ...        ...       ...       ...\n  [834] RIKEN cDNA 4930503O0..  Intergenic   1.789029   6.37400  36.41420\n  [835] RIKEN cDNA 4930503O0..  Intergenic  -2.621150   7.53898 143.60529\n  [836]              plexin A2    Promoter  -0.444863   9.24715  14.79019\n  [837]          microRNA 3962  Intergenic  -1.195438   6.95062  28.66158\n  [838]  predicted gene, 16897    Promoter  -0.246053   8.75503   3.60378\n             PValue      qvalue\n          &lt;numeric&gt;   &lt;numeric&gt;\n    [1] 6.58453e-08 4.81983e-07\n    [2] 3.27158e-04 8.67115e-04\n    [3] 3.36058e-04 8.82634e-04\n    [4] 6.92882e-01 7.45491e-01\n    [5] 3.95063e-04 1.01572e-03\n    ...         ...         ...\n  [834] 2.85224e-07 1.73797e-06\n  [835] 1.50833e-15 1.77316e-13\n  [836] 3.78302e-04 9.79514e-04\n  [837] 2.86565e-06 1.28866e-05\n  [838] 6.41228e-02 9.63951e-02\n  -------\n  seqinfo: 21 sequences from an unspecified genome; no seqlengths\n\n\n3. Plot Width Distribution of Genomic Ranges\n\ndf_gr &lt;- as.data.frame(gr)\n\nggplot(df_gr, aes(x = width)) +\n  geom_histogram(bins = 50, fill = \"#3366cc\", color = \"white\") +\n  theme_minimal() +\n  labs(title = \"Width Distribution of Genomic Ranges\",\n       x = \"Width (bp)\", y = \"Count\")"
  },
  {
    "objectID": "day1/day1-1_dataset.html#bonus-heatmap-of-h3k27ac-signal",
    "href": "day1/day1-1_dataset.html#bonus-heatmap-of-h3k27ac-signal",
    "title": "Exercise 1",
    "section": "🔎 Bonus: Heatmap of H3K27ac Signal",
    "text": "🔎 Bonus: Heatmap of H3K27ac Signal\n\nmat &lt;- assay(h3k27ac)\n\nHeatmap(mat[1:50, ],\n        name = \"H3K27ac\",\n        show_row_names = FALSE,\n        show_column_names = TRUE,\n        cluster_rows = TRUE,\n        cluster_columns = TRUE)"
  },
  {
    "objectID": "day1/day1-1_dataset.html#question-4",
    "href": "day1/day1-1_dataset.html#question-4",
    "title": "Exercise 1",
    "section": "Question 4",
    "text": "Question 4\nTry to run all other commands from the following image on other GRanges from SE objects as well\n\n\n\n\n\n\n\nImportant\n\n\n\nUnderstanding how different omics layers are represented in SE and GRanges objects is essential for multi-omics integration, visualization, and downstream analysis."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site"
  },
  {
    "objectID": "course_schedule.html",
    "href": "course_schedule.html",
    "title": "Course schedule",
    "section": "",
    "text": "Note\n\n\n\nApart from the starting time the time schedule is indicative. Because we can not plan a course by the minute, in practice the time points will deviate."
  },
  {
    "objectID": "course_schedule.html#day-1",
    "href": "course_schedule.html#day-1",
    "title": "Course schedule",
    "section": "Day 1",
    "text": "Day 1\n\n\n\nblock\nstart\nend\npresentation\nexercise\n\n\n\n\nIntroduction\n9:00 AM\n9:30 AM\nSlides\n\n\n\nBiological introduction\n9:30 AM\n10:30 AM\nLecture 1\n\n\n\nBREAK\n10:30 AM\n11:00 AM\n\n\n\n\nDataset and data structure 1\n11:00 AM\n12:00 PM\nLecture 2\nExercise 1\n\n\nLUNCH\n12:00 PM\n1:00 PM\n\n\n\n\nDataset and data structure 2\n1:00 PM\n2:00 PM\n\nExercise 1\n\n\nNormalization and Visualization 1\n2:00 PM\n3:00 PM\nLecture 3\nExercise 2\n\n\nBREAK\n3:00 PM\n3:30 PM\n\n\n\n\nNormalization and Visualization 2\n3:30 PM\n4:45 PM\n\nExercise 3"
  },
  {
    "objectID": "course_schedule.html#day-2",
    "href": "course_schedule.html#day-2",
    "title": "Course schedule",
    "section": "Day 2",
    "text": "Day 2\n\n\n\nblock\nstart\nend\nsubject\nexercise\n\n\n\n\nRecap from Day 1\n9:00 AM\n9:15 AM\n\n\n\n\nData overlap matrix\n9:15 AM\n10:30 AM\nLecture 4\nExercise 4\n\n\nBREAK\n10:30 AM\n11:00 AM\n\n\n\n\nATAC-seq and RNA-seq plot\n11:00 AM\n12:00 PM\nLecture 5\nExercise 5\n\n\nLUNCH\n12:00 PM\n1:00 PM\n\n\n\n\nMulti-omics data visualization\n1:00 PM\n3:00 PM\nLecture 6\nExercise 6\n\n\nBREAK\n3:00 PM\n3:30 PM\n\n\n\n\nFunctional analysis\n3:30 PM\n5:00 PM\nLecture 7\nExercise 7\n\n\nPost-course info\n5:00 PM\n5:10 PM\nSlides"
  },
  {
    "objectID": "day1/day1-2_atac.html",
    "href": "day1/day1-2_atac.html",
    "title": "Exercise 2",
    "section": "",
    "text": "By the end of this section, you will be able to:\nDistinguish between when to use Heatmap() and HeatmapAnnotation()\n\nGenerate row split annotations for enriched heatmaps\nAdd multiple categorical annotations with separate color legends\nAvoid common data handling errors in heatmap plotting\n\n\nlibrary(SummarizedExperiment)\nlibrary(EnrichedHeatmap)\nlibrary(gUtils)\nlibrary(rtracklayer)\nlibrary(circlize)\n\n\nHere we load the SummarizedExperiment for the ATAC-seq data\n\natac &lt;- readRDS(\"data/atac_se.rds\")\n\n\nEach peak region represent the activity in a genomic region. These peaks are annotated for various features, including their genomic annotations and the results for differential accessibility analysis is also added there.\n\nrowRanges(atac)\n\nGRanges object with 3656 ranges and 18 metadata columns:\n         seqnames              ranges strand |             annotation   geneChr\n            &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; |            &lt;character&gt; &lt;integer&gt;\n     [1]     chr1     3670547-3672665      * |       Promoter (&lt;=1kb)         1\n     [2]     chr1     4332510-4332710      * | Intron (ENSMUST00000..         1\n     [3]     chr1     4491755-4492573      * |       Promoter (1-2kb)         1\n     [4]     chr1     4571186-4572423      * |      Distal Intergenic         1\n     [5]     chr1     4785062-4786325      * |       Promoter (&lt;=1kb)         1\n     ...      ...                 ...    ... .                    ...       ...\n  [3652]     chr2 181764664-181764891      * |       Promoter (1-2kb)         2\n  [3653]     chr2 181766881-181767875      * |       Promoter (&lt;=1kb)         2\n  [3654]     chr2 181837244-181838655      * |       Promoter (&lt;=1kb)         2\n  [3655]     chr2 181863853-181865066      * |       Promoter (&lt;=1kb)         2\n  [3656]     chr2 181918525-181918853      * |      Distal Intergenic         2\n         geneStart   geneEnd geneLength geneStrand      geneId\n         &lt;integer&gt; &lt;integer&gt;  &lt;integer&gt;  &lt;integer&gt; &lt;character&gt;\n     [1]   3214482   3671498     457017          2      497097\n     [2]   4344146   4360314      16169          2       19888\n     [3]   4492465   4493735       1271          2       20671\n     [4]   4491390   4497354       5965          2       20671\n     [5]   4773206   4785710      12505          2       27395\n     ...       ...       ...        ...        ...         ...\n  [3652] 181763332 181827797      64466          1       17932\n  [3653] 181767029 181795892      28864          1       17932\n  [3654] 181837854 181857461      19608          1      245867\n  [3655] 181864337 181870830       6494          1       67005\n  [3656] 181864360 181866209       1850          1       67005\n                  transcriptId distanceToTSS            ENSEMBL      SYMBOL\n                   &lt;character&gt;     &lt;numeric&gt;        &lt;character&gt; &lt;character&gt;\n     [1]  ENSMUST00000070533.4             0 ENSMUSG00000051951        Xkr4\n     [2]  ENSMUST00000027032.5         27604 ENSMUSG00000025900         Rp1\n     [3]  ENSMUST00000191939.1          1162 ENSMUSG00000025902       Sox17\n     [4]  ENSMUST00000192650.5        -73832 ENSMUSG00000025902       Sox17\n     [5]  ENSMUST00000130201.7             0 ENSMUSG00000033845      Mrpl15\n     ...                   ...           ...                ...         ...\n  [3652] ENSMUST00000081125.10          1332 ENSMUSG00000010505        Myt1\n  [3653]  ENSMUST00000156190.7             0 ENSMUSG00000010505        Myt1\n  [3654] ENSMUST00000029116.13             0 ENSMUSG00000027589      Pcmtd2\n  [3655]  ENSMUST00000039551.8             0 ENSMUSG00000038628      Polr3k\n  [3656]  ENSMUST00000153214.1         54165 ENSMUSG00000038628      Polr3k\n                       GENENAME        anno     logFC    logCPM         F\n                    &lt;character&gt; &lt;character&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;\n     [1] X-linked Kx blood gr..    Promoter  0.602984  10.45378  41.78446\n     [2] retinitis pigmentosa..      Intron  0.855748   5.18424   3.68371\n     [3] SRY (sex determining..    Promoter -0.620926   7.13469   9.14522\n     [4] SRY (sex determining..  Intergenic -0.511046   8.90885  15.15688\n     [5] mitochondrial riboso..    Promoter  0.540908   8.63469  15.08892\n     ...                    ...         ...       ...       ...       ...\n  [3652] myelin transcription..    Promoter -1.275275   5.54135  10.44866\n  [3653] myelin transcription..    Promoter  0.477658   7.56969   6.03877\n  [3654] protein-L-isoasparta..    Promoter  0.689247   7.92175  16.67881\n  [3655] polymerase (RNA) III..    Promoter  0.241693   9.05746   4.06676\n  [3656] polymerase (RNA) III..  Intergenic  0.394577   6.84745   2.73331\n              PValue      qvalue\n           &lt;numeric&gt;   &lt;numeric&gt;\n     [1] 6.58453e-08 4.81983e-07\n     [2] 6.13517e-02 9.28785e-02\n     [3] 4.12368e-03 8.38540e-03\n     [4] 3.27158e-04 8.67115e-04\n     [5] 3.36058e-04 8.82634e-04\n     ...         ...         ...\n  [3652] 0.002309221  0.00497558\n  [3653] 0.017945118  0.03116850\n  [3654] 0.000181039  0.00051468\n  [3655] 0.049773014  0.07677364\n  [3656] 0.105289776  0.15077925\n  -------\n  seqinfo: 21 sequences from an unspecified genome; no seqlengths\n\nrd_atac &lt;- rowRanges(atac)\nrd_atac &lt;- rd_atac[abs(rd_atac$logFC) &gt;= 0.5 & rd_atac$qvalue &lt;= 0.1]\ncolnames(elementMetadata(rd_atac)) &lt;- paste(\"ATAC\", colnames(elementMetadata(rd_atac)), sep = \"_\")\n\n\nMost of the peaks are around 1000 bp wide. We can check that\n\nmedian(lengths(rowRanges(atac)))\n\n[1] 1031\n\n\nFor plotting the data, we can hence consider 1000 bp around the peak-mid\n\n# Finding mid of all peaks\nmid_peaks &lt;- gr.mid(rd_atac)\n\n# adding names to peaks to give them identity\nnames(mid_peaks) &lt;- paste(\"peak\", 1:length(mid_peaks), sep = \"_\")\n\n\nbigWig files are compressed, indexed, binary format used for efficiently displaying continuous data, like genomic signal data, in genome browsers. Here, we read in ATAC-seq bigWig files, filters the data to specific chromosomes, normalizes signal intensity around genomic regions of interest (peak centers), and saves the resulting matrices for downstream visualization.\n\natac_files &lt;- list.files(\"data\", pattern = \"ATAC\", full.names = TRUE)\nnames(atac_files) &lt;- gsub(pattern = \"\\\\.bw\", replacement = \"\", x = basename(atac_files))\natac_bw &lt;- lapply(atac_files, function(x){\n  a &lt;- rtracklayer::import(x)\n  a &lt;- a[seqnames(a) %in% c(\"chr1\", \"chr2\")]\n  a\n})\n\nbigWig files are represented as GRanges.\n\natac_bw\n\n$ATAC_11half\nGRanges object with 6354084 ranges and 1 metadata column:\n            seqnames              ranges strand |     score\n               &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt;\n        [1]     chr1           1-3000000      * | 0.0000000\n        [2]     chr1     3000001-3000050      * | 0.0225005\n        [3]     chr1     3000051-3000100      * | 0.0600013\n        [4]     chr1     3000101-3000150      * | 0.0337507\n        [5]     chr1     3000151-3000200      * | 0.0375008\n        ...      ...                 ...    ... .       ...\n  [6354080]     chr2 182013051-182013100      * |   45.3122\n  [6354081]     chr2 182013101-182013150      * |   49.6173\n  [6354082]     chr2 182013151-182013200      * |   79.4379\n  [6354083]     chr2 182013201-182013250      * |   50.2623\n  [6354084]     chr2 182013251-182113224      * |    0.0000\n  -------\n  seqinfo: 66 sequences from an unspecified genome\n\n$ATAC_15half\nGRanges object with 5356375 ranges and 1 metadata column:\n            seqnames              ranges strand |      score\n               &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; |  &lt;numeric&gt;\n        [1]     chr1           1-3000400      * | 0.00000000\n        [2]     chr1     3000401-3000500      * | 0.00844927\n        [3]     chr1     3000501-3000550      * | 0.00000000\n        [4]     chr1     3000551-3000650      * | 0.00844927\n        [5]     chr1     3000651-3003300      * | 0.00000000\n        ...      ...                 ...    ... .        ...\n  [5356371]     chr2 182012501-182012600      * | 0.01689850\n  [5356372]     chr2 182012601-182012650      * | 0.00844927\n  [5356373]     chr2 182012651-182012900      * | 0.00000000\n  [5356374]     chr2 182012901-182013000      * | 0.01689850\n  [5356375]     chr2 182013001-182113224      * | 0.00000000\n  -------\n  seqinfo: 66 sequences from an unspecified genome\n\n\nNext, we calculate the normalized signals into the area of our interest. Please check ?normalizeToMatrix for details of this function\n\nmat_AS &lt;- lapply(atac_bw, FUN = function(x) {\n  normalizeToMatrix(x, mid_peaks,\n    extend = 1000,\n    value_column = \"score\",\n    include_target = TRUE,\n    mean_mode = \"w0\",\n    w = 20,\n    smooth = T,\n    background = 0\n  )\n})\n\nmat_AS\n\n$ATAC_11half\nNormalize x to mid_peaks:\n  Upstream 1000 bp (50 windows)\n  Downstream 1000 bp (50 windows)\n  Include target regions (width = 1)\n  1933 target regions\n\n$ATAC_15half\nNormalize x to mid_peaks:\n  Upstream 1000 bp (50 windows)\n  Downstream 1000 bp (50 windows)\n  Include target regions (width = 1)\n  1933 target regions\n\n\n\nEnriched heatmap is a special type of heatmap which visualizes the enrichment of genomic signals over specific target regions.\n\nEnrichedHeatmap(mat = mat_AS$ATAC_11half, name = \"E11.5\") + \n  EnrichedHeatmap(mat = mat_AS$ATAC_15half, name = \"E15.5\")\n\nThe automatically generated colors map from the 1^st and 99^th of the\nvalues in the matrix. There are outliers in the matrix whose patterns\nmight be hidden by this color mapping. You can manually set the color\nto `col` argument.\n\nUse `suppressMessages()` to turn off this message.\nThe automatically generated colors map from the 1^st and 99^th of the\nvalues in the matrix. There are outliers in the matrix whose patterns\nmight be hidden by this color mapping. You can manually set the color\nto `col` argument.\n\nUse `suppressMessages()` to turn off this message.\n\n\n\n\n\n\n\n\nJoining 2 EnrichedHeatmaps is very easy with a + sign.\n\nLet’s work on one data for now.\n\n\nEnrichedHeatmap(\n  mat = mat_AS$ATAC_11half,    # normalized matrix\n  name = \"E11.5\",              # Name for the plot\n  col = c(\"white\", \"red\"),     # We change the colors for low to high values\n  width = unit(4, \"cm\"),       # Width of the heatmap\n  height = unit(8, \"cm\")      # Height of the heatmap\n)\n\n\n\n\n\n\n\nYou may wonder why the color looks so light. The reason is in coverage values in ATAC, there exist some extreme values, which results in extreme value in normalizedMatrix.\n\n\n# Taking data between 1 and 99 percentile\ncol_fun &lt;- colorRamp2(quantile(mat_AS$ATAC_11half, c(0.01, 0.99)), c(\"white\", \"red\"))\n\nEnrichedHeatmap(\n  mat = mat_AS$ATAC_11half,\n  name = \"E11.5\",\n  col = col_fun,\n  width = unit(4, \"cm\"),\n  height = unit(8, \"cm\")\n)\n\n\n\n\n\n\n\n\n\n# We first change the color legent of the plot to show only 3 values\nvmin &lt;- as.numeric(quantile(mat_AS$ATAC_11half, c(0.01)))\nvmax &lt;- as.numeric(quantile(mat_AS$ATAC_11half, c(0.99)))\nvmid &lt;- (vmin + vmax) / 2\nlegend_ticks &lt;- c(vmin, vmid, vmax)\n\nEnrichedHeatmap(\n  mat = mat_AS$ATAC_11half,\n  name = \"E11.5\",\n  col = col_fun,\n  width = unit(4, \"cm\"),\n  height = unit(8, \"cm\"),\n  column_title = \"E11.5\",\n  column_title_gp = gpar(fontsize = 10, fill = \"#ffcccc\"),\n  axis_name = c(\"-1kb\", \"mid\", \"1kb\"),  # We changed the axis names here\n heatmap_legend_param = list(\n    at = legend_ticks,\n    labels = round(legend_ticks, digits = 1),\n    title_gp = gpar(fontsize = 8),\n    labels_gp = gpar(fontsize = 7)\n  ),\n  top_annotation = HeatmapAnnotation(\n    lines = anno_enriched(\n      height = unit(2, \"cm\"),\n      gp = gpar(\n        lwd = 0.7,\n        fontsize = 5\n      ),\n      axis_param = list(\n        side = \"right\",\n        facing = \"inside\",\n        gp = gpar(\n          fontsize = 7,\n          col = \"black\",\n          lwd = 0.4\n        )\n      )\n    )\n  )\n)\n\n\n\n\n\n\n\n\nAlthough we see some signal here, but it might be a good idea to split the heatmap into the regions which gained and lost accessibility.\n\nsplit_change &lt;- ifelse(mid_peaks$ATAC_logFC &gt; 0, yes = \"Increased accessibility\", no = \"Decreased accessibility\")\nnames(split_change) &lt;- names(mid_peaks)\n\nhead(split_change)\n\n                   peak_1                    peak_2                    peak_3 \n\"Increased accessibility\" \"Increased accessibility\" \"Decreased accessibility\" \n                   peak_4                    peak_5                    peak_6 \n\"Decreased accessibility\" \"Increased accessibility\" \"Decreased accessibility\" \n\n# Define cluster colors\ncluster_colors &lt;- c(\"Increased accessibility\" = \"red\", \"Decreased accessibility\" = \"blue\")\n\n# Make sure split_change has levels matching the color names\nsplit_change &lt;- factor(split_change, levels = names(cluster_colors))\n\nEnrichedHeatmap(\n  mat = mat_AS$ATAC_11half,\n  name = \"E11.5\",\n  row_split = split_change,\n  col = col_fun,\n  width = unit(4, \"cm\"),\n  height = unit(8, \"cm\"),\n  column_title = \"E11.5\",\n  column_title_gp = gpar(fontsize = 10, fill = \"#ffcccc\"),\n  axis_name = c(\"-1kb\", \"mid\", \"1kb\"),\n  heatmap_legend_param = list(\n    at = legend_ticks,\n    labels = round(legend_ticks, digits = 1),\n    title_gp = gpar(fontsize = 8),\n    labels_gp = gpar(fontsize = 7)\n  ),\n  top_annotation = HeatmapAnnotation(\n    lines = anno_enriched(\n      gp = gpar(col = cluster_colors),\n      height = unit(2, \"cm\"),\n      axis_param = list(\n        side = \"right\",\n        facing = \"inside\",\n        gp = gpar(\n          fontsize = 7,\n          lwd = 0.4\n        )\n      )\n    )\n  )\n)\n\n\n\n\n\n\n\n\nAs you know we have at least 2 samples as of now. It will be a good idea to create a function to make this heatmap.\n\nmake_EH &lt;- function(norm_mat, heatmap_cols = c(\"white\", \"red\"), split_rows = NULL, hm_name, col_fill = \"#ffcccc\"){\n  col_fun &lt;- colorRamp2(quantile(norm_mat, c(0.01, 0.99)), heatmap_cols)  \n  \n  vmin &lt;- as.numeric(quantile(norm_mat, c(0.01)))\n  vmax &lt;- as.numeric(quantile(norm_mat, c(0.99)))\n  vmid &lt;- (vmin + vmax) / 2\n  legend_ticks &lt;- c(vmin, vmid, vmax)\n\nEnrichedHeatmap(\n  mat = norm_mat,\n  name = hm_name,\n  row_split = split_rows,\n  col = col_fun,\n  width = unit(4, \"cm\"),\n  height = unit(8, \"cm\"),\n  column_title = hm_name,\n  column_title_gp = gpar(fontsize = 10, fill = col_fill),\n  axis_name = c(\"-1kb\", \"mid\", \"1kb\"),\n  heatmap_legend_param = list(\n    at = legend_ticks,\n    labels = round(legend_ticks, digits = 1),\n    title_gp = gpar(fontsize = 8),\n    labels_gp = gpar(fontsize = 7)\n  ),\n  top_annotation = HeatmapAnnotation(\n    lines = anno_enriched(\n      gp = gpar(col = cluster_colors),\n      height = unit(2, \"cm\"),\n      axis_param = list(\n        side = \"right\",\n        facing = \"inside\",\n        gp = gpar(\n          fontsize = 7,\n          lwd = 0.4\n        )\n      )\n    )\n  )\n)\n}\n\n\n\neh_11h &lt;- make_EH(norm_mat = mat_AS$ATAC_11half, split_rows = split_change, hm_name = \"E11.5\")\neh_15h &lt;- make_EH(norm_mat = mat_AS$ATAC_15half, split_rows = split_change, hm_name = \"E15.5\", col_fill = \"#e6fff2\")\n\ndraw(eh_11h + eh_15h, merge_legend = TRUE)\n\n\n\n\n\n\n\n\nIt is probably a good idea to represent clusters with colors, instead of text\n\neh_11h &lt;- make_EH(norm_mat = mat_AS$ATAC_11half, hm_name = \"E11.5\")\neh_15h &lt;- make_EH(norm_mat = mat_AS$ATAC_15half, hm_name = \"E15.5\", col_fill = \"#e6fff2\")\n\nrow_order_eh &lt;- row_order(eh_11h)\n\nanno_hm &lt;- Heatmap(\n  split_change,\n  col = c(\"red\", \"blue\"), \n  name = \"Change\",\n  show_row_names = FALSE, \n  show_column_names = FALSE, \n  width = unit(3, \"mm\"),\n  height = unit(8, \"cm\"),\n  row_order = row_order_eh,\n  row_title_gp = gpar(fontsize = 0)\n)\n\ndraw(anno_hm + eh_11h + eh_15h, split = split_change, merge_legend = TRUE)\n\n\n\n\n\n\n\n\nCan you make split the Enriched Heatmap based on the annotations?\nHint: mid_peaks$ATAC_anno contain annotations for the regions.\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\nsplit_anno &lt;- mid_peaks$ATAC_anno\nnames(split_anno) &lt;- names(mid_peaks)\n\nhead(split_anno)\n\n      peak_1       peak_2       peak_3       peak_4       peak_5       peak_6 \n  \"Promoter\"     \"Intron\"   \"Promoter\" \"Intergenic\"   \"Promoter\" \"Intergenic\" \n\ncols_an &lt;- RColorBrewer::brewer.pal(n = length(unique(split_anno)), name = \"Set1\")\n\nanno_an &lt;- Heatmap(\n  split_anno,\n  col = cols_an, \n  name = \"anno\",\n  show_row_names = FALSE, \n  show_column_names = FALSE, \n  width = unit(3, \"mm\"),\n  height = unit(8, \"cm\"),\n  row_order = row_order_eh,\n  row_title_gp = gpar(fontsize = 0)\n)\n\ndraw(anno_an + eh_11h + eh_15h, split = split_anno, merge_legend = TRUE)\n\n\n\n\n\n\n\n\n\n\n\nCan you make split the Enriched Heatmap based on the annotations and change in direction?\nHint: mid_peaks$ATAC_anno contain annotations for the regions. mid_peaks$ATAC_logFC contain sign of change.\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\nsplit_anno_dir &lt;- paste(mid_peaks$ATAC_anno, ifelse(mid_peaks$ATAC_logFC &gt; 0, yes = \"Inc\", no = \"Dec\"))\nnames(split_anno_dir) &lt;- names(mid_peaks)\n\nhead(split_anno_dir)\n\n          peak_1           peak_2           peak_3           peak_4 \n  \"Promoter Inc\"     \"Intron Inc\"   \"Promoter Dec\" \"Intergenic Dec\" \n          peak_5           peak_6 \n  \"Promoter Inc\" \"Intergenic Dec\" \n\ncols_an &lt;- RColorBrewer::brewer.pal(n = length(unique(split_anno_dir)), name = \"Paired\")\n\nanno_an_dir &lt;- Heatmap(\n  split_anno_dir,\n  col = cols_an, \n  name = \"anno\",\n  show_row_names = FALSE, \n  show_column_names = FALSE, \n  width = unit(3, \"mm\"),\n  height = unit(8, \"cm\"),\n  row_order = row_order_eh,\n  row_title_gp = gpar(fontsize = 0)\n)\n\nThere are 10 unique colors in the vector `col` and 10 unique values in\n`matrix`. `Heatmap()` will treat it as an exact discrete one-to-one\nmapping. If this is not what you want, slightly change the number of\ncolors, e.g. by adding one more color or removing a color.\n\ndraw(anno_an_dir + eh_11h + eh_15h, split = split_anno_dir, merge_legend = TRUE)\n\n\n\n\n\n\n\n\n\n\n\nCan you make split the Enriched Heatmap based on the annotations and change in direction with separate color bars for annotation and direction of change?\nHint: mid_peaks$ATAC_anno contain annotations for the regions. mid_peaks$ATAC_logFC contain sign of change.\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\nsplit_anno_df &lt;- data.frame(\n  Annotation = mid_peaks$ATAC_anno,\n  Direction = ifelse(mid_peaks$ATAC_logFC &gt; 0, yes = \"Inc\", no = \"Dec\")\n)\n\nhead(split_anno_df)\n\n  Annotation Direction\n1   Promoter       Inc\n2     Intron       Inc\n3   Promoter       Dec\n4 Intergenic       Dec\n5   Promoter       Inc\n6 Intergenic       Dec\n\ncols_an &lt;- c(\"red\", \"blue\", \n             RColorBrewer::brewer.pal(n = length(unique(split_anno_df$Annotation)), name = \"Set1\")\n)\n\nnames(cols_an) &lt;- c(unique(split_anno_df$Direction), unique(split_anno_df$Annotation))\n\nanno_an_df &lt;- Heatmap(\n  split_anno_df,\n  name = \"anno\",\n  col = cols_an,\n  show_row_names = FALSE, \n  show_column_names = FALSE, \n  width = unit(3, \"mm\"),\n  height = unit(8, \"cm\"),\n  row_order = row_order_eh,\n  row_title_gp = gpar(fontsize = 0)\n)\n\ndraw(anno_an_df + eh_11h + eh_15h, split = split_anno_dir, merge_legend = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nImportant\n\n\n\nHeatmap and EnrichedHeatmap serve different functions, however the plots can be combined effortlessly. This makes the visualization of complex data easy"
  },
  {
    "objectID": "day1/day1-2_atac.html#learning-objectives",
    "href": "day1/day1-2_atac.html#learning-objectives",
    "title": "Exercise 2",
    "section": "",
    "text": "By the end of this section, you will be able to:\nDistinguish between when to use Heatmap() and HeatmapAnnotation()\n\nGenerate row split annotations for enriched heatmaps\nAdd multiple categorical annotations with separate color legends\nAvoid common data handling errors in heatmap plotting"
  },
  {
    "objectID": "day1/day1-2_atac.html#load-libraries",
    "href": "day1/day1-2_atac.html#load-libraries",
    "title": "Exercise 2",
    "section": "",
    "text": "library(SummarizedExperiment)\nlibrary(EnrichedHeatmap)\nlibrary(gUtils)\nlibrary(rtracklayer)\nlibrary(circlize)"
  },
  {
    "objectID": "day1/day1-2_atac.html#atac-se-object",
    "href": "day1/day1-2_atac.html#atac-se-object",
    "title": "Exercise 2",
    "section": "",
    "text": "Here we load the SummarizedExperiment for the ATAC-seq data\n\natac &lt;- readRDS(\"data/atac_se.rds\")"
  },
  {
    "objectID": "day1/day1-2_atac.html#atac-peaks-info",
    "href": "day1/day1-2_atac.html#atac-peaks-info",
    "title": "Exercise 2",
    "section": "",
    "text": "Each peak region represent the activity in a genomic region. These peaks are annotated for various features, including their genomic annotations and the results for differential accessibility analysis is also added there.\n\nrowRanges(atac)\n\nGRanges object with 3656 ranges and 18 metadata columns:\n         seqnames              ranges strand |             annotation   geneChr\n            &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; |            &lt;character&gt; &lt;integer&gt;\n     [1]     chr1     3670547-3672665      * |       Promoter (&lt;=1kb)         1\n     [2]     chr1     4332510-4332710      * | Intron (ENSMUST00000..         1\n     [3]     chr1     4491755-4492573      * |       Promoter (1-2kb)         1\n     [4]     chr1     4571186-4572423      * |      Distal Intergenic         1\n     [5]     chr1     4785062-4786325      * |       Promoter (&lt;=1kb)         1\n     ...      ...                 ...    ... .                    ...       ...\n  [3652]     chr2 181764664-181764891      * |       Promoter (1-2kb)         2\n  [3653]     chr2 181766881-181767875      * |       Promoter (&lt;=1kb)         2\n  [3654]     chr2 181837244-181838655      * |       Promoter (&lt;=1kb)         2\n  [3655]     chr2 181863853-181865066      * |       Promoter (&lt;=1kb)         2\n  [3656]     chr2 181918525-181918853      * |      Distal Intergenic         2\n         geneStart   geneEnd geneLength geneStrand      geneId\n         &lt;integer&gt; &lt;integer&gt;  &lt;integer&gt;  &lt;integer&gt; &lt;character&gt;\n     [1]   3214482   3671498     457017          2      497097\n     [2]   4344146   4360314      16169          2       19888\n     [3]   4492465   4493735       1271          2       20671\n     [4]   4491390   4497354       5965          2       20671\n     [5]   4773206   4785710      12505          2       27395\n     ...       ...       ...        ...        ...         ...\n  [3652] 181763332 181827797      64466          1       17932\n  [3653] 181767029 181795892      28864          1       17932\n  [3654] 181837854 181857461      19608          1      245867\n  [3655] 181864337 181870830       6494          1       67005\n  [3656] 181864360 181866209       1850          1       67005\n                  transcriptId distanceToTSS            ENSEMBL      SYMBOL\n                   &lt;character&gt;     &lt;numeric&gt;        &lt;character&gt; &lt;character&gt;\n     [1]  ENSMUST00000070533.4             0 ENSMUSG00000051951        Xkr4\n     [2]  ENSMUST00000027032.5         27604 ENSMUSG00000025900         Rp1\n     [3]  ENSMUST00000191939.1          1162 ENSMUSG00000025902       Sox17\n     [4]  ENSMUST00000192650.5        -73832 ENSMUSG00000025902       Sox17\n     [5]  ENSMUST00000130201.7             0 ENSMUSG00000033845      Mrpl15\n     ...                   ...           ...                ...         ...\n  [3652] ENSMUST00000081125.10          1332 ENSMUSG00000010505        Myt1\n  [3653]  ENSMUST00000156190.7             0 ENSMUSG00000010505        Myt1\n  [3654] ENSMUST00000029116.13             0 ENSMUSG00000027589      Pcmtd2\n  [3655]  ENSMUST00000039551.8             0 ENSMUSG00000038628      Polr3k\n  [3656]  ENSMUST00000153214.1         54165 ENSMUSG00000038628      Polr3k\n                       GENENAME        anno     logFC    logCPM         F\n                    &lt;character&gt; &lt;character&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;\n     [1] X-linked Kx blood gr..    Promoter  0.602984  10.45378  41.78446\n     [2] retinitis pigmentosa..      Intron  0.855748   5.18424   3.68371\n     [3] SRY (sex determining..    Promoter -0.620926   7.13469   9.14522\n     [4] SRY (sex determining..  Intergenic -0.511046   8.90885  15.15688\n     [5] mitochondrial riboso..    Promoter  0.540908   8.63469  15.08892\n     ...                    ...         ...       ...       ...       ...\n  [3652] myelin transcription..    Promoter -1.275275   5.54135  10.44866\n  [3653] myelin transcription..    Promoter  0.477658   7.56969   6.03877\n  [3654] protein-L-isoasparta..    Promoter  0.689247   7.92175  16.67881\n  [3655] polymerase (RNA) III..    Promoter  0.241693   9.05746   4.06676\n  [3656] polymerase (RNA) III..  Intergenic  0.394577   6.84745   2.73331\n              PValue      qvalue\n           &lt;numeric&gt;   &lt;numeric&gt;\n     [1] 6.58453e-08 4.81983e-07\n     [2] 6.13517e-02 9.28785e-02\n     [3] 4.12368e-03 8.38540e-03\n     [4] 3.27158e-04 8.67115e-04\n     [5] 3.36058e-04 8.82634e-04\n     ...         ...         ...\n  [3652] 0.002309221  0.00497558\n  [3653] 0.017945118  0.03116850\n  [3654] 0.000181039  0.00051468\n  [3655] 0.049773014  0.07677364\n  [3656] 0.105289776  0.15077925\n  -------\n  seqinfo: 21 sequences from an unspecified genome; no seqlengths\n\nrd_atac &lt;- rowRanges(atac)\nrd_atac &lt;- rd_atac[abs(rd_atac$logFC) &gt;= 0.5 & rd_atac$qvalue &lt;= 0.1]\ncolnames(elementMetadata(rd_atac)) &lt;- paste(\"ATAC\", colnames(elementMetadata(rd_atac)), sep = \"_\")"
  },
  {
    "objectID": "day1/day1-2_atac.html#taking-1000-bp-around-the-mid-of-atac-peaks",
    "href": "day1/day1-2_atac.html#taking-1000-bp-around-the-mid-of-atac-peaks",
    "title": "Exercise 2",
    "section": "",
    "text": "Most of the peaks are around 1000 bp wide. We can check that\n\nmedian(lengths(rowRanges(atac)))\n\n[1] 1031\n\n\nFor plotting the data, we can hence consider 1000 bp around the peak-mid\n\n# Finding mid of all peaks\nmid_peaks &lt;- gr.mid(rd_atac)\n\n# adding names to peaks to give them identity\nnames(mid_peaks) &lt;- paste(\"peak\", 1:length(mid_peaks), sep = \"_\")"
  },
  {
    "objectID": "day1/day1-2_atac.html#normalizing-data-for-plotting",
    "href": "day1/day1-2_atac.html#normalizing-data-for-plotting",
    "title": "Exercise 2",
    "section": "",
    "text": "bigWig files are compressed, indexed, binary format used for efficiently displaying continuous data, like genomic signal data, in genome browsers. Here, we read in ATAC-seq bigWig files, filters the data to specific chromosomes, normalizes signal intensity around genomic regions of interest (peak centers), and saves the resulting matrices for downstream visualization.\n\natac_files &lt;- list.files(\"data\", pattern = \"ATAC\", full.names = TRUE)\nnames(atac_files) &lt;- gsub(pattern = \"\\\\.bw\", replacement = \"\", x = basename(atac_files))\natac_bw &lt;- lapply(atac_files, function(x){\n  a &lt;- rtracklayer::import(x)\n  a &lt;- a[seqnames(a) %in% c(\"chr1\", \"chr2\")]\n  a\n})\n\nbigWig files are represented as GRanges.\n\natac_bw\n\n$ATAC_11half\nGRanges object with 6354084 ranges and 1 metadata column:\n            seqnames              ranges strand |     score\n               &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt;\n        [1]     chr1           1-3000000      * | 0.0000000\n        [2]     chr1     3000001-3000050      * | 0.0225005\n        [3]     chr1     3000051-3000100      * | 0.0600013\n        [4]     chr1     3000101-3000150      * | 0.0337507\n        [5]     chr1     3000151-3000200      * | 0.0375008\n        ...      ...                 ...    ... .       ...\n  [6354080]     chr2 182013051-182013100      * |   45.3122\n  [6354081]     chr2 182013101-182013150      * |   49.6173\n  [6354082]     chr2 182013151-182013200      * |   79.4379\n  [6354083]     chr2 182013201-182013250      * |   50.2623\n  [6354084]     chr2 182013251-182113224      * |    0.0000\n  -------\n  seqinfo: 66 sequences from an unspecified genome\n\n$ATAC_15half\nGRanges object with 5356375 ranges and 1 metadata column:\n            seqnames              ranges strand |      score\n               &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; |  &lt;numeric&gt;\n        [1]     chr1           1-3000400      * | 0.00000000\n        [2]     chr1     3000401-3000500      * | 0.00844927\n        [3]     chr1     3000501-3000550      * | 0.00000000\n        [4]     chr1     3000551-3000650      * | 0.00844927\n        [5]     chr1     3000651-3003300      * | 0.00000000\n        ...      ...                 ...    ... .        ...\n  [5356371]     chr2 182012501-182012600      * | 0.01689850\n  [5356372]     chr2 182012601-182012650      * | 0.00844927\n  [5356373]     chr2 182012651-182012900      * | 0.00000000\n  [5356374]     chr2 182012901-182013000      * | 0.01689850\n  [5356375]     chr2 182013001-182113224      * | 0.00000000\n  -------\n  seqinfo: 66 sequences from an unspecified genome\n\n\nNext, we calculate the normalized signals into the area of our interest. Please check ?normalizeToMatrix for details of this function\n\nmat_AS &lt;- lapply(atac_bw, FUN = function(x) {\n  normalizeToMatrix(x, mid_peaks,\n    extend = 1000,\n    value_column = \"score\",\n    include_target = TRUE,\n    mean_mode = \"w0\",\n    w = 20,\n    smooth = T,\n    background = 0\n  )\n})\n\nmat_AS\n\n$ATAC_11half\nNormalize x to mid_peaks:\n  Upstream 1000 bp (50 windows)\n  Downstream 1000 bp (50 windows)\n  Include target regions (width = 1)\n  1933 target regions\n\n$ATAC_15half\nNormalize x to mid_peaks:\n  Upstream 1000 bp (50 windows)\n  Downstream 1000 bp (50 windows)\n  Include target regions (width = 1)\n  1933 target regions"
  },
  {
    "objectID": "day1/day1-2_atac.html#enriched-heatmap",
    "href": "day1/day1-2_atac.html#enriched-heatmap",
    "title": "Exercise 2",
    "section": "",
    "text": "Enriched heatmap is a special type of heatmap which visualizes the enrichment of genomic signals over specific target regions.\n\nEnrichedHeatmap(mat = mat_AS$ATAC_11half, name = \"E11.5\") + \n  EnrichedHeatmap(mat = mat_AS$ATAC_15half, name = \"E15.5\")\n\nThe automatically generated colors map from the 1^st and 99^th of the\nvalues in the matrix. There are outliers in the matrix whose patterns\nmight be hidden by this color mapping. You can manually set the color\nto `col` argument.\n\nUse `suppressMessages()` to turn off this message.\nThe automatically generated colors map from the 1^st and 99^th of the\nvalues in the matrix. There are outliers in the matrix whose patterns\nmight be hidden by this color mapping. You can manually set the color\nto `col` argument.\n\nUse `suppressMessages()` to turn off this message.\n\n\n\n\n\n\n\n\nJoining 2 EnrichedHeatmaps is very easy with a + sign."
  },
  {
    "objectID": "day1/day1-2_atac.html#changing-aesthectics-of-enriched-heatmap",
    "href": "day1/day1-2_atac.html#changing-aesthectics-of-enriched-heatmap",
    "title": "Exercise 2",
    "section": "",
    "text": "Let’s work on one data for now.\n\n\nEnrichedHeatmap(\n  mat = mat_AS$ATAC_11half,    # normalized matrix\n  name = \"E11.5\",              # Name for the plot\n  col = c(\"white\", \"red\"),     # We change the colors for low to high values\n  width = unit(4, \"cm\"),       # Width of the heatmap\n  height = unit(8, \"cm\")      # Height of the heatmap\n)\n\n\n\n\n\n\n\nYou may wonder why the color looks so light. The reason is in coverage values in ATAC, there exist some extreme values, which results in extreme value in normalizedMatrix.\n\n\n# Taking data between 1 and 99 percentile\ncol_fun &lt;- colorRamp2(quantile(mat_AS$ATAC_11half, c(0.01, 0.99)), c(\"white\", \"red\"))\n\nEnrichedHeatmap(\n  mat = mat_AS$ATAC_11half,\n  name = \"E11.5\",\n  col = col_fun,\n  width = unit(4, \"cm\"),\n  height = unit(8, \"cm\")\n)\n\n\n\n\n\n\n\n\n\n# We first change the color legent of the plot to show only 3 values\nvmin &lt;- as.numeric(quantile(mat_AS$ATAC_11half, c(0.01)))\nvmax &lt;- as.numeric(quantile(mat_AS$ATAC_11half, c(0.99)))\nvmid &lt;- (vmin + vmax) / 2\nlegend_ticks &lt;- c(vmin, vmid, vmax)\n\nEnrichedHeatmap(\n  mat = mat_AS$ATAC_11half,\n  name = \"E11.5\",\n  col = col_fun,\n  width = unit(4, \"cm\"),\n  height = unit(8, \"cm\"),\n  column_title = \"E11.5\",\n  column_title_gp = gpar(fontsize = 10, fill = \"#ffcccc\"),\n  axis_name = c(\"-1kb\", \"mid\", \"1kb\"),  # We changed the axis names here\n heatmap_legend_param = list(\n    at = legend_ticks,\n    labels = round(legend_ticks, digits = 1),\n    title_gp = gpar(fontsize = 8),\n    labels_gp = gpar(fontsize = 7)\n  ),\n  top_annotation = HeatmapAnnotation(\n    lines = anno_enriched(\n      height = unit(2, \"cm\"),\n      gp = gpar(\n        lwd = 0.7,\n        fontsize = 5\n      ),\n      axis_param = list(\n        side = \"right\",\n        facing = \"inside\",\n        gp = gpar(\n          fontsize = 7,\n          col = \"black\",\n          lwd = 0.4\n        )\n      )\n    )\n  )\n)\n\n\n\n\n\n\n\n\nAlthough we see some signal here, but it might be a good idea to split the heatmap into the regions which gained and lost accessibility.\n\nsplit_change &lt;- ifelse(mid_peaks$ATAC_logFC &gt; 0, yes = \"Increased accessibility\", no = \"Decreased accessibility\")\nnames(split_change) &lt;- names(mid_peaks)\n\nhead(split_change)\n\n                   peak_1                    peak_2                    peak_3 \n\"Increased accessibility\" \"Increased accessibility\" \"Decreased accessibility\" \n                   peak_4                    peak_5                    peak_6 \n\"Decreased accessibility\" \"Increased accessibility\" \"Decreased accessibility\" \n\n# Define cluster colors\ncluster_colors &lt;- c(\"Increased accessibility\" = \"red\", \"Decreased accessibility\" = \"blue\")\n\n# Make sure split_change has levels matching the color names\nsplit_change &lt;- factor(split_change, levels = names(cluster_colors))\n\nEnrichedHeatmap(\n  mat = mat_AS$ATAC_11half,\n  name = \"E11.5\",\n  row_split = split_change,\n  col = col_fun,\n  width = unit(4, \"cm\"),\n  height = unit(8, \"cm\"),\n  column_title = \"E11.5\",\n  column_title_gp = gpar(fontsize = 10, fill = \"#ffcccc\"),\n  axis_name = c(\"-1kb\", \"mid\", \"1kb\"),\n  heatmap_legend_param = list(\n    at = legend_ticks,\n    labels = round(legend_ticks, digits = 1),\n    title_gp = gpar(fontsize = 8),\n    labels_gp = gpar(fontsize = 7)\n  ),\n  top_annotation = HeatmapAnnotation(\n    lines = anno_enriched(\n      gp = gpar(col = cluster_colors),\n      height = unit(2, \"cm\"),\n      axis_param = list(\n        side = \"right\",\n        facing = \"inside\",\n        gp = gpar(\n          fontsize = 7,\n          lwd = 0.4\n        )\n      )\n    )\n  )\n)\n\n\n\n\n\n\n\n\nAs you know we have at least 2 samples as of now. It will be a good idea to create a function to make this heatmap.\n\nmake_EH &lt;- function(norm_mat, heatmap_cols = c(\"white\", \"red\"), split_rows = NULL, hm_name, col_fill = \"#ffcccc\"){\n  col_fun &lt;- colorRamp2(quantile(norm_mat, c(0.01, 0.99)), heatmap_cols)  \n  \n  vmin &lt;- as.numeric(quantile(norm_mat, c(0.01)))\n  vmax &lt;- as.numeric(quantile(norm_mat, c(0.99)))\n  vmid &lt;- (vmin + vmax) / 2\n  legend_ticks &lt;- c(vmin, vmid, vmax)\n\nEnrichedHeatmap(\n  mat = norm_mat,\n  name = hm_name,\n  row_split = split_rows,\n  col = col_fun,\n  width = unit(4, \"cm\"),\n  height = unit(8, \"cm\"),\n  column_title = hm_name,\n  column_title_gp = gpar(fontsize = 10, fill = col_fill),\n  axis_name = c(\"-1kb\", \"mid\", \"1kb\"),\n  heatmap_legend_param = list(\n    at = legend_ticks,\n    labels = round(legend_ticks, digits = 1),\n    title_gp = gpar(fontsize = 8),\n    labels_gp = gpar(fontsize = 7)\n  ),\n  top_annotation = HeatmapAnnotation(\n    lines = anno_enriched(\n      gp = gpar(col = cluster_colors),\n      height = unit(2, \"cm\"),\n      axis_param = list(\n        side = \"right\",\n        facing = \"inside\",\n        gp = gpar(\n          fontsize = 7,\n          lwd = 0.4\n        )\n      )\n    )\n  )\n)\n}\n\n\n\neh_11h &lt;- make_EH(norm_mat = mat_AS$ATAC_11half, split_rows = split_change, hm_name = \"E11.5\")\neh_15h &lt;- make_EH(norm_mat = mat_AS$ATAC_15half, split_rows = split_change, hm_name = \"E15.5\", col_fill = \"#e6fff2\")\n\ndraw(eh_11h + eh_15h, merge_legend = TRUE)"
  },
  {
    "objectID": "day1/day1-2_atac.html#another-way-to-make-annotations-for-split",
    "href": "day1/day1-2_atac.html#another-way-to-make-annotations-for-split",
    "title": "Exercise 2",
    "section": "",
    "text": "It is probably a good idea to represent clusters with colors, instead of text\n\neh_11h &lt;- make_EH(norm_mat = mat_AS$ATAC_11half, hm_name = \"E11.5\")\neh_15h &lt;- make_EH(norm_mat = mat_AS$ATAC_15half, hm_name = \"E15.5\", col_fill = \"#e6fff2\")\n\nrow_order_eh &lt;- row_order(eh_11h)\n\nanno_hm &lt;- Heatmap(\n  split_change,\n  col = c(\"red\", \"blue\"), \n  name = \"Change\",\n  show_row_names = FALSE, \n  show_column_names = FALSE, \n  width = unit(3, \"mm\"),\n  height = unit(8, \"cm\"),\n  row_order = row_order_eh,\n  row_title_gp = gpar(fontsize = 0)\n)\n\ndraw(anno_hm + eh_11h + eh_15h, split = split_change, merge_legend = TRUE)"
  },
  {
    "objectID": "day1/day1-2_atac.html#question-1",
    "href": "day1/day1-2_atac.html#question-1",
    "title": "Exercise 2",
    "section": "",
    "text": "Can you make split the Enriched Heatmap based on the annotations?\nHint: mid_peaks$ATAC_anno contain annotations for the regions.\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\nsplit_anno &lt;- mid_peaks$ATAC_anno\nnames(split_anno) &lt;- names(mid_peaks)\n\nhead(split_anno)\n\n      peak_1       peak_2       peak_3       peak_4       peak_5       peak_6 \n  \"Promoter\"     \"Intron\"   \"Promoter\" \"Intergenic\"   \"Promoter\" \"Intergenic\" \n\ncols_an &lt;- RColorBrewer::brewer.pal(n = length(unique(split_anno)), name = \"Set1\")\n\nanno_an &lt;- Heatmap(\n  split_anno,\n  col = cols_an, \n  name = \"anno\",\n  show_row_names = FALSE, \n  show_column_names = FALSE, \n  width = unit(3, \"mm\"),\n  height = unit(8, \"cm\"),\n  row_order = row_order_eh,\n  row_title_gp = gpar(fontsize = 0)\n)\n\ndraw(anno_an + eh_11h + eh_15h, split = split_anno, merge_legend = TRUE)"
  },
  {
    "objectID": "day1/day1-2_atac.html#question-2",
    "href": "day1/day1-2_atac.html#question-2",
    "title": "Exercise 2",
    "section": "",
    "text": "Can you make split the Enriched Heatmap based on the annotations and change in direction?\nHint: mid_peaks$ATAC_anno contain annotations for the regions. mid_peaks$ATAC_logFC contain sign of change.\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\nsplit_anno_dir &lt;- paste(mid_peaks$ATAC_anno, ifelse(mid_peaks$ATAC_logFC &gt; 0, yes = \"Inc\", no = \"Dec\"))\nnames(split_anno_dir) &lt;- names(mid_peaks)\n\nhead(split_anno_dir)\n\n          peak_1           peak_2           peak_3           peak_4 \n  \"Promoter Inc\"     \"Intron Inc\"   \"Promoter Dec\" \"Intergenic Dec\" \n          peak_5           peak_6 \n  \"Promoter Inc\" \"Intergenic Dec\" \n\ncols_an &lt;- RColorBrewer::brewer.pal(n = length(unique(split_anno_dir)), name = \"Paired\")\n\nanno_an_dir &lt;- Heatmap(\n  split_anno_dir,\n  col = cols_an, \n  name = \"anno\",\n  show_row_names = FALSE, \n  show_column_names = FALSE, \n  width = unit(3, \"mm\"),\n  height = unit(8, \"cm\"),\n  row_order = row_order_eh,\n  row_title_gp = gpar(fontsize = 0)\n)\n\nThere are 10 unique colors in the vector `col` and 10 unique values in\n`matrix`. `Heatmap()` will treat it as an exact discrete one-to-one\nmapping. If this is not what you want, slightly change the number of\ncolors, e.g. by adding one more color or removing a color.\n\ndraw(anno_an_dir + eh_11h + eh_15h, split = split_anno_dir, merge_legend = TRUE)"
  },
  {
    "objectID": "day1/day1-2_atac.html#question-3",
    "href": "day1/day1-2_atac.html#question-3",
    "title": "Exercise 2",
    "section": "",
    "text": "Can you make split the Enriched Heatmap based on the annotations and change in direction with separate color bars for annotation and direction of change?\nHint: mid_peaks$ATAC_anno contain annotations for the regions. mid_peaks$ATAC_logFC contain sign of change.\n\n\n\n\n\n\nAnswer\n\n\n\n\n\n\nsplit_anno_df &lt;- data.frame(\n  Annotation = mid_peaks$ATAC_anno,\n  Direction = ifelse(mid_peaks$ATAC_logFC &gt; 0, yes = \"Inc\", no = \"Dec\")\n)\n\nhead(split_anno_df)\n\n  Annotation Direction\n1   Promoter       Inc\n2     Intron       Inc\n3   Promoter       Dec\n4 Intergenic       Dec\n5   Promoter       Inc\n6 Intergenic       Dec\n\ncols_an &lt;- c(\"red\", \"blue\", \n             RColorBrewer::brewer.pal(n = length(unique(split_anno_df$Annotation)), name = \"Set1\")\n)\n\nnames(cols_an) &lt;- c(unique(split_anno_df$Direction), unique(split_anno_df$Annotation))\n\nanno_an_df &lt;- Heatmap(\n  split_anno_df,\n  name = \"anno\",\n  col = cols_an,\n  show_row_names = FALSE, \n  show_column_names = FALSE, \n  width = unit(3, \"mm\"),\n  height = unit(8, \"cm\"),\n  row_order = row_order_eh,\n  row_title_gp = gpar(fontsize = 0)\n)\n\ndraw(anno_an_df + eh_11h + eh_15h, split = split_anno_dir, merge_legend = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nImportant\n\n\n\nHeatmap and EnrichedHeatmap serve different functions, however the plots can be combined effortlessly. This makes the visualization of complex data easy"
  },
  {
    "objectID": "day2/day2-1_overlap_matrix.html",
    "href": "day2/day2-1_overlap_matrix.html",
    "title": "Exercise 4",
    "section": "",
    "text": "By the end of this exercise, you will be able to: - Load and explore genomic data using Bioconductor classes such as GRangesList and RangedSummarizedExperiment. - Subset and filter genomic features based on annotation or genomic coordinates. - Perform basic overlap and distance-based queries between genomic intervals. - Integrate multi-assay data (e.g., chromatin marks and gene expression) using shared genomic coordinates.\n\n\nlibrary(ComplexHeatmap)\nlibrary(EnrichedHeatmap)\nlibrary(SummarizedExperiment)\nlibrary(gUtils)\nlibrary(rtracklayer)\nlibrary(data.table)\nlibrary(parallel)\nlibrary(R.utils)\nlibrary(circlize)\n\n\n\natac &lt;- readRDS(\"data/atac_se.rds\")\nrna &lt;- readRDS(\"data/rna_se.rds\")\nh3k4me3 &lt;- readRDS(\"data/h3k4me3_se.rds\")\nh3k4me1 &lt;- readRDS(\"data/h3k4me1_se.rds\")\nh3k27me3 &lt;- readRDS(\"data/h3k27me3_se.rds\")\nh3k27ac &lt;- readRDS(\"data/h3k27ac_se.rds\")\n\n\n\n\n# Merge metadata from two GRanges objects based on overlaps\nmetaGR &lt;- function(gr1, gr2, minOverlap = 1) {\n  # Initialize metadata with gr1's metadata\n  mcols_out &lt;- mcols(gr1)\n\n  # Find overlaps (keep all from gr1)\n  hits &lt;- findOverlaps(gr1, gr2, minoverlap = minOverlap)\n  idx1 &lt;- subjectHits(hits)\n  idx2 &lt;- queryHits(hits)\n\n  # Prepare new metadata to be added\n  new_mcols &lt;- DataFrame(matrix(NA, nrow = length(gr1), ncol = ncol(mcols(gr2))))\n  colnames(new_mcols) &lt;- colnames(mcols(gr2))\n  \n  # Fill metadata only for overlaps\n  new_mcols[idx2, ] &lt;- mcols(gr2)[idx1, , drop = FALSE]\n\n  # Combine original and new metadata\n  mcols(gr1) &lt;- cbind(mcols_out, new_mcols)\n  \n  return(gr1)\n}\n\n\n\n# Extract rowRanges and filter peaks with strong signal\nrd_atac &lt;- rowRanges(atac)\nrd_atac &lt;- rd_atac[abs(rd_atac$logFC) &gt;= 0.5 & rd_atac$qvalue &lt;= 0.1]\ncolnames(elementMetadata(rd_atac)) &lt;- paste(\"ATAC\", colnames(elementMetadata(rd_atac)), sep = \"_\")\n\n\n\n# Filter differentially expressed genes\nrd_rna &lt;- rowRanges(rna)\nrd_rna &lt;- rd_rna[abs(rd_rna$logFC) &gt;= 0.5 & rd_rna$qvalue &lt;= 0.1]\ncolnames(elementMetadata(rd_rna)) &lt;- paste(\"RNA\", colnames(elementMetadata(rd_rna)), sep = \"_\")\noverlap &lt;- metaGR(gr1 = rd_atac, gr2 = rd_rna, minOverlap = 10)\n\n\n\n\nrd_h3k4me3 &lt;- rowRanges(h3k4me3)\nrd_h3k4me3 &lt;- rd_h3k4me3[abs(rd_h3k4me3$logFC) &gt;= 0.5 & rd_h3k4me3$qvalue &lt;= 0.1]\ncolnames(elementMetadata(rd_h3k4me3)) &lt;- paste(\"H3K4me3\", colnames(elementMetadata(rd_h3k4me3)), sep = \"_\")\noverlap &lt;- metaGR(gr1 = overlap, gr2 = rd_h3k4me3, minOverlap = 10)\n\n\n\nrd_h3k4me1 &lt;- rowRanges(h3k4me1)\nrd_h3k4me1 &lt;- rd_h3k4me1[abs(rd_h3k4me1$logFC) &gt;= 0.5 & rd_h3k4me1$qvalue &lt;= 0.1]\ncolnames(elementMetadata(rd_h3k4me1)) &lt;- paste(\"H3K4me1\", colnames(elementMetadata(rd_h3k4me1)), sep = \"_\")\noverlap &lt;- metaGR(gr1 = overlap, gr2 = rd_h3k4me1, minOverlap = 10)\n\nWarning in .merge_two_Seqinfo_objects(x, y): Each of the 2 combined objects has sequence levels not in the other:\n  - in 'x': chrY\n  - in 'y': chr4_GL456216_random, chr4_JH584295_random, chrX_GL456233_random, chrUn_JH584304\n  Make sure to always combine/compare objects based on the same reference\n  genome (use suppressWarnings() to suppress this warning).\n\n\n\n\nrd_h3k27me3 &lt;- rowRanges(h3k27me3)\nrd_h3k27me3 &lt;- rd_h3k27me3[abs(rd_h3k27me3$logFC) &gt;= 0.5 & rd_h3k27me3$qvalue &lt;= 0.1]\ncolnames(elementMetadata(rd_h3k27me3)) &lt;- paste(\"H3K27me3\", colnames(elementMetadata(rd_h3k27me3)), sep = \"_\")\noverlap &lt;- metaGR(gr1 = overlap, gr2 = rd_h3k27me3, minOverlap = 10)\n\n\n\nrd_h3k27ac &lt;- rowRanges(h3k27ac)\nrd_h3k27ac &lt;- rd_h3k27ac[abs(rd_h3k27ac$logFC) &gt;= 0.5 & rd_h3k27ac$qvalue &lt;= 0.1]\ncolnames(elementMetadata(rd_h3k27ac)) &lt;- paste(\"H3K27ac\", colnames(elementMetadata(rd_h3k27ac)), sep = \"_\")\noverlap &lt;- metaGR(gr1 = overlap, gr2 = rd_h3k27ac, minOverlap = 10)\n\n\n\n# Add a name field and save the final integrated object\noverlap$name &lt;- paste(\"peak\", 1:length(overlap), sep = \"_\")\nnames(overlap) &lt;- overlap$name\n\ndir.create(\"output\")\n\nWarning in dir.create(\"output\"): 'output' already exists\n\nsaveRDS(object = overlap, file = \"output/overlap_data.rds\")\n\n\n\noverlap[1:3]\n\nGRanges object with 3 ranges and 109 metadata columns:\n         seqnames          ranges strand |        ATAC_annotation ATAC_geneChr\n            &lt;Rle&gt;       &lt;IRanges&gt;  &lt;Rle&gt; |            &lt;character&gt;    &lt;integer&gt;\n  peak_1     chr1 3670547-3672665      * |       Promoter (&lt;=1kb)            1\n  peak_2     chr1 4332510-4332710      * | Intron (ENSMUST00000..            1\n  peak_3     chr1 4491755-4492573      * |       Promoter (1-2kb)            1\n         ATAC_geneStart ATAC_geneEnd ATAC_geneLength ATAC_geneStrand\n              &lt;integer&gt;    &lt;integer&gt;       &lt;integer&gt;       &lt;integer&gt;\n  peak_1        3214482      3671498          457017               2\n  peak_2        4344146      4360314           16169               2\n  peak_3        4492465      4493735            1271               2\n         ATAC_geneId    ATAC_transcriptId ATAC_distanceToTSS       ATAC_ENSEMBL\n         &lt;character&gt;          &lt;character&gt;          &lt;numeric&gt;        &lt;character&gt;\n  peak_1      497097 ENSMUST00000070533.4                  0 ENSMUSG00000051951\n  peak_2       19888 ENSMUST00000027032.5              27604 ENSMUSG00000025900\n  peak_3       20671 ENSMUST00000191939.1               1162 ENSMUSG00000025902\n         ATAC_SYMBOL          ATAC_GENENAME   ATAC_anno ATAC_logFC ATAC_logCPM\n         &lt;character&gt;            &lt;character&gt; &lt;character&gt;  &lt;numeric&gt;   &lt;numeric&gt;\n  peak_1        Xkr4 X-linked Kx blood gr..    Promoter   0.602984    10.45378\n  peak_2         Rp1 retinitis pigmentosa..      Intron   0.855748     5.18424\n  peak_3       Sox17 SRY (sex determining..    Promoter  -0.620926     7.13469\n            ATAC_F ATAC_PValue ATAC_qvalue      RNA_Row.names RNA_gene_id\n         &lt;numeric&gt;   &lt;numeric&gt;   &lt;numeric&gt;        &lt;character&gt; &lt;character&gt;\n  peak_1  41.78446 6.58453e-08 4.81983e-07 ENSMUSG00000051951      497097\n  peak_2   3.68371 6.13517e-02 9.28785e-02               &lt;NA&gt;        &lt;NA&gt;\n  peak_3   9.14522 4.12368e-03 8.38540e-03               &lt;NA&gt;        &lt;NA&gt;\n          RNA_SYMBOL           RNA_GENENAME        RNA_ENSEMBL RNA_geneLength\n         &lt;character&gt;            &lt;character&gt;        &lt;character&gt;      &lt;integer&gt;\n  peak_1        Xkr4 X-linked Kx blood gr.. ENSMUSG00000051951         457017\n  peak_2        &lt;NA&gt;                   &lt;NA&gt;               &lt;NA&gt;           &lt;NA&gt;\n  peak_3        &lt;NA&gt;                   &lt;NA&gt;               &lt;NA&gt;           &lt;NA&gt;\n         RNA_geneChr RNA_geneStart RNA_geneEnd RNA_geneStrand  RNA_geneId\n         &lt;character&gt;     &lt;integer&gt;   &lt;integer&gt;    &lt;character&gt; &lt;character&gt;\n  peak_1        chr1       3214482     3671498              -      497097\n  peak_2        &lt;NA&gt;          &lt;NA&gt;        &lt;NA&gt;           &lt;NA&gt;        &lt;NA&gt;\n  peak_3        &lt;NA&gt;          &lt;NA&gt;        &lt;NA&gt;           &lt;NA&gt;        &lt;NA&gt;\n             RNA_transcriptId    RNA_anno RNA_logFC RNA_logCPM     RNA_F\n                  &lt;character&gt; &lt;character&gt; &lt;numeric&gt;  &lt;numeric&gt; &lt;numeric&gt;\n  peak_1 ENSMUST00000070533.4        Gene   1.37498    5.62452   33.7077\n  peak_2                 &lt;NA&gt;        &lt;NA&gt;        NA         NA        NA\n  peak_3                 &lt;NA&gt;        &lt;NA&gt;        NA         NA        NA\n         RNA_PValue RNA_qvalue H3K4me3_annotation H3K4me3_geneChr\n          &lt;numeric&gt;  &lt;numeric&gt;        &lt;character&gt;       &lt;integer&gt;\n  peak_1 0.00224273 0.00628871   Promoter (&lt;=1kb)               1\n  peak_2         NA         NA               &lt;NA&gt;            &lt;NA&gt;\n  peak_3         NA         NA               &lt;NA&gt;            &lt;NA&gt;\n         H3K4me3_geneStart H3K4me3_geneEnd H3K4me3_geneLength\n                 &lt;integer&gt;       &lt;integer&gt;          &lt;integer&gt;\n  peak_1           3214482         3671498             457017\n  peak_2              &lt;NA&gt;            &lt;NA&gt;               &lt;NA&gt;\n  peak_3              &lt;NA&gt;            &lt;NA&gt;               &lt;NA&gt;\n         H3K4me3_geneStrand H3K4me3_geneId H3K4me3_transcriptId\n                  &lt;integer&gt;    &lt;character&gt;          &lt;character&gt;\n  peak_1                  2         497097 ENSMUST00000070533.4\n  peak_2               &lt;NA&gt;           &lt;NA&gt;                 &lt;NA&gt;\n  peak_3               &lt;NA&gt;           &lt;NA&gt;                 &lt;NA&gt;\n         H3K4me3_distanceToTSS    H3K4me3_ENSEMBL H3K4me3_SYMBOL\n                     &lt;numeric&gt;        &lt;character&gt;    &lt;character&gt;\n  peak_1                     0 ENSMUSG00000051951           Xkr4\n  peak_2                    NA               &lt;NA&gt;           &lt;NA&gt;\n  peak_3                    NA               &lt;NA&gt;           &lt;NA&gt;\n               H3K4me3_GENENAME H3K4me3_anno H3K4me3_logFC H3K4me3_logCPM\n                    &lt;character&gt;  &lt;character&gt;     &lt;numeric&gt;      &lt;numeric&gt;\n  peak_1 X-linked Kx blood gr..     Promoter      0.607114        9.26749\n  peak_2                   &lt;NA&gt;         &lt;NA&gt;            NA             NA\n  peak_3                   &lt;NA&gt;         &lt;NA&gt;            NA             NA\n         H3K4me3_F H3K4me3_PValue H3K4me3_qvalue H3K4me1_annotation\n         &lt;numeric&gt;      &lt;numeric&gt;      &lt;numeric&gt;        &lt;character&gt;\n  peak_1   135.443    4.65079e-31    1.28968e-29               &lt;NA&gt;\n  peak_2        NA             NA             NA               &lt;NA&gt;\n  peak_3        NA             NA             NA               &lt;NA&gt;\n         H3K4me1_geneChr H3K4me1_geneStart H3K4me1_geneEnd H3K4me1_geneLength\n               &lt;integer&gt;         &lt;integer&gt;       &lt;integer&gt;          &lt;integer&gt;\n  peak_1            &lt;NA&gt;              &lt;NA&gt;            &lt;NA&gt;               &lt;NA&gt;\n  peak_2            &lt;NA&gt;              &lt;NA&gt;            &lt;NA&gt;               &lt;NA&gt;\n  peak_3            &lt;NA&gt;              &lt;NA&gt;            &lt;NA&gt;               &lt;NA&gt;\n         H3K4me1_geneStrand H3K4me1_geneId H3K4me1_transcriptId\n                  &lt;integer&gt;    &lt;character&gt;          &lt;character&gt;\n  peak_1               &lt;NA&gt;           &lt;NA&gt;                 &lt;NA&gt;\n  peak_2               &lt;NA&gt;           &lt;NA&gt;                 &lt;NA&gt;\n  peak_3               &lt;NA&gt;           &lt;NA&gt;                 &lt;NA&gt;\n         H3K4me1_distanceToTSS H3K4me1_ENSEMBL H3K4me1_SYMBOL H3K4me1_GENENAME\n                     &lt;numeric&gt;     &lt;character&gt;    &lt;character&gt;      &lt;character&gt;\n  peak_1                    NA            &lt;NA&gt;           &lt;NA&gt;             &lt;NA&gt;\n  peak_2                    NA            &lt;NA&gt;           &lt;NA&gt;             &lt;NA&gt;\n  peak_3                    NA            &lt;NA&gt;           &lt;NA&gt;             &lt;NA&gt;\n         H3K4me1_anno H3K4me1_logFC H3K4me1_logCPM H3K4me1_F H3K4me1_PValue\n          &lt;character&gt;     &lt;numeric&gt;      &lt;numeric&gt; &lt;numeric&gt;      &lt;numeric&gt;\n  peak_1         &lt;NA&gt;            NA             NA        NA             NA\n  peak_2         &lt;NA&gt;            NA             NA        NA             NA\n  peak_3         &lt;NA&gt;            NA             NA        NA             NA\n         H3K4me1_qvalue H3K27me3_annotation H3K27me3_geneChr H3K27me3_geneStart\n              &lt;numeric&gt;         &lt;character&gt;        &lt;integer&gt;          &lt;integer&gt;\n  peak_1             NA                &lt;NA&gt;             &lt;NA&gt;               &lt;NA&gt;\n  peak_2             NA                &lt;NA&gt;             &lt;NA&gt;               &lt;NA&gt;\n  peak_3             NA    Promoter (&lt;=1kb)                1            4492465\n         H3K27me3_geneEnd H3K27me3_geneLength H3K27me3_geneStrand\n                &lt;integer&gt;           &lt;integer&gt;           &lt;integer&gt;\n  peak_1             &lt;NA&gt;                &lt;NA&gt;                &lt;NA&gt;\n  peak_2             &lt;NA&gt;                &lt;NA&gt;                &lt;NA&gt;\n  peak_3          4493735                1271                   2\n         H3K27me3_geneId H3K27me3_transcriptId H3K27me3_distanceToTSS\n             &lt;character&gt;           &lt;character&gt;              &lt;numeric&gt;\n  peak_1            &lt;NA&gt;                  &lt;NA&gt;                     NA\n  peak_2            &lt;NA&gt;                  &lt;NA&gt;                     NA\n  peak_3           20671  ENSMUST00000191939.1                      0\n           H3K27me3_ENSEMBL H3K27me3_SYMBOL      H3K27me3_GENENAME\n                &lt;character&gt;     &lt;character&gt;            &lt;character&gt;\n  peak_1               &lt;NA&gt;            &lt;NA&gt;                   &lt;NA&gt;\n  peak_2               &lt;NA&gt;            &lt;NA&gt;                   &lt;NA&gt;\n  peak_3 ENSMUSG00000025902           Sox17 SRY (sex determining..\n         H3K27me3_anno H3K27me3_logFC H3K27me3_logCPM H3K27me3_F\n           &lt;character&gt;      &lt;numeric&gt;       &lt;numeric&gt;  &lt;numeric&gt;\n  peak_1          &lt;NA&gt;             NA              NA         NA\n  peak_2          &lt;NA&gt;             NA              NA         NA\n  peak_3      Promoter        -1.0597         9.04668    87.0802\n         H3K27me3_PValue H3K27me3_qvalue H3K27ac_annotation H3K27ac_geneChr\n               &lt;numeric&gt;       &lt;numeric&gt;        &lt;character&gt;       &lt;integer&gt;\n  peak_1              NA              NA   Promoter (&lt;=1kb)               1\n  peak_2              NA              NA               &lt;NA&gt;            &lt;NA&gt;\n  peak_3     1.32026e-20     5.28858e-18               &lt;NA&gt;            &lt;NA&gt;\n         H3K27ac_geneStart H3K27ac_geneEnd H3K27ac_geneLength\n                 &lt;integer&gt;       &lt;integer&gt;          &lt;integer&gt;\n  peak_1           3214482         3671498             457017\n  peak_2              &lt;NA&gt;            &lt;NA&gt;               &lt;NA&gt;\n  peak_3              &lt;NA&gt;            &lt;NA&gt;               &lt;NA&gt;\n         H3K27ac_geneStrand H3K27ac_geneId H3K27ac_transcriptId\n                  &lt;integer&gt;    &lt;character&gt;          &lt;character&gt;\n  peak_1                  2         497097 ENSMUST00000070533.4\n  peak_2               &lt;NA&gt;           &lt;NA&gt;                 &lt;NA&gt;\n  peak_3               &lt;NA&gt;           &lt;NA&gt;                 &lt;NA&gt;\n         H3K27ac_distanceToTSS    H3K27ac_ENSEMBL H3K27ac_SYMBOL\n                     &lt;numeric&gt;        &lt;character&gt;    &lt;character&gt;\n  peak_1                     0 ENSMUSG00000051951           Xkr4\n  peak_2                    NA               &lt;NA&gt;           &lt;NA&gt;\n  peak_3                    NA               &lt;NA&gt;           &lt;NA&gt;\n               H3K27ac_GENENAME H3K27ac_anno H3K27ac_logFC H3K27ac_logCPM\n                    &lt;character&gt;  &lt;character&gt;     &lt;numeric&gt;      &lt;numeric&gt;\n  peak_1 X-linked Kx blood gr..     Promoter       1.25269        8.81735\n  peak_2                   &lt;NA&gt;         &lt;NA&gt;            NA             NA\n  peak_3                   &lt;NA&gt;         &lt;NA&gt;            NA             NA\n         H3K27ac_F H3K27ac_PValue H3K27ac_qvalue        name\n         &lt;numeric&gt;      &lt;numeric&gt;      &lt;numeric&gt; &lt;character&gt;\n  peak_1   151.496    1.67395e-34     4.0813e-32      peak_1\n  peak_2        NA             NA             NA      peak_2\n  peak_3        NA             NA             NA      peak_3\n  -------\n  seqinfo: 21 sequences from an unspecified genome; no seqlengths"
  },
  {
    "objectID": "day2/day2-1_overlap_matrix.html#learning-objectives",
    "href": "day2/day2-1_overlap_matrix.html#learning-objectives",
    "title": "Exercise 4",
    "section": "",
    "text": "By the end of this exercise, you will be able to: - Load and explore genomic data using Bioconductor classes such as GRangesList and RangedSummarizedExperiment. - Subset and filter genomic features based on annotation or genomic coordinates. - Perform basic overlap and distance-based queries between genomic intervals. - Integrate multi-assay data (e.g., chromatin marks and gene expression) using shared genomic coordinates."
  },
  {
    "objectID": "day2/day2-1_overlap_matrix.html#load-libraries",
    "href": "day2/day2-1_overlap_matrix.html#load-libraries",
    "title": "Exercise 4",
    "section": "",
    "text": "library(ComplexHeatmap)\nlibrary(EnrichedHeatmap)\nlibrary(SummarizedExperiment)\nlibrary(gUtils)\nlibrary(rtracklayer)\nlibrary(data.table)\nlibrary(parallel)\nlibrary(R.utils)\nlibrary(circlize)"
  },
  {
    "objectID": "day2/day2-1_overlap_matrix.html#se-objects",
    "href": "day2/day2-1_overlap_matrix.html#se-objects",
    "title": "Exercise 4",
    "section": "",
    "text": "atac &lt;- readRDS(\"data/atac_se.rds\")\nrna &lt;- readRDS(\"data/rna_se.rds\")\nh3k4me3 &lt;- readRDS(\"data/h3k4me3_se.rds\")\nh3k4me1 &lt;- readRDS(\"data/h3k4me1_se.rds\")\nh3k27me3 &lt;- readRDS(\"data/h3k27me3_se.rds\")\nh3k27ac &lt;- readRDS(\"data/h3k27ac_se.rds\")"
  },
  {
    "objectID": "day2/day2-1_overlap_matrix.html#function-to-merge-genomic-ranges",
    "href": "day2/day2-1_overlap_matrix.html#function-to-merge-genomic-ranges",
    "title": "Exercise 4",
    "section": "",
    "text": "# Merge metadata from two GRanges objects based on overlaps\nmetaGR &lt;- function(gr1, gr2, minOverlap = 1) {\n  # Initialize metadata with gr1's metadata\n  mcols_out &lt;- mcols(gr1)\n\n  # Find overlaps (keep all from gr1)\n  hits &lt;- findOverlaps(gr1, gr2, minoverlap = minOverlap)\n  idx1 &lt;- subjectHits(hits)\n  idx2 &lt;- queryHits(hits)\n\n  # Prepare new metadata to be added\n  new_mcols &lt;- DataFrame(matrix(NA, nrow = length(gr1), ncol = ncol(mcols(gr2))))\n  colnames(new_mcols) &lt;- colnames(mcols(gr2))\n  \n  # Fill metadata only for overlaps\n  new_mcols[idx2, ] &lt;- mcols(gr2)[idx1, , drop = FALSE]\n\n  # Combine original and new metadata\n  mcols(gr1) &lt;- cbind(mcols_out, new_mcols)\n  \n  return(gr1)\n}"
  },
  {
    "objectID": "day2/day2-1_overlap_matrix.html#atac-seq",
    "href": "day2/day2-1_overlap_matrix.html#atac-seq",
    "title": "Exercise 4",
    "section": "",
    "text": "# Extract rowRanges and filter peaks with strong signal\nrd_atac &lt;- rowRanges(atac)\nrd_atac &lt;- rd_atac[abs(rd_atac$logFC) &gt;= 0.5 & rd_atac$qvalue &lt;= 0.1]\ncolnames(elementMetadata(rd_atac)) &lt;- paste(\"ATAC\", colnames(elementMetadata(rd_atac)), sep = \"_\")"
  },
  {
    "objectID": "day2/day2-1_overlap_matrix.html#rna",
    "href": "day2/day2-1_overlap_matrix.html#rna",
    "title": "Exercise 4",
    "section": "",
    "text": "# Filter differentially expressed genes\nrd_rna &lt;- rowRanges(rna)\nrd_rna &lt;- rd_rna[abs(rd_rna$logFC) &gt;= 0.5 & rd_rna$qvalue &lt;= 0.1]\ncolnames(elementMetadata(rd_rna)) &lt;- paste(\"RNA\", colnames(elementMetadata(rd_rna)), sep = \"_\")\noverlap &lt;- metaGR(gr1 = rd_atac, gr2 = rd_rna, minOverlap = 10)"
  },
  {
    "objectID": "day2/day2-1_overlap_matrix.html#chip-seq",
    "href": "day2/day2-1_overlap_matrix.html#chip-seq",
    "title": "Exercise 4",
    "section": "",
    "text": "rd_h3k4me3 &lt;- rowRanges(h3k4me3)\nrd_h3k4me3 &lt;- rd_h3k4me3[abs(rd_h3k4me3$logFC) &gt;= 0.5 & rd_h3k4me3$qvalue &lt;= 0.1]\ncolnames(elementMetadata(rd_h3k4me3)) &lt;- paste(\"H3K4me3\", colnames(elementMetadata(rd_h3k4me3)), sep = \"_\")\noverlap &lt;- metaGR(gr1 = overlap, gr2 = rd_h3k4me3, minOverlap = 10)\n\n\n\nrd_h3k4me1 &lt;- rowRanges(h3k4me1)\nrd_h3k4me1 &lt;- rd_h3k4me1[abs(rd_h3k4me1$logFC) &gt;= 0.5 & rd_h3k4me1$qvalue &lt;= 0.1]\ncolnames(elementMetadata(rd_h3k4me1)) &lt;- paste(\"H3K4me1\", colnames(elementMetadata(rd_h3k4me1)), sep = \"_\")\noverlap &lt;- metaGR(gr1 = overlap, gr2 = rd_h3k4me1, minOverlap = 10)\n\nWarning in .merge_two_Seqinfo_objects(x, y): Each of the 2 combined objects has sequence levels not in the other:\n  - in 'x': chrY\n  - in 'y': chr4_GL456216_random, chr4_JH584295_random, chrX_GL456233_random, chrUn_JH584304\n  Make sure to always combine/compare objects based on the same reference\n  genome (use suppressWarnings() to suppress this warning).\n\n\n\n\nrd_h3k27me3 &lt;- rowRanges(h3k27me3)\nrd_h3k27me3 &lt;- rd_h3k27me3[abs(rd_h3k27me3$logFC) &gt;= 0.5 & rd_h3k27me3$qvalue &lt;= 0.1]\ncolnames(elementMetadata(rd_h3k27me3)) &lt;- paste(\"H3K27me3\", colnames(elementMetadata(rd_h3k27me3)), sep = \"_\")\noverlap &lt;- metaGR(gr1 = overlap, gr2 = rd_h3k27me3, minOverlap = 10)\n\n\n\nrd_h3k27ac &lt;- rowRanges(h3k27ac)\nrd_h3k27ac &lt;- rd_h3k27ac[abs(rd_h3k27ac$logFC) &gt;= 0.5 & rd_h3k27ac$qvalue &lt;= 0.1]\ncolnames(elementMetadata(rd_h3k27ac)) &lt;- paste(\"H3K27ac\", colnames(elementMetadata(rd_h3k27ac)), sep = \"_\")\noverlap &lt;- metaGR(gr1 = overlap, gr2 = rd_h3k27ac, minOverlap = 10)"
  },
  {
    "objectID": "day2/day2-1_overlap_matrix.html#save-data",
    "href": "day2/day2-1_overlap_matrix.html#save-data",
    "title": "Exercise 4",
    "section": "",
    "text": "# Add a name field and save the final integrated object\noverlap$name &lt;- paste(\"peak\", 1:length(overlap), sep = \"_\")\nnames(overlap) &lt;- overlap$name\n\ndir.create(\"output\")\n\nWarning in dir.create(\"output\"): 'output' already exists\n\nsaveRDS(object = overlap, file = \"output/overlap_data.rds\")\n\n\n\noverlap[1:3]\n\nGRanges object with 3 ranges and 109 metadata columns:\n         seqnames          ranges strand |        ATAC_annotation ATAC_geneChr\n            &lt;Rle&gt;       &lt;IRanges&gt;  &lt;Rle&gt; |            &lt;character&gt;    &lt;integer&gt;\n  peak_1     chr1 3670547-3672665      * |       Promoter (&lt;=1kb)            1\n  peak_2     chr1 4332510-4332710      * | Intron (ENSMUST00000..            1\n  peak_3     chr1 4491755-4492573      * |       Promoter (1-2kb)            1\n         ATAC_geneStart ATAC_geneEnd ATAC_geneLength ATAC_geneStrand\n              &lt;integer&gt;    &lt;integer&gt;       &lt;integer&gt;       &lt;integer&gt;\n  peak_1        3214482      3671498          457017               2\n  peak_2        4344146      4360314           16169               2\n  peak_3        4492465      4493735            1271               2\n         ATAC_geneId    ATAC_transcriptId ATAC_distanceToTSS       ATAC_ENSEMBL\n         &lt;character&gt;          &lt;character&gt;          &lt;numeric&gt;        &lt;character&gt;\n  peak_1      497097 ENSMUST00000070533.4                  0 ENSMUSG00000051951\n  peak_2       19888 ENSMUST00000027032.5              27604 ENSMUSG00000025900\n  peak_3       20671 ENSMUST00000191939.1               1162 ENSMUSG00000025902\n         ATAC_SYMBOL          ATAC_GENENAME   ATAC_anno ATAC_logFC ATAC_logCPM\n         &lt;character&gt;            &lt;character&gt; &lt;character&gt;  &lt;numeric&gt;   &lt;numeric&gt;\n  peak_1        Xkr4 X-linked Kx blood gr..    Promoter   0.602984    10.45378\n  peak_2         Rp1 retinitis pigmentosa..      Intron   0.855748     5.18424\n  peak_3       Sox17 SRY (sex determining..    Promoter  -0.620926     7.13469\n            ATAC_F ATAC_PValue ATAC_qvalue      RNA_Row.names RNA_gene_id\n         &lt;numeric&gt;   &lt;numeric&gt;   &lt;numeric&gt;        &lt;character&gt; &lt;character&gt;\n  peak_1  41.78446 6.58453e-08 4.81983e-07 ENSMUSG00000051951      497097\n  peak_2   3.68371 6.13517e-02 9.28785e-02               &lt;NA&gt;        &lt;NA&gt;\n  peak_3   9.14522 4.12368e-03 8.38540e-03               &lt;NA&gt;        &lt;NA&gt;\n          RNA_SYMBOL           RNA_GENENAME        RNA_ENSEMBL RNA_geneLength\n         &lt;character&gt;            &lt;character&gt;        &lt;character&gt;      &lt;integer&gt;\n  peak_1        Xkr4 X-linked Kx blood gr.. ENSMUSG00000051951         457017\n  peak_2        &lt;NA&gt;                   &lt;NA&gt;               &lt;NA&gt;           &lt;NA&gt;\n  peak_3        &lt;NA&gt;                   &lt;NA&gt;               &lt;NA&gt;           &lt;NA&gt;\n         RNA_geneChr RNA_geneStart RNA_geneEnd RNA_geneStrand  RNA_geneId\n         &lt;character&gt;     &lt;integer&gt;   &lt;integer&gt;    &lt;character&gt; &lt;character&gt;\n  peak_1        chr1       3214482     3671498              -      497097\n  peak_2        &lt;NA&gt;          &lt;NA&gt;        &lt;NA&gt;           &lt;NA&gt;        &lt;NA&gt;\n  peak_3        &lt;NA&gt;          &lt;NA&gt;        &lt;NA&gt;           &lt;NA&gt;        &lt;NA&gt;\n             RNA_transcriptId    RNA_anno RNA_logFC RNA_logCPM     RNA_F\n                  &lt;character&gt; &lt;character&gt; &lt;numeric&gt;  &lt;numeric&gt; &lt;numeric&gt;\n  peak_1 ENSMUST00000070533.4        Gene   1.37498    5.62452   33.7077\n  peak_2                 &lt;NA&gt;        &lt;NA&gt;        NA         NA        NA\n  peak_3                 &lt;NA&gt;        &lt;NA&gt;        NA         NA        NA\n         RNA_PValue RNA_qvalue H3K4me3_annotation H3K4me3_geneChr\n          &lt;numeric&gt;  &lt;numeric&gt;        &lt;character&gt;       &lt;integer&gt;\n  peak_1 0.00224273 0.00628871   Promoter (&lt;=1kb)               1\n  peak_2         NA         NA               &lt;NA&gt;            &lt;NA&gt;\n  peak_3         NA         NA               &lt;NA&gt;            &lt;NA&gt;\n         H3K4me3_geneStart H3K4me3_geneEnd H3K4me3_geneLength\n                 &lt;integer&gt;       &lt;integer&gt;          &lt;integer&gt;\n  peak_1           3214482         3671498             457017\n  peak_2              &lt;NA&gt;            &lt;NA&gt;               &lt;NA&gt;\n  peak_3              &lt;NA&gt;            &lt;NA&gt;               &lt;NA&gt;\n         H3K4me3_geneStrand H3K4me3_geneId H3K4me3_transcriptId\n                  &lt;integer&gt;    &lt;character&gt;          &lt;character&gt;\n  peak_1                  2         497097 ENSMUST00000070533.4\n  peak_2               &lt;NA&gt;           &lt;NA&gt;                 &lt;NA&gt;\n  peak_3               &lt;NA&gt;           &lt;NA&gt;                 &lt;NA&gt;\n         H3K4me3_distanceToTSS    H3K4me3_ENSEMBL H3K4me3_SYMBOL\n                     &lt;numeric&gt;        &lt;character&gt;    &lt;character&gt;\n  peak_1                     0 ENSMUSG00000051951           Xkr4\n  peak_2                    NA               &lt;NA&gt;           &lt;NA&gt;\n  peak_3                    NA               &lt;NA&gt;           &lt;NA&gt;\n               H3K4me3_GENENAME H3K4me3_anno H3K4me3_logFC H3K4me3_logCPM\n                    &lt;character&gt;  &lt;character&gt;     &lt;numeric&gt;      &lt;numeric&gt;\n  peak_1 X-linked Kx blood gr..     Promoter      0.607114        9.26749\n  peak_2                   &lt;NA&gt;         &lt;NA&gt;            NA             NA\n  peak_3                   &lt;NA&gt;         &lt;NA&gt;            NA             NA\n         H3K4me3_F H3K4me3_PValue H3K4me3_qvalue H3K4me1_annotation\n         &lt;numeric&gt;      &lt;numeric&gt;      &lt;numeric&gt;        &lt;character&gt;\n  peak_1   135.443    4.65079e-31    1.28968e-29               &lt;NA&gt;\n  peak_2        NA             NA             NA               &lt;NA&gt;\n  peak_3        NA             NA             NA               &lt;NA&gt;\n         H3K4me1_geneChr H3K4me1_geneStart H3K4me1_geneEnd H3K4me1_geneLength\n               &lt;integer&gt;         &lt;integer&gt;       &lt;integer&gt;          &lt;integer&gt;\n  peak_1            &lt;NA&gt;              &lt;NA&gt;            &lt;NA&gt;               &lt;NA&gt;\n  peak_2            &lt;NA&gt;              &lt;NA&gt;            &lt;NA&gt;               &lt;NA&gt;\n  peak_3            &lt;NA&gt;              &lt;NA&gt;            &lt;NA&gt;               &lt;NA&gt;\n         H3K4me1_geneStrand H3K4me1_geneId H3K4me1_transcriptId\n                  &lt;integer&gt;    &lt;character&gt;          &lt;character&gt;\n  peak_1               &lt;NA&gt;           &lt;NA&gt;                 &lt;NA&gt;\n  peak_2               &lt;NA&gt;           &lt;NA&gt;                 &lt;NA&gt;\n  peak_3               &lt;NA&gt;           &lt;NA&gt;                 &lt;NA&gt;\n         H3K4me1_distanceToTSS H3K4me1_ENSEMBL H3K4me1_SYMBOL H3K4me1_GENENAME\n                     &lt;numeric&gt;     &lt;character&gt;    &lt;character&gt;      &lt;character&gt;\n  peak_1                    NA            &lt;NA&gt;           &lt;NA&gt;             &lt;NA&gt;\n  peak_2                    NA            &lt;NA&gt;           &lt;NA&gt;             &lt;NA&gt;\n  peak_3                    NA            &lt;NA&gt;           &lt;NA&gt;             &lt;NA&gt;\n         H3K4me1_anno H3K4me1_logFC H3K4me1_logCPM H3K4me1_F H3K4me1_PValue\n          &lt;character&gt;     &lt;numeric&gt;      &lt;numeric&gt; &lt;numeric&gt;      &lt;numeric&gt;\n  peak_1         &lt;NA&gt;            NA             NA        NA             NA\n  peak_2         &lt;NA&gt;            NA             NA        NA             NA\n  peak_3         &lt;NA&gt;            NA             NA        NA             NA\n         H3K4me1_qvalue H3K27me3_annotation H3K27me3_geneChr H3K27me3_geneStart\n              &lt;numeric&gt;         &lt;character&gt;        &lt;integer&gt;          &lt;integer&gt;\n  peak_1             NA                &lt;NA&gt;             &lt;NA&gt;               &lt;NA&gt;\n  peak_2             NA                &lt;NA&gt;             &lt;NA&gt;               &lt;NA&gt;\n  peak_3             NA    Promoter (&lt;=1kb)                1            4492465\n         H3K27me3_geneEnd H3K27me3_geneLength H3K27me3_geneStrand\n                &lt;integer&gt;           &lt;integer&gt;           &lt;integer&gt;\n  peak_1             &lt;NA&gt;                &lt;NA&gt;                &lt;NA&gt;\n  peak_2             &lt;NA&gt;                &lt;NA&gt;                &lt;NA&gt;\n  peak_3          4493735                1271                   2\n         H3K27me3_geneId H3K27me3_transcriptId H3K27me3_distanceToTSS\n             &lt;character&gt;           &lt;character&gt;              &lt;numeric&gt;\n  peak_1            &lt;NA&gt;                  &lt;NA&gt;                     NA\n  peak_2            &lt;NA&gt;                  &lt;NA&gt;                     NA\n  peak_3           20671  ENSMUST00000191939.1                      0\n           H3K27me3_ENSEMBL H3K27me3_SYMBOL      H3K27me3_GENENAME\n                &lt;character&gt;     &lt;character&gt;            &lt;character&gt;\n  peak_1               &lt;NA&gt;            &lt;NA&gt;                   &lt;NA&gt;\n  peak_2               &lt;NA&gt;            &lt;NA&gt;                   &lt;NA&gt;\n  peak_3 ENSMUSG00000025902           Sox17 SRY (sex determining..\n         H3K27me3_anno H3K27me3_logFC H3K27me3_logCPM H3K27me3_F\n           &lt;character&gt;      &lt;numeric&gt;       &lt;numeric&gt;  &lt;numeric&gt;\n  peak_1          &lt;NA&gt;             NA              NA         NA\n  peak_2          &lt;NA&gt;             NA              NA         NA\n  peak_3      Promoter        -1.0597         9.04668    87.0802\n         H3K27me3_PValue H3K27me3_qvalue H3K27ac_annotation H3K27ac_geneChr\n               &lt;numeric&gt;       &lt;numeric&gt;        &lt;character&gt;       &lt;integer&gt;\n  peak_1              NA              NA   Promoter (&lt;=1kb)               1\n  peak_2              NA              NA               &lt;NA&gt;            &lt;NA&gt;\n  peak_3     1.32026e-20     5.28858e-18               &lt;NA&gt;            &lt;NA&gt;\n         H3K27ac_geneStart H3K27ac_geneEnd H3K27ac_geneLength\n                 &lt;integer&gt;       &lt;integer&gt;          &lt;integer&gt;\n  peak_1           3214482         3671498             457017\n  peak_2              &lt;NA&gt;            &lt;NA&gt;               &lt;NA&gt;\n  peak_3              &lt;NA&gt;            &lt;NA&gt;               &lt;NA&gt;\n         H3K27ac_geneStrand H3K27ac_geneId H3K27ac_transcriptId\n                  &lt;integer&gt;    &lt;character&gt;          &lt;character&gt;\n  peak_1                  2         497097 ENSMUST00000070533.4\n  peak_2               &lt;NA&gt;           &lt;NA&gt;                 &lt;NA&gt;\n  peak_3               &lt;NA&gt;           &lt;NA&gt;                 &lt;NA&gt;\n         H3K27ac_distanceToTSS    H3K27ac_ENSEMBL H3K27ac_SYMBOL\n                     &lt;numeric&gt;        &lt;character&gt;    &lt;character&gt;\n  peak_1                     0 ENSMUSG00000051951           Xkr4\n  peak_2                    NA               &lt;NA&gt;           &lt;NA&gt;\n  peak_3                    NA               &lt;NA&gt;           &lt;NA&gt;\n               H3K27ac_GENENAME H3K27ac_anno H3K27ac_logFC H3K27ac_logCPM\n                    &lt;character&gt;  &lt;character&gt;     &lt;numeric&gt;      &lt;numeric&gt;\n  peak_1 X-linked Kx blood gr..     Promoter       1.25269        8.81735\n  peak_2                   &lt;NA&gt;         &lt;NA&gt;            NA             NA\n  peak_3                   &lt;NA&gt;         &lt;NA&gt;            NA             NA\n         H3K27ac_F H3K27ac_PValue H3K27ac_qvalue        name\n         &lt;numeric&gt;      &lt;numeric&gt;      &lt;numeric&gt; &lt;character&gt;\n  peak_1   151.496    1.67395e-34     4.0813e-32      peak_1\n  peak_2        NA             NA             NA      peak_2\n  peak_3        NA             NA             NA      peak_3\n  -------\n  seqinfo: 21 sequences from an unspecified genome; no seqlengths"
  },
  {
    "objectID": "day2/day2-1_overlap_matrix.html#taking-1000-bp-around-the-mid-of-atac-peaks",
    "href": "day2/day2-1_overlap_matrix.html#taking-1000-bp-around-the-mid-of-atac-peaks",
    "title": "Exercise 4",
    "section": "Taking 1000 bp around the mid of ATAC-peaks",
    "text": "Taking 1000 bp around the mid of ATAC-peaks\n\n# Extract midpoints of peaks to create windows for visualization\nmid_peaks &lt;- gr.mid(overlap)"
  },
  {
    "objectID": "day2/day2-1_overlap_matrix.html#atac",
    "href": "day2/day2-1_overlap_matrix.html#atac",
    "title": "Exercise 4",
    "section": "ATAC",
    "text": "ATAC\n\n# Load ATAC bigWig files\natac_files &lt;- list.files(\"data\", pattern = \"ATAC\", full.names = TRUE)\nnames(atac_files) &lt;- gsub(pattern = \"\\\\.bw\", replacement = \"\", x = basename(atac_files))\natac_bw &lt;- lapply(atac_files, function(x){\n  a &lt;- rtracklayer::import(x)\n  a &lt;- a[seqnames(a) %in% c(\"chr1\", \"chr2\")]\n  a\n})\n\n# Normalize signal around mid_peaks\nmat_AS &lt;- lapply(atac_bw, FUN = function(x) {\n  normalizeToMatrix(x, mid_peaks,\n    extend = 1000,\n    value_column = \"score\",\n    include_target = TRUE,\n    mean_mode = \"w0\",\n    w = 20, \n    smooth = T,\n    background = 0\n  )\n})\n\nWarning: Width of `target` are all 1, `include_target` is set to `FALSE`.\nWarning: Width of `target` are all 1, `include_target` is set to `FALSE`.\n\nsaveRDS(mat_AS, file = \"./output/mat_atac.rds\")"
  },
  {
    "objectID": "day2/day2-1_overlap_matrix.html#chip",
    "href": "day2/day2-1_overlap_matrix.html#chip",
    "title": "Exercise 4",
    "section": "ChIP",
    "text": "ChIP\nH3K4me3\n\nh3k4me3_files &lt;- list.files(\"data\", pattern = \"H3K4me3\", full.names = TRUE)\nnames(h3k4me3_files) &lt;- gsub(pattern = \"\\\\.bw\", replacement = \"\", x = basename(h3k4me3_files))\nh3k4me3_bw &lt;- lapply(h3k4me3_files, function(x){\n  a &lt;- rtracklayer::import(x)\n  a &lt;- a[seqnames(a) %in% c(\"chr1\", \"chr2\")]\n  a\n})\n\nmat_h3k4me3 &lt;- lapply(h3k4me3_bw, FUN = function(x) {\n  normalizeToMatrix(x, mid_peaks,\n    extend = 1000,\n    value_column = \"score\",\n    include_target = TRUE,\n    mean_mode = \"w0\",\n    w = 20,\n    smooth = T,\n    background = 0\n  )\n})\n\nWarning: Width of `target` are all 1, `include_target` is set to `FALSE`.\nWarning: Width of `target` are all 1, `include_target` is set to `FALSE`.\n\nsaveRDS(mat_h3k4me3, file = \"./output/mat_h3k4me3.rds\")\n\nH3K4me1\n\nh3k4me1_files &lt;- list.files(\"data\", pattern = \"H3K4me1\", full.names = TRUE)\nnames(h3k4me1_files) &lt;- gsub(pattern = \"\\\\.bw\", replacement = \"\", x = basename(h3k4me1_files))\nh3k4me1_bw &lt;- lapply(h3k4me1_files, function(x){\n  a &lt;- rtracklayer::import(x)\n  a &lt;- a[seqnames(a) %in% c(\"chr1\", \"chr2\")]\n  a\n})\n\nmat_h3k4me1 &lt;- lapply(h3k4me1_bw, FUN = function(x) {\n  normalizeToMatrix(x, mid_peaks,\n    extend = 1000,\n    value_column = \"score\",\n    include_target = TRUE,\n    mean_mode = \"w0\",\n    w = 20,\n    smooth = T,\n    background = 0\n  )\n})\n\nWarning: Width of `target` are all 1, `include_target` is set to `FALSE`.\nWarning: Width of `target` are all 1, `include_target` is set to `FALSE`.\n\nsaveRDS(mat_h3k4me1, file = \"./output/mat_h3k4me1.rds\")\n\nH27K4me3\n\nh3k27me3_files &lt;- list.files(\"data\", pattern = \"H3K27me3\", full.names = TRUE)\nnames(h3k27me3_files) &lt;- gsub(pattern = \"\\\\.bw\", replacement = \"\", x = basename(h3k27me3_files))\nh3k27me3_bw &lt;- lapply(h3k27me3_files, function(x){\n  a &lt;- rtracklayer::import(x)\n  a &lt;- a[seqnames(a) %in% c(\"chr1\", \"chr2\")]\n  a\n})\n\nmat_h3k27me3 &lt;- lapply(h3k27me3_bw, FUN = function(x) {\n  normalizeToMatrix(x, mid_peaks,\n    extend = 1000,\n    value_column = \"score\",\n    include_target = TRUE,\n    mean_mode = \"w0\",\n    w = 20,\n    smooth = T,\n    background = 0\n  )\n})\n\nWarning: Width of `target` are all 1, `include_target` is set to `FALSE`.\nWarning: Width of `target` are all 1, `include_target` is set to `FALSE`.\n\nsaveRDS(mat_h3k27me3, file = \"./output/mat_h3k27me3.rds\")\n\nH27K4ac\n\nh3k27ac_files &lt;- list.files(\"data\", pattern = \"H3K27ac\", full.names = TRUE)\nnames(h3k27ac_files) &lt;- gsub(pattern = \"\\\\.bw\", replacement = \"\", x = basename(h3k27ac_files))\nh3k27ac_bw &lt;- lapply(h3k27ac_files, function(x){\n  a &lt;- rtracklayer::import(x)\n  a &lt;- a[seqnames(a) %in% c(\"chr1\", \"chr2\")]\n  a\n})\n\nmat_h3k27ac &lt;- lapply(h3k27ac_bw, FUN = function(x) {\n  normalizeToMatrix(x, mid_peaks,\n    extend = 1000,\n    value_column = \"score\",\n    include_target = TRUE,\n    mean_mode = \"w0\",\n    w = 20,\n    smooth = T,\n    background = 0\n  )\n})\n\nWarning: Width of `target` are all 1, `include_target` is set to `FALSE`.\nWarning: Width of `target` are all 1, `include_target` is set to `FALSE`.\n\nsaveRDS(mat_h3k27ac, file = \"./output/mat_h3k27ac.rds\")"
  },
  {
    "objectID": "day2/day2-1_overlap_matrix.html#rna-1",
    "href": "day2/day2-1_overlap_matrix.html#rna-1",
    "title": "Exercise 4",
    "section": "RNA",
    "text": "RNA\n\n# Match overlapping peak names with RNA-seq gene names\ntmp &lt;- elementMetadata(overlap)[,c(\"RNA_Row.names\", \"name\")]\n\n# Get logCPM matrix\ncounts &lt;- assay(rna, \"logCPM\")\ncounts &lt;- assay(rna, \"logCPM\") - rowMeans(\n  assay(rna, \"logCPM\")[, grep(pattern = \"11half\", x = colnames(assay(rna, \"logCPM\")),\n                              value = T)]\n)\n\n# Merge gene expression values with peaks\nmat_RNA &lt;- merge(tmp, counts, by.x = \"RNA_Row.names\", by.y = \"row.names\", all.x = T)\n\n# Set rownames to peak names and cleanup\nrownames(mat_RNA) &lt;- mat_RNA$name\nmat_RNA &lt;- mat_RNA[,-c(1:2)]\ncolnames(mat_RNA) &lt;- gsub(pattern = \".tsv.gz\", replacement = \"\", x = colnames(mat_RNA))\nmat_RNA &lt;- data.matrix(mat_RNA)\nmat_RNA &lt;- mat_RNA[names(overlap),]\n\n# Save data\nsaveRDS(mat_RNA, file = \"./output/mat_rna.rds\")"
  },
  {
    "objectID": "day2/day2-1_overlap_matrix.html#wgbs",
    "href": "day2/day2-1_overlap_matrix.html#wgbs",
    "title": "Exercise 4",
    "section": "WGBS",
    "text": "WGBS\n\n# Bisulfite seq coverage files after methylation call\nbs_files &lt;- list.files(\"data\", pattern = \"WGBS\", full.names = TRUE)\nnames(bs_files) &lt;- gsub(pattern = \"\\\\.bed.gz\", replacement = \"\", x = basename(bs_files))\n\n# Reading coverage\nbs_cov &lt;- lapply(bs_files, function(x) {\n  GRanges(  \n  fread(\n      input = x,\n      sep = \" \", quote = F, stringsAsFactors = F,\n      data.table = FALSE, nThread = parallel::detectCores(), showProgress = F,\n      col.names = c(\"seqnames\", \"start\", \"end\", \"cov\", \"Me\", \"Un\", \"meth\")\n    )\n  )\n})\n\n# Normalized matrics\nmat_bs &lt;- lapply(bs_cov, FUN = function(x) {\n    normalizeToMatrix(x, mid_peaks,\n      extend = 1000,\n      value_column = \"meth\",\n      include_target = TRUE,\n      smooth = TRUE,\n      mean_mode = \"absolute\",\n      background = NA\n    )\n})\n\nWarning: Width of `target` are all 1, `include_target` is set to `FALSE`.\n\n\nWarning: Smoothing is failed for one row because there are very few signals\noverlapped to it. Please use `failed_rows(mat)` to get the index of the\nfailed row and consider to remove it.\n\n\nWarning: Width of `target` are all 1, `include_target` is set to `FALSE`.\n\n\nAll signal values are within [0, 1], so we assume it is methylation\nsignal. Automatically set limit [0, 1] to the smoothed values. If this\nis not the case, set argument `limit = NA` in the function to remove\nthe limits. Set `verbose = FALSE` to turn off this message.\n\n\nWarning: Smoothing is failed for one row because there are very few signals\noverlapped to it. Please use `failed_rows(mat)` to get the index of the\nfailed row and consider to remove it.\n\nsaveRDS(mat_bs, file = \"./output/mat_bs.rds\")"
  },
  {
    "objectID": "day2/day2-1_overlap_matrix.html#question-1",
    "href": "day2/day2-1_overlap_matrix.html#question-1",
    "title": "Exercise 4",
    "section": "Question 1",
    "text": "Question 1\nMake an EnrichedHeatmap of methylation data.\n\n\n\n\n\n\nTip\n\n\n\n\n\n\nEnrichedHeatmap(\n  mat = mat_bs$WGBS_11half,    # normalized matrix\n  name = \"E11.5\",              # Name for the plot\n  width = unit(4, \"cm\"),       # Width of the heatmap\n  height = unit(8, \"cm\")      # Height of the heatmap\n) + EnrichedHeatmap(\n  mat = mat_bs$WGBS_15half,    # normalized matrix\n  name = \"E15.5\",              # Name for the plot\n  width = unit(4, \"cm\"),       # Width of the heatmap\n  height = unit(8, \"cm\")      # Height of the heatmap\n)\n\nThe automatically generated colors map from the 1^st and 99^th of the\nvalues in the matrix. There are outliers in the matrix whose patterns\nmight be hidden by this color mapping. You can manually set the color\nto `col` argument.\n\nUse `suppressMessages()` to turn off this message.\nThe automatically generated colors map from the 1^st and 99^th of the\nvalues in the matrix. There are outliers in the matrix whose patterns\nmight be hidden by this color mapping. You can manually set the color\nto `col` argument.\n\nUse `suppressMessages()` to turn off this message.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nImportant\n\n\n\nWe have not performed differential analysis for DNA methylation data. If you want, you can. Here, we are using DNA methylation as an observartory mark."
  },
  {
    "objectID": "day2/day2-3_multiomics.html",
    "href": "day2/day2-3_multiomics.html",
    "title": "Exercise 6",
    "section": "",
    "text": "library(ComplexHeatmap)\nlibrary(EnrichedHeatmap)\nlibrary(circlize)\nlibrary(SummarizedExperiment)\n\n\nHere we load the SummarizedExperiment for the ChIP-seq data\n\natac &lt;- readRDS(\"data/atac_se.rds\")\nh3k4me3 &lt;- readRDS(\"data/h3k4me3_se.rds\")\nh3k4me1 &lt;- readRDS(\"data/h3k4me1_se.rds\")\nh3k27me3 &lt;- readRDS(\"data/h3k27me3_se.rds\")\nh3k27ac &lt;- readRDS(\"data/h3k27ac_se.rds\")\nrna &lt;- readRDS(\"data/rna_se.rds\")\nrownames(colData(rna)) &lt;- gsub(pattern = \"\\\\.tsv.gz\", replacement = \"\", x = rownames(colData(rna)))\n\noverlap &lt;- readRDS(\"output/overlap_anno.rds\")\n\nmat_ATAC &lt;- readRDS(\"./output/mat_atac.rds\")\nmat_RNA &lt;- readRDS(\"./output/mat_rna.rds\")\nmat_H3K4me3 &lt;- readRDS(\"./output/mat_h3k4me3.rds\")\nmat_H3K4me1 &lt;- readRDS(\"./output/mat_h3k4me1.rds\")\nmat_H3K27me3 &lt;- readRDS(\"./output/mat_h3k27me3.rds\")\nmat_H3K27ac &lt;- readRDS(\"./output/mat_h3k27ac.rds\")\nmat_BS &lt;- readRDS(\"./output/mat_bs.rds\")\n\n\n\n\nlogFC_cols &lt;- grep(pattern = \"logFC\", x = colnames(elementMetadata(overlap)))\nmcols(overlap)[, logFC_cols] &lt;- lapply(mcols(overlap)[, logFC_cols, drop = FALSE], function(x) {\n  x[is.na(x)] &lt;- 0\n  return(x)\n})\n\ngained_enhancers &lt;- overlap$ATAC_logFC &gt; 0 & \n  overlap$H3K4me1_logFC &gt; 0 & \n  overlap$H3K27ac_logFC &gt; 0 & \n  is.na(overlap$H3K4me3_annotation) &\n  overlap$ATAC_distanceToTSS &gt; 2500 & \n  overlap$RNA_logFC &gt; 0\n\noverlap$ATAC_RNA[gained_enhancers] &lt;- \"Gained Enhancers\"\n\n\n\nlost_enhancers &lt;- overlap$ATAC_logFC &lt; 0 & \n  overlap$H3K4me1_logFC &lt; 0 & \n  overlap$H3K27ac_logFC &lt; 0 & \n  is.na(overlap$H3K4me3_annotation) &\n  overlap$ATAC_distanceToTSS &gt; 2500 & \n  overlap$RNA_logFC &lt; 0\n\noverlap$ATAC_RNA[lost_enhancers] &lt;- \"Lost Enhancers\"\n\n\n\nactive_promoters &lt;- overlap$ATAC_logFC &gt; 0 & \n  overlap$H3K4me3_logFC &gt; 0 & \n  overlap$H3K27ac_logFC &gt; 0 & \n  overlap$ATAC_distanceToTSS &lt; 2500 & \n  overlap$RNA_logFC &gt; 0\n\noverlap$ATAC_RNA[active_promoters] &lt;- \"Active Promoters\"\n\n\n\nrepressed_promoters &lt;- overlap$ATAC_logFC &lt; 0 & \n  overlap$H3K4me3_logFC &lt; 0 & \n  overlap$H3K27ac_logFC &lt; 0 & \n  overlap$H3K27me3_logFC &gt; 0 & \n  overlap$ATAC_distanceToTSS &lt; 2500 & \n  overlap$RNA_logFC &lt; 0\n\noverlap$ATAC_RNA[repressed_promoters] &lt;- \"Repressed Promoters\"\n\n\n\nsaveRDS(object = overlap, file = \"output/overlap_anno2.rds\")\n\n\n\n\nmake_EH &lt;- function(norm_mat, heatmap_cols = c(\"white\", \"red\"), split_rows = NULL, hm_name, col_fill = \"#ffcccc\"){\n  \n  if(length(heatmap_cols) == 2){\n    col_fun &lt;- colorRamp2(quantile(norm_mat, c(0.01, 0.99), na.rm = T), heatmap_cols)   \n  } else if(length(heatmap_cols) == 3){\n  col_fun &lt;- colorRamp2(quantile(mat_BS$WGBS_11half, c(0.01, 0.5, 0.99), na.rm = T), heatmap_cols)\n  } else{\n    message(\"Please update function!\")\n  }\n  \n  vmin &lt;- as.numeric(quantile(norm_mat, c(0.01), na.rm = T))\n  vmax &lt;- as.numeric(quantile(norm_mat, c(0.99), na.rm = T))\n  vmid &lt;- (vmin + vmax) / 2\n  legend_ticks &lt;- c(vmin, vmid, vmax)\n\nEnrichedHeatmap(\n  mat = norm_mat,\n  name = hm_name,\n  row_split = split_rows,\n  col = col_fun,\n  width = unit(2, \"cm\"),\n  height = unit(8, \"cm\"),\n  column_title = hm_name,\n  column_title_gp = gpar(fontsize = 8, fill = col_fill),\n  axis_name = c(\"-1kb\", \"mid\", \"1kb\"),\n  heatmap_legend_param = list(\n    at = legend_ticks,\n    legend_height = unit(0.5, \"cm\"),\n    legend_width = unit(0.1, \"cm\"),\n    labels = round(legend_ticks, digits = 1),\n    title_gp = gpar(fontsize = 8),\n    labels_gp = gpar(fontsize = 7)\n  ),\n  top_annotation = HeatmapAnnotation(\n    lines = anno_enriched(\n      height = unit(1, \"cm\"),\n      axis_param = list(\n        side = \"right\",\n        facing = \"inside\",\n        gp = gpar(\n          fontsize = 7,\n          lwd = 0.4\n        )\n      )\n    )\n  )\n)\n}\n\n\n\natac_11h &lt;- make_EH(norm_mat = mat_ATAC$ATAC_11half, hm_name = \"AS-E11.5\", col_fill = \"#ffcccc\")\natac_15h &lt;- make_EH(norm_mat = mat_ATAC$ATAC_15half, hm_name = \"AS-E15.5\", col_fill = \"#e6fff2\")\n\n\n\nh3k4me3_11h &lt;- make_EH(norm_mat = mat_H3K4me3$H3K4me3_11half, hm_name = \"K4me3-E11.5\", col_fill = \"#ffcccc\",\n                       heatmap_cols = c(\"white\", \"darkgreen\"))\nh3k4me3_15h &lt;- make_EH(norm_mat = mat_H3K4me3$H3K4me3_15half, hm_name = \"K4me3-E15.5\", col_fill = \"#e6fff2\",\n                       heatmap_cols = c(\"white\", \"darkgreen\"))\n\n\n\nh3k4me1_11h &lt;- make_EH(norm_mat = mat_H3K4me1$H3K4me1_11half, hm_name = \"K4me1-E11.5\", col_fill = \"#ffcccc\",\n                       heatmap_cols = c(\"white\", \"blue\"))\nh3k4me1_15h &lt;- make_EH(norm_mat = mat_H3K4me1$H3K4me1_15half, hm_name = \"K4me1-E15.5\", col_fill = \"#e6fff2\",\n                       heatmap_cols = c(\"white\", \"blue\"))\n\n\n\nh3k27me3_11h &lt;- make_EH(norm_mat = mat_H3K27me3$H3K27me3_11half, hm_name = \"K27me3-E11.5\", col_fill = \"#ffcccc\",\n                        heatmap_cols = c(\"white\", \"purple\"))\nh3k27me3_15h &lt;- make_EH(norm_mat = mat_H3K27me3$H3K27me3_15half, hm_name = \"K27me3-E15.5\", col_fill = \"#e6fff2\",\n                        heatmap_cols = c(\"white\", \"purple\"))\n\n\n\nh3k27ac_11h &lt;- make_EH(norm_mat = mat_H3K27ac$H3K27ac_11half, hm_name = \"K27ac-E11.5\", col_fill = \"#ffcccc\",\n                       heatmap_cols = c(\"white\", \"brown\"))\nh3k27ac_15h &lt;- make_EH(norm_mat = mat_H3K27ac$H3K27ac_15half, hm_name = \"K27ac-E15.5\", col_fill = \"#e6fff2\",\n                       heatmap_cols = c(\"white\", \"brown\"))\n\n\n\nmeth_11h &lt;- make_EH(norm_mat = mat_BS$WGBS_11half, hm_name = \"BS-E11.5\", col_fill = \"#ffcccc\",\n                    heatmap_cols = c(\"red\", \"white\", \"blue\"))\nmeth_15h &lt;- make_EH(norm_mat = mat_BS$WGBS_15half, hm_name = \"BS-E15.5\", col_fill = \"#e6fff2\",\n                    heatmap_cols = c(\"red\", \"white\", \"blue\"))\n\n\n\nsplit_anno &lt;- overlap$ATAC_RNA\nnames(split_anno) &lt;- names(overlap)\n\nunique(split_anno)\n\n [1] \"Active Promoters\"    \"Inc. Acc.\"           \"Dec. Acc.\"          \n [4] \"Incongruent\"         \"Silent\"              \"Active\"             \n [7] \"Repressed\"           \"Gained Enhancers\"    \"Lost Enhancers\"     \n[10] \"Repressed Promoters\"\n\nsplit_anno &lt;- factor(split_anno, levels = unique(split_anno)[c(1,10,6,7,8,9,5,4,2,3)])\n\ncols_an &lt;- RColorBrewer::brewer.pal(n = length(unique(split_anno)), name = \"Paired\")\n\nrow_order_eh &lt;- row_order(atac_11h)\n\nanno_hm &lt;- Heatmap(\n  mat = split_anno,\n  col = cols_an, \n  name = \"Annotation\",\n  show_row_names = FALSE, \n  show_column_names = FALSE, \n  width = unit(2, \"mm\"),\n  height = unit(8, \"cm\"),\n  row_order = row_order_eh,\n  row_title_gp = gpar(fontsize = 0)\n)\n\nThere are 10 unique colors in the vector `col` and 10 unique values in\n`matrix`. `Heatmap()` will treat it as an exact discrete one-to-one\nmapping. If this is not what you want, slightly change the number of\ncolors, e.g. by adding one more color or removing a color.\n\n\n\n\nrna_hm &lt;- Heatmap(matrix = mat_RNA, \n        name = \"RNA\", \n        cluster_columns = FALSE, \n        cluster_rows = FALSE,\n        na_col = \"grey\",\n        row_order = row_order_eh,\n        show_row_names = FALSE, \n        show_column_names = FALSE,\n        row_title_rot = 0,\n        top_annotation = HeatmapAnnotation(\n          df = colData(rna)[,2,drop = FALSE], \n          annotation_name_gp = gpar(fontsize = 0)\n        ),\n        width = unit(2, \"cm\"),\n        height = unit(18, \"cm\"),\n        heatmap_legend_param = list(\n          legend_height = unit(0.5, \"cm\"),\n          legend_width = unit(0.1, \"cm\"),\n          at = c(-10,0,10), \n          title = \"RNA\",\n          title_gp = gpar(fontsize = 8),\n          labels_gp = gpar(fontsize = 7)\n        )\n)\n\n\n\nht_opt$TITLE_PADDING &lt;- unit(1, \"mm\")\nht_opt$legend_gap &lt;- unit(3, \"mm\")\nht_opt$legend_grid_height &lt;- unit(2, \"mm\")\nht_opt$legend_grid_width &lt;- unit(2, \"mm\")\nht_opt$HEATMAP_LEGEND_PADDING &lt;- unit(1, \"mm\")\nht_opt$heatmap_border &lt;- TRUE\n\ndraw(\n  anno_hm + \n    atac_11h + atac_15h + \n    h3k4me3_11h + h3k4me3_15h + \n    h3k4me1_11h + h3k4me1_15h + \n    h3k27me3_11h + h3k27me3_15h + \n    h3k27ac_11h + h3k27ac_15h + \n    rna_hm +\n    meth_11h + meth_15h, \n  split = split_anno, \n  merge_legend = FALSE,\n  heatmap_legend_side = \"bottom\"\n)\n\n\npdf(file = \"output/final_heatmap.pdf\", width = 22, height = 17)\ngrid.newpage()\npushViewport(viewport(gp = gpar(lwd = 0.5)))\ndraw(\n  anno_hm + \n    atac_11h + atac_15h + \n    h3k4me3_11h + h3k4me3_15h + \n    h3k4me1_11h + h3k4me1_15h + \n    h3k27me3_11h + h3k27me3_15h + \n    h3k27ac_11h + h3k27ac_15h + \n    rna_hm +\n    meth_11h + meth_15h, \n  split = split_anno, \n  merge_legend = FALSE,\n  heatmap_legend_side = \"bottom\"\n)\npopViewport()\n\ndev.off()\n\nquartz_off_screen \n                2 \n\npng(filename = \"output/final_heatmap.png\", width = 27, height = 22, units = \"in\", res = 330)\ngrid.newpage()\npushViewport(viewport(gp = gpar(lwd = 0.5)))\ndraw(\n  anno_hm + \n    atac_11h + atac_15h + \n    h3k4me3_11h + h3k4me3_15h + \n    h3k4me1_11h + h3k4me1_15h + \n    h3k27me3_11h + h3k27me3_15h + \n    h3k27ac_11h + h3k27ac_15h + \n    rna_hm +\n    meth_11h + meth_15h, \n  split = split_anno, \n  merge_legend = FALSE,\n  heatmap_legend_side = \"bottom\"\n)\npopViewport()\n\ndev.off()\n\nquartz_off_screen \n                2 \n\n\n\nLook at the plot carefully and try to understand patterns. Can you confirm from the plot that the plot is correct for the Active Promoters?\n\n\n\n\n\n\nImportant\n\n\n\nYou can make all possible categories from this overlapMatrix. Feel free to make more categories."
  },
  {
    "objectID": "day2/day2-3_multiomics.html#load-libraries",
    "href": "day2/day2-3_multiomics.html#load-libraries",
    "title": "Exercise 6",
    "section": "",
    "text": "library(ComplexHeatmap)\nlibrary(EnrichedHeatmap)\nlibrary(circlize)\nlibrary(SummarizedExperiment)"
  },
  {
    "objectID": "day2/day2-3_multiomics.html#load-required-objects-from-previous-exercises",
    "href": "day2/day2-3_multiomics.html#load-required-objects-from-previous-exercises",
    "title": "Exercise 6",
    "section": "",
    "text": "Here we load the SummarizedExperiment for the ChIP-seq data\n\natac &lt;- readRDS(\"data/atac_se.rds\")\nh3k4me3 &lt;- readRDS(\"data/h3k4me3_se.rds\")\nh3k4me1 &lt;- readRDS(\"data/h3k4me1_se.rds\")\nh3k27me3 &lt;- readRDS(\"data/h3k27me3_se.rds\")\nh3k27ac &lt;- readRDS(\"data/h3k27ac_se.rds\")\nrna &lt;- readRDS(\"data/rna_se.rds\")\nrownames(colData(rna)) &lt;- gsub(pattern = \"\\\\.tsv.gz\", replacement = \"\", x = rownames(colData(rna)))\n\noverlap &lt;- readRDS(\"output/overlap_anno.rds\")\n\nmat_ATAC &lt;- readRDS(\"./output/mat_atac.rds\")\nmat_RNA &lt;- readRDS(\"./output/mat_rna.rds\")\nmat_H3K4me3 &lt;- readRDS(\"./output/mat_h3k4me3.rds\")\nmat_H3K4me1 &lt;- readRDS(\"./output/mat_h3k4me1.rds\")\nmat_H3K27me3 &lt;- readRDS(\"./output/mat_h3k27me3.rds\")\nmat_H3K27ac &lt;- readRDS(\"./output/mat_h3k27ac.rds\")\nmat_BS &lt;- readRDS(\"./output/mat_bs.rds\")"
  },
  {
    "objectID": "day2/day2-3_multiomics.html#regulatory-regions",
    "href": "day2/day2-3_multiomics.html#regulatory-regions",
    "title": "Exercise 6",
    "section": "",
    "text": "logFC_cols &lt;- grep(pattern = \"logFC\", x = colnames(elementMetadata(overlap)))\nmcols(overlap)[, logFC_cols] &lt;- lapply(mcols(overlap)[, logFC_cols, drop = FALSE], function(x) {\n  x[is.na(x)] &lt;- 0\n  return(x)\n})\n\ngained_enhancers &lt;- overlap$ATAC_logFC &gt; 0 & \n  overlap$H3K4me1_logFC &gt; 0 & \n  overlap$H3K27ac_logFC &gt; 0 & \n  is.na(overlap$H3K4me3_annotation) &\n  overlap$ATAC_distanceToTSS &gt; 2500 & \n  overlap$RNA_logFC &gt; 0\n\noverlap$ATAC_RNA[gained_enhancers] &lt;- \"Gained Enhancers\""
  },
  {
    "objectID": "day2/day2-3_multiomics.html#lost-enhancers-e15.5-e11.5",
    "href": "day2/day2-3_multiomics.html#lost-enhancers-e15.5-e11.5",
    "title": "Exercise 6",
    "section": "",
    "text": "lost_enhancers &lt;- overlap$ATAC_logFC &lt; 0 & \n  overlap$H3K4me1_logFC &lt; 0 & \n  overlap$H3K27ac_logFC &lt; 0 & \n  is.na(overlap$H3K4me3_annotation) &\n  overlap$ATAC_distanceToTSS &gt; 2500 & \n  overlap$RNA_logFC &lt; 0\n\noverlap$ATAC_RNA[lost_enhancers] &lt;- \"Lost Enhancers\""
  },
  {
    "objectID": "day2/day2-3_multiomics.html#activated-promoters-e15.5-e11.5",
    "href": "day2/day2-3_multiomics.html#activated-promoters-e15.5-e11.5",
    "title": "Exercise 6",
    "section": "",
    "text": "active_promoters &lt;- overlap$ATAC_logFC &gt; 0 & \n  overlap$H3K4me3_logFC &gt; 0 & \n  overlap$H3K27ac_logFC &gt; 0 & \n  overlap$ATAC_distanceToTSS &lt; 2500 & \n  overlap$RNA_logFC &gt; 0\n\noverlap$ATAC_RNA[active_promoters] &lt;- \"Active Promoters\""
  },
  {
    "objectID": "day2/day2-3_multiomics.html#repressed-promoters-e15.5-e11.5",
    "href": "day2/day2-3_multiomics.html#repressed-promoters-e15.5-e11.5",
    "title": "Exercise 6",
    "section": "",
    "text": "repressed_promoters &lt;- overlap$ATAC_logFC &lt; 0 & \n  overlap$H3K4me3_logFC &lt; 0 & \n  overlap$H3K27ac_logFC &lt; 0 & \n  overlap$H3K27me3_logFC &gt; 0 & \n  overlap$ATAC_distanceToTSS &lt; 2500 & \n  overlap$RNA_logFC &lt; 0\n\noverlap$ATAC_RNA[repressed_promoters] &lt;- \"Repressed Promoters\""
  },
  {
    "objectID": "day2/day2-3_multiomics.html#save-the-file",
    "href": "day2/day2-3_multiomics.html#save-the-file",
    "title": "Exercise 6",
    "section": "",
    "text": "saveRDS(object = overlap, file = \"output/overlap_anno2.rds\")"
  },
  {
    "objectID": "day2/day2-3_multiomics.html#enrichedheatmap-complexheatmap",
    "href": "day2/day2-3_multiomics.html#enrichedheatmap-complexheatmap",
    "title": "Exercise 6",
    "section": "",
    "text": "make_EH &lt;- function(norm_mat, heatmap_cols = c(\"white\", \"red\"), split_rows = NULL, hm_name, col_fill = \"#ffcccc\"){\n  \n  if(length(heatmap_cols) == 2){\n    col_fun &lt;- colorRamp2(quantile(norm_mat, c(0.01, 0.99), na.rm = T), heatmap_cols)   \n  } else if(length(heatmap_cols) == 3){\n  col_fun &lt;- colorRamp2(quantile(mat_BS$WGBS_11half, c(0.01, 0.5, 0.99), na.rm = T), heatmap_cols)\n  } else{\n    message(\"Please update function!\")\n  }\n  \n  vmin &lt;- as.numeric(quantile(norm_mat, c(0.01), na.rm = T))\n  vmax &lt;- as.numeric(quantile(norm_mat, c(0.99), na.rm = T))\n  vmid &lt;- (vmin + vmax) / 2\n  legend_ticks &lt;- c(vmin, vmid, vmax)\n\nEnrichedHeatmap(\n  mat = norm_mat,\n  name = hm_name,\n  row_split = split_rows,\n  col = col_fun,\n  width = unit(2, \"cm\"),\n  height = unit(8, \"cm\"),\n  column_title = hm_name,\n  column_title_gp = gpar(fontsize = 8, fill = col_fill),\n  axis_name = c(\"-1kb\", \"mid\", \"1kb\"),\n  heatmap_legend_param = list(\n    at = legend_ticks,\n    legend_height = unit(0.5, \"cm\"),\n    legend_width = unit(0.1, \"cm\"),\n    labels = round(legend_ticks, digits = 1),\n    title_gp = gpar(fontsize = 8),\n    labels_gp = gpar(fontsize = 7)\n  ),\n  top_annotation = HeatmapAnnotation(\n    lines = anno_enriched(\n      height = unit(1, \"cm\"),\n      axis_param = list(\n        side = \"right\",\n        facing = \"inside\",\n        gp = gpar(\n          fontsize = 7,\n          lwd = 0.4\n        )\n      )\n    )\n  )\n)\n}\n\n\n\natac_11h &lt;- make_EH(norm_mat = mat_ATAC$ATAC_11half, hm_name = \"AS-E11.5\", col_fill = \"#ffcccc\")\natac_15h &lt;- make_EH(norm_mat = mat_ATAC$ATAC_15half, hm_name = \"AS-E15.5\", col_fill = \"#e6fff2\")\n\n\n\nh3k4me3_11h &lt;- make_EH(norm_mat = mat_H3K4me3$H3K4me3_11half, hm_name = \"K4me3-E11.5\", col_fill = \"#ffcccc\",\n                       heatmap_cols = c(\"white\", \"darkgreen\"))\nh3k4me3_15h &lt;- make_EH(norm_mat = mat_H3K4me3$H3K4me3_15half, hm_name = \"K4me3-E15.5\", col_fill = \"#e6fff2\",\n                       heatmap_cols = c(\"white\", \"darkgreen\"))\n\n\n\nh3k4me1_11h &lt;- make_EH(norm_mat = mat_H3K4me1$H3K4me1_11half, hm_name = \"K4me1-E11.5\", col_fill = \"#ffcccc\",\n                       heatmap_cols = c(\"white\", \"blue\"))\nh3k4me1_15h &lt;- make_EH(norm_mat = mat_H3K4me1$H3K4me1_15half, hm_name = \"K4me1-E15.5\", col_fill = \"#e6fff2\",\n                       heatmap_cols = c(\"white\", \"blue\"))\n\n\n\nh3k27me3_11h &lt;- make_EH(norm_mat = mat_H3K27me3$H3K27me3_11half, hm_name = \"K27me3-E11.5\", col_fill = \"#ffcccc\",\n                        heatmap_cols = c(\"white\", \"purple\"))\nh3k27me3_15h &lt;- make_EH(norm_mat = mat_H3K27me3$H3K27me3_15half, hm_name = \"K27me3-E15.5\", col_fill = \"#e6fff2\",\n                        heatmap_cols = c(\"white\", \"purple\"))\n\n\n\nh3k27ac_11h &lt;- make_EH(norm_mat = mat_H3K27ac$H3K27ac_11half, hm_name = \"K27ac-E11.5\", col_fill = \"#ffcccc\",\n                       heatmap_cols = c(\"white\", \"brown\"))\nh3k27ac_15h &lt;- make_EH(norm_mat = mat_H3K27ac$H3K27ac_15half, hm_name = \"K27ac-E15.5\", col_fill = \"#e6fff2\",\n                       heatmap_cols = c(\"white\", \"brown\"))\n\n\n\nmeth_11h &lt;- make_EH(norm_mat = mat_BS$WGBS_11half, hm_name = \"BS-E11.5\", col_fill = \"#ffcccc\",\n                    heatmap_cols = c(\"red\", \"white\", \"blue\"))\nmeth_15h &lt;- make_EH(norm_mat = mat_BS$WGBS_15half, hm_name = \"BS-E15.5\", col_fill = \"#e6fff2\",\n                    heatmap_cols = c(\"red\", \"white\", \"blue\"))\n\n\n\nsplit_anno &lt;- overlap$ATAC_RNA\nnames(split_anno) &lt;- names(overlap)\n\nunique(split_anno)\n\n [1] \"Active Promoters\"    \"Inc. Acc.\"           \"Dec. Acc.\"          \n [4] \"Incongruent\"         \"Silent\"              \"Active\"             \n [7] \"Repressed\"           \"Gained Enhancers\"    \"Lost Enhancers\"     \n[10] \"Repressed Promoters\"\n\nsplit_anno &lt;- factor(split_anno, levels = unique(split_anno)[c(1,10,6,7,8,9,5,4,2,3)])\n\ncols_an &lt;- RColorBrewer::brewer.pal(n = length(unique(split_anno)), name = \"Paired\")\n\nrow_order_eh &lt;- row_order(atac_11h)\n\nanno_hm &lt;- Heatmap(\n  mat = split_anno,\n  col = cols_an, \n  name = \"Annotation\",\n  show_row_names = FALSE, \n  show_column_names = FALSE, \n  width = unit(2, \"mm\"),\n  height = unit(8, \"cm\"),\n  row_order = row_order_eh,\n  row_title_gp = gpar(fontsize = 0)\n)\n\nThere are 10 unique colors in the vector `col` and 10 unique values in\n`matrix`. `Heatmap()` will treat it as an exact discrete one-to-one\nmapping. If this is not what you want, slightly change the number of\ncolors, e.g. by adding one more color or removing a color.\n\n\n\n\nrna_hm &lt;- Heatmap(matrix = mat_RNA, \n        name = \"RNA\", \n        cluster_columns = FALSE, \n        cluster_rows = FALSE,\n        na_col = \"grey\",\n        row_order = row_order_eh,\n        show_row_names = FALSE, \n        show_column_names = FALSE,\n        row_title_rot = 0,\n        top_annotation = HeatmapAnnotation(\n          df = colData(rna)[,2,drop = FALSE], \n          annotation_name_gp = gpar(fontsize = 0)\n        ),\n        width = unit(2, \"cm\"),\n        height = unit(18, \"cm\"),\n        heatmap_legend_param = list(\n          legend_height = unit(0.5, \"cm\"),\n          legend_width = unit(0.1, \"cm\"),\n          at = c(-10,0,10), \n          title = \"RNA\",\n          title_gp = gpar(fontsize = 8),\n          labels_gp = gpar(fontsize = 7)\n        )\n)\n\n\n\nht_opt$TITLE_PADDING &lt;- unit(1, \"mm\")\nht_opt$legend_gap &lt;- unit(3, \"mm\")\nht_opt$legend_grid_height &lt;- unit(2, \"mm\")\nht_opt$legend_grid_width &lt;- unit(2, \"mm\")\nht_opt$HEATMAP_LEGEND_PADDING &lt;- unit(1, \"mm\")\nht_opt$heatmap_border &lt;- TRUE\n\ndraw(\n  anno_hm + \n    atac_11h + atac_15h + \n    h3k4me3_11h + h3k4me3_15h + \n    h3k4me1_11h + h3k4me1_15h + \n    h3k27me3_11h + h3k27me3_15h + \n    h3k27ac_11h + h3k27ac_15h + \n    rna_hm +\n    meth_11h + meth_15h, \n  split = split_anno, \n  merge_legend = FALSE,\n  heatmap_legend_side = \"bottom\"\n)\n\n\npdf(file = \"output/final_heatmap.pdf\", width = 22, height = 17)\ngrid.newpage()\npushViewport(viewport(gp = gpar(lwd = 0.5)))\ndraw(\n  anno_hm + \n    atac_11h + atac_15h + \n    h3k4me3_11h + h3k4me3_15h + \n    h3k4me1_11h + h3k4me1_15h + \n    h3k27me3_11h + h3k27me3_15h + \n    h3k27ac_11h + h3k27ac_15h + \n    rna_hm +\n    meth_11h + meth_15h, \n  split = split_anno, \n  merge_legend = FALSE,\n  heatmap_legend_side = \"bottom\"\n)\npopViewport()\n\ndev.off()\n\nquartz_off_screen \n                2 \n\npng(filename = \"output/final_heatmap.png\", width = 27, height = 22, units = \"in\", res = 330)\ngrid.newpage()\npushViewport(viewport(gp = gpar(lwd = 0.5)))\ndraw(\n  anno_hm + \n    atac_11h + atac_15h + \n    h3k4me3_11h + h3k4me3_15h + \n    h3k4me1_11h + h3k4me1_15h + \n    h3k27me3_11h + h3k27me3_15h + \n    h3k27ac_11h + h3k27ac_15h + \n    rna_hm +\n    meth_11h + meth_15h, \n  split = split_anno, \n  merge_legend = FALSE,\n  heatmap_legend_side = \"bottom\"\n)\npopViewport()\n\ndev.off()\n\nquartz_off_screen \n                2"
  },
  {
    "objectID": "day2/day2-3_multiomics.html#question",
    "href": "day2/day2-3_multiomics.html#question",
    "title": "Exercise 6",
    "section": "",
    "text": "Look at the plot carefully and try to understand patterns. Can you confirm from the plot that the plot is correct for the Active Promoters?\n\n\n\n\n\n\nImportant\n\n\n\nYou can make all possible categories from this overlapMatrix. Feel free to make more categories."
  },
  {
    "objectID": "index.html#teachers",
    "href": "index.html#teachers",
    "title": "Biology-informed Multiomics Data Integration and Visualization",
    "section": "Teachers",
    "text": "Teachers\n\nDeepak Tanwar ORCiD"
  },
  {
    "objectID": "index.html#authors",
    "href": "index.html#authors",
    "title": "Biology-informed Multiomics Data Integration and Visualization",
    "section": "Authors",
    "text": "Authors\n\nDeepak Tanwar ORCiD\nGeert van Geest ORCiD\nPatricia Palagi ORCiD"
  },
  {
    "objectID": "index.html#license-copyright",
    "href": "index.html#license-copyright",
    "title": "Biology-informed Multiomics Data Integration and Visualization",
    "section": "License & copyright",
    "text": "License & copyright\nLicense: CC BY 4.0\nCopyright: SIB Swiss Institute of Bioinformatics"
  },
  {
    "objectID": "index.html#learning-outcomes",
    "href": "index.html#learning-outcomes",
    "title": "Biology-informed Multiomics Data Integration and Visualization",
    "section": "Learning outcomes",
    "text": "Learning outcomes\n\nGeneral learning outcomes\nAt the end of the course, the participants are expected to:\n\nImport and integrate pre-processed ATAC-seq, RNA-seq, ChIP-seq, and Bisulfite-seq data using R and Bioconductor packages.\nGenerate and interpret overlap matrices to identify regions of co-occurrence and regulation.\nPerform functional analysis of the results.\nCreate informative and visually appealing plots to represent multi-omics data.\n\n\n\nLearning outcomes explained\nTo reach the general learning outcomes above, we have set a number of smaller learning outcomes. Each chapter starts with these smaller learning outcomes. Use these at the start of a chapter to get an idea what you will learn. Use them also at the end of a chapter to evaluate whether you have learned what you were expected to learn."
  },
  {
    "objectID": "index.html#learning-experiences",
    "href": "index.html#learning-experiences",
    "title": "Biology-informed Multiomics Data Integration and Visualization",
    "section": "Learning experiences",
    "text": "Learning experiences\nTo reach the learning outcomes we will use lectures, exercises, polls and group work. During exercises, you are free to discuss with other participants. During lectures, focus on the lecture only.\n\nExercises\nEach block has practical work involved. Some more than others. The practicals are subdivided into chapters, and we’ll have a (short) discussion after each chapter. All answers to the practicals are incorporated, but they are hidden. Do the exercise first by yourself, before checking out the answer. If your answer is different from the answer in the practicals, try to figure out why they are different."
  }
]