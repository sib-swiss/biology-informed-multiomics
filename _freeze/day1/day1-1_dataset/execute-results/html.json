{
  "hash": "89d6037761a64ad4bef3e65120876faa",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Exercise 1\"\neditor: source\neditor_options: \n  chunk_output_type: console\n---\n\n# Datasets, `SummarizedExperiment`, and `GRanges`\n\n## Learning Outcomes\n\nBy the end of this notebook, you will be able to:\n\n- Understand the structure of `SummarizedExperiment` and `GRanges` objects in R.\n- Access and manipulate metadata and assays within `SummarizedExperiment`.\n- Visualize and subset genomic intervals using `GRanges`.\n- Recognize how even RNA expression data can be stored as genomic ranges.\n\n::: {.callout-note}\n**Note:** Genomic data types like RNA-seq are often stored as `SummarizedExperiment` or `GRanges`, which are efficient for multi-omics integration.\n:::\n\n# Dataset for the course\nIn this course, we work with **multi-omics datasets** derived from the developing **mouse neural tube** at two developmental stages: **E11.5** and **E15.5**. These stages represent key transitions in central nervous system development. These datasets are downloaded and processed from the ENCODE project: [Mouse Development Matrix](https://www.encodeproject.org/mouse-development-matrix/?type=Experiment&status=released&related_series.@type=OrganismDevelopmentSeries&replicates.library.biosample.organism.scientific_name=Mus+musculus#neural_tube). For the sake of time and efficient computational usage, datasets are analyzed for only chromosomes 1 and 2.\n\nThe following chromatin and transcriptional profiling datasets are included, each with **two biological replicates per time point**:\n\n| Assay        | Description                                                 | E11.5 | E15.5 |\n| ------------ | ----------------------------------------------------------- | ----- | ----- |\n| **ATAC-seq** | Chromatin accessibility profiling                           | 2     | 2     |\n| **H3K4me3**  | Histone mark at active promoters                            | 2     | 2     |\n| **H3K4me1**  | Histone mark at enhancers and poised regulatory elements    | 2     | 2     |\n| **H3K27me3** | Repressive histone modification (Polycomb repression)       | 2     | 2     |\n| **H3K27ac**  | Active enhancer and promoter histone mark                   | 2     | 2     |\n| **RNA-seq**  | Gene expression quantification via transcriptome sequencing | 2     | 2     |\n\nAll datasets are preprocessed and stored in **`SummarizedExperiment` (SE)** objects:\n\n* **Assays** contain count matrices (e.g., raw counts, logCPM).\n* **RowRanges** describe genomic coordinates (`GRanges`) for each feature (gene, peak, region).\n* **ColData** holds metadata for each sample (e.g., stage, replicate).\n\nThe use of SE objects enables consistent handling of multi-omics data, facilitates downstream integration, and supports interoperability with Bioconductor tools.\n\n* `SummarizedExperiment` enables structured storage of high-dimensional omics data and metadata.\n* `GRanges` makes it easy to manipulate and visualize genomic intervals across datasets.\n* Most analyses â€” from clustering to visualization â€” can be performed directly on these containers.\n\n\n## Download and Extract Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a new directory\ndir.create(\"data\")\n\n# Set download limit higher\noptions(timeout=1000)\n\n# Download file\ndownload.file(\n  url = \"https://biology-informed-multiomics.s3.eu-central-1.amazonaws.com/biology-informed-multiomics.tar\",\n  destfile = \"data/data.tar\"\n)\n\n# Unzip file\nuntar(tarfile = \"data/data.tar\", exdir = \"data\")\n\n# Remove tar file\nfile.remove(\"data/data.tar\")\n```\n:::\n\n\n## Load Libraries\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ComplexHeatmap)\nlibrary(SummarizedExperiment)\nlibrary(ggplot2)\n```\n:::\n\n\n## Load SummarizedExperiment Objects\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrna <- readRDS(\"data/rna_se.rds\")\natac <- readRDS(\"data/atac_se.rds\")\nh3k4me3 <- readRDS(\"data/h3k4me3_se.rds\")\nh3k4me1 <- readRDS(\"data/h3k4me1_se.rds\")\nh3k27me3 <- readRDS(\"data/h3k27me3_se.rds\")\nh3k27ac <- readRDS(\"data/h3k27ac_se.rds\")\n```\n:::\n\n\n---\n\n## ðŸ§ª Exercise 1: Working with `SummarizedExperiment` (SE)\n\n### 1. Inspect the RNA SE Object\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrna\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass: RangedSummarizedExperiment \ndim: 2216 4 \nmetadata(0):\nassays(2): counts logCPM\nrownames(2216): ENSMUSG00000000194 ENSMUSG00000000247 ...\n  ENSMUSG00000103948 ENSMUSG00000104257\nrowData names(18): Row.names gene_id ... PValue qvalue\ncolnames(4): RNA_11half_1.tsv.gz RNA_11half_2.tsv.gz\n  RNA_15half_1.tsv.gz RNA_15half_2.tsv.gz\ncolData names(2): sample group\n```\n\n\n:::\n:::\n\n\n### 2. Access `rowRanges`, `colData`, and `assays`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrowRanges(rna)[1:5]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGRanges object with 5 ranges and 18 metadata columns:\n                     seqnames              ranges strand |          Row.names\n                        <Rle>           <IRanges>  <Rle> |        <character>\n  ENSMUSG00000000194     chr2   31152316-31218775      + | ENSMUSG00000000194\n  ENSMUSG00000000247     chr2   38339281-38369733      + | ENSMUSG00000000247\n  ENSMUSG00000000305     chr2 179442431-179899373      + | ENSMUSG00000000305\n  ENSMUSG00000000308     chr2 121357714-121363737      + | ENSMUSG00000000308\n  ENSMUSG00000000359     chr2 152626951-152635198      + | ENSMUSG00000000359\n                         gene_id      SYMBOL               GENENAME\n                     <character> <character>            <character>\n  ENSMUSG00000000194      277463      Gpr107 G protein-coupled re..\n  ENSMUSG00000000247       16870        Lhx2 LIM homeobox protein 2\n  ENSMUSG00000000305       12561        Cdh4             cadherin 4\n  ENSMUSG00000000308       12716       Ckmt1 creatine kinase, mit..\n  ENSMUSG00000000359       19700        Rem1 rad and gem related ..\n                                ENSEMBL geneLength     geneChr geneStart\n                            <character>  <integer> <character> <integer>\n  ENSMUSG00000000194 ENSMUSG00000000194      66460        chr2  31152316\n  ENSMUSG00000000247 ENSMUSG00000000247      30453        chr2  38339281\n  ENSMUSG00000000305 ENSMUSG00000000305     456943        chr2 179442431\n  ENSMUSG00000000308 ENSMUSG00000000308       6024        chr2 121357714\n  ENSMUSG00000000359 ENSMUSG00000000359       8248        chr2 152626951\n                       geneEnd  geneStrand      geneId          transcriptId\n                     <integer> <character> <character>           <character>\n  ENSMUSG00000000194  31218775           +      277463  ENSMUST00000056433.6\n  ENSMUSG00000000247  38369733           +       16870  ENSMUST00000143783.8\n  ENSMUSG00000000305 179899373           +       12561 ENSMUST00000000314.12\n  ENSMUSG00000000308 121363737           +       12716  ENSMUST00000125812.7\n  ENSMUSG00000000359 152635198           +       19700  ENSMUST00000000369.3\n                            anno     logFC    logCPM         F      PValue\n                     <character> <numeric> <numeric> <numeric>   <numeric>\n  ENSMUSG00000000194        Gene   1.12372   8.74812 137.26552 8.72516e-05\n  ENSMUSG00000000247        Gene  -1.60859   5.40640  11.86742 1.87646e-02\n  ENSMUSG00000000305        Gene   2.11822   9.25294 504.51658 3.72434e-06\n  ENSMUSG00000000308        Gene   3.79826   8.63364 420.96960 5.79582e-06\n  ENSMUSG00000000359        Gene   1.90855   3.12253   2.67341 1.64139e-01\n                          qvalue\n                       <numeric>\n  ENSMUSG00000000194 0.000834921\n  ENSMUSG00000000247 0.033322641\n  ENSMUSG00000000305 0.000490337\n  ENSMUSG00000000308 0.000490337\n  ENSMUSG00000000359 0.211786009\n  -------\n  seqinfo: 66 sequences from an unspecified genome; no seqlengths\n```\n\n\n:::\n\n```{.r .cell-code}\ncolData(rna)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nDataFrame with 4 rows and 2 columns\n                                 sample    group\n                            <character> <factor>\nRNA_11half_1.tsv.gz RNA_11half_1.tsv.gz   11half\nRNA_11half_2.tsv.gz RNA_11half_2.tsv.gz   11half\nRNA_15half_1.tsv.gz RNA_15half_1.tsv.gz   15half\nRNA_15half_2.tsv.gz RNA_15half_2.tsv.gz   15half\n```\n\n\n:::\n\n```{.r .cell-code}\nassay(rna)[1:5,]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                   RNA_11half_1.tsv.gz RNA_11half_2.tsv.gz RNA_15half_1.tsv.gz\nENSMUSG00000000194                 848              893.35             2619.55\nENSMUSG00000000247                 169              246.00               51.00\nENSMUSG00000000305                 694              778.00             4431.00\nENSMUSG00000000308                 148              195.00             3011.00\nENSMUSG00000000359                   8               13.00              101.00\n                   RNA_15half_2.tsv.gz\nENSMUSG00000000194             3046.41\nENSMUSG00000000247              153.00\nENSMUSG00000000305             5102.00\nENSMUSG00000000308             4131.00\nENSMUSG00000000359               16.00\n```\n\n\n:::\n\n```{.r .cell-code}\nassays(rna)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nList of length 2\nnames(2): counts logCPM\n```\n\n\n:::\n:::\n\n\n### 3. Boxplot of Expression for a Few Genes\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- as.data.frame(t(assay(rna)[1:5, ]))\ndf$sample <- rownames(df)\ndf_long <- pivot_longer(df, -sample, names_to = \"gene\", values_to = \"expression\")\n\nggplot(df_long, aes(x = gene, y = expression)) +\n  geom_boxplot(aes(fill = gene)) +\n  theme_bw() +\n  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +\n  labs(title = \"Expression Distribution of Selected Genes\",\n       y = \"Expression\", x = \"Genes\") +\n  scale_fill_brewer(palette = \"Set2\")\n```\n\n::: {.cell-output-display}\n![](day1-1_dataset_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n## Question 1\n\n**Please make a `boxplot` of samples, before and after normalization.**\n\n_Hint:_ Check `assays` of `rna` object. Raw counts should be converted to `log2` to make a comparison.\n\n::: {.callout-tip collapse=\"true\"}\n\n### Answer\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Extract assays\nraw_counts <- assay(rna, \"counts\")\nlogcpm <- assay(rna, \"logCPM\")\n\n# Convert to long data frames for ggplot\ndf_raw <- as.data.frame(raw_counts)\ndf_raw$gene <- rownames(df_raw)\ndf_raw_long <- pivot_longer(df_raw, -gene, names_to = \"sample\", values_to = \"expression\")\ndf_raw_long$assay <- \"Raw Counts\"\ndf_raw_long$expression <- log2(df_raw_long$expression + 1)\n\ndf_log <- as.data.frame(logcpm)\ndf_log$gene <- rownames(df_log)\ndf_log_long <- pivot_longer(df_log, -gene, names_to = \"sample\", values_to = \"expression\")\ndf_log_long$assay <- \"logCPM\"\n\n# Combine both\ndf_combined <- rbind(df_raw_long, df_log_long)\n\n# Set factor for names to make Raw counts to be plotted first\ndf_combined$assay <- factor(df_combined$assay, levels = unique(df_combined$assay))\n\n# Plot boxplot across samples\nggplot(df_combined, aes(x = sample, y = expression, fill = assay)) +\n  geom_boxplot(outlier.size = 0.5, lwd = 0.3) +\n  theme_bw() +\n  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +\n  facet_wrap(~ assay, scales = \"free_y\") +\n  labs(title = \"Sample-wise Expression: Raw vs Normalized\",\n       x = \"Samples\", y = \"Expression\") +\n  scale_fill_brewer(palette = \"Set2\")\n```\n\n::: {.cell-output-display}\n![](day1-1_dataset_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n:::\n\n## Question 2\n\n**Make a new `SummarizedExperiment` object by subsetting `rna`. Take only first 2 samples and first 10 genes. Check the `assays`, row and column metadata.**\n\n::: {.callout-tip collapse=\"true\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrna_subset <- rna[1:10, 1:2]\nrna_subset\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass: RangedSummarizedExperiment \ndim: 10 2 \nmetadata(0):\nassays(2): counts logCPM\nrownames(10): ENSMUSG00000000194 ENSMUSG00000000247 ...\n  ENSMUSG00000000827 ENSMUSG00000000876\nrowData names(18): Row.names gene_id ... PValue qvalue\ncolnames(2): RNA_11half_1.tsv.gz RNA_11half_2.tsv.gz\ncolData names(2): sample group\n```\n\n\n:::\n\n```{.r .cell-code}\nassays(rna_subset)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nList of length 2\nnames(2): counts logCPM\n```\n\n\n:::\n\n```{.r .cell-code}\nassay(rna_subset, \"counts\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                   RNA_11half_1.tsv.gz RNA_11half_2.tsv.gz\nENSMUSG00000000194              848.00              893.35\nENSMUSG00000000247              169.00              246.00\nENSMUSG00000000305              694.00              778.00\nENSMUSG00000000308              148.00              195.00\nENSMUSG00000000359                8.00               13.00\nENSMUSG00000000392              349.00              333.00\nENSMUSG00000000823             1851.87             2077.29\nENSMUSG00000000826             5908.00             7011.00\nENSMUSG00000000827             2788.23             2998.49\nENSMUSG00000000876              374.00              400.00\n```\n\n\n:::\n\n```{.r .cell-code}\nassay(rna_subset, \"logCPM\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                   RNA_11half_1.tsv.gz RNA_11half_2.tsv.gz\nENSMUSG00000000194            8.086697            8.068900\nENSMUSG00000000247            5.764953            6.211847\nENSMUSG00000000305            7.797861            7.869643\nENSMUSG00000000308            5.574463            5.877929\nENSMUSG00000000359            1.491187            2.054079\nENSMUSG00000000392            6.807747            6.647445\nENSMUSG00000000823            9.212828            9.285543\nENSMUSG00000000826           10.886099           11.040056\nENSMUSG00000000827            9.802991            9.814900\nENSMUSG00000000876            6.907344            6.911323\n```\n\n\n:::\n\n```{.r .cell-code}\ncolData(rna_subset)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nDataFrame with 2 rows and 2 columns\n                                 sample    group\n                            <character> <factor>\nRNA_11half_1.tsv.gz RNA_11half_1.tsv.gz   11half\nRNA_11half_2.tsv.gz RNA_11half_2.tsv.gz   11half\n```\n\n\n:::\n\n```{.r .cell-code}\nrowData(rna_subset)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nDataFrame with 10 rows and 18 columns\n                            Row.names     gene_id      SYMBOL\n                          <character> <character> <character>\nENSMUSG00000000194 ENSMUSG00000000194      277463      Gpr107\nENSMUSG00000000247 ENSMUSG00000000247       16870        Lhx2\nENSMUSG00000000305 ENSMUSG00000000305       12561        Cdh4\nENSMUSG00000000308 ENSMUSG00000000308       12716       Ckmt1\nENSMUSG00000000359 ENSMUSG00000000359       19700        Rem1\nENSMUSG00000000392 ENSMUSG00000000392       14089         Fap\nENSMUSG00000000823 ENSMUSG00000000823      269401     Zfp512b\nENSMUSG00000000826 ENSMUSG00000000826       13002      Dnajc5\nENSMUSG00000000827 ENSMUSG00000000827       66314     Tpd52l2\nENSMUSG00000000876 ENSMUSG00000000876       59038       Pxmp4\n                                 GENENAME            ENSEMBL geneLength\n                              <character>        <character>  <integer>\nENSMUSG00000000194 G protein-coupled re.. ENSMUSG00000000194      66460\nENSMUSG00000000247 LIM homeobox protein 2 ENSMUSG00000000247      30453\nENSMUSG00000000305             cadherin 4 ENSMUSG00000000305     456943\nENSMUSG00000000308 creatine kinase, mit.. ENSMUSG00000000308       6024\nENSMUSG00000000359 rad and gem related .. ENSMUSG00000000359       8248\nENSMUSG00000000392 fibroblast activatio.. ENSMUSG00000000392      73133\nENSMUSG00000000823 zinc finger protein .. ENSMUSG00000000823      10701\nENSMUSG00000000826 DnaJ heat shock prot.. ENSMUSG00000000826      34649\nENSMUSG00000000827 tumor protein D52-li.. ENSMUSG00000000827      20825\nENSMUSG00000000876 peroxisomal membrane.. ENSMUSG00000000876      17951\n                       geneChr geneStart   geneEnd  geneStrand      geneId\n                   <character> <integer> <integer> <character> <character>\nENSMUSG00000000194        chr2  31152316  31218775           +      277463\nENSMUSG00000000247        chr2  38339281  38369733           +       16870\nENSMUSG00000000305        chr2 179442431 179899373           +       12561\nENSMUSG00000000308        chr2 121357714 121363737           +       12716\nENSMUSG00000000359        chr2 152626951 152635198           +       19700\nENSMUSG00000000392        chr2  62500943  62574075           -       14089\nENSMUSG00000000823        chr2 181582103 181592803           -      269401\nENSMUSG00000000826        chr2 181520485 181555133           +       13002\nENSMUSG00000000827        chr2 181497142 181517966           +       66314\nENSMUSG00000000876        chr2 154585758 154603708           -       59038\n                            transcriptId        anno     logFC    logCPM\n                             <character> <character> <numeric> <numeric>\nENSMUSG00000000194  ENSMUST00000056433.6        Gene  1.123717   8.74812\nENSMUSG00000000247  ENSMUST00000143783.8        Gene -1.608592   5.40640\nENSMUSG00000000305 ENSMUST00000000314.12        Gene  2.118219   9.25294\nENSMUSG00000000308  ENSMUST00000125812.7        Gene  3.798256   8.63364\nENSMUSG00000000359  ENSMUST00000000369.3        Gene  1.908545   3.12253\nENSMUSG00000000392  ENSMUST00000102732.9        Gene -2.102269   6.02595\nENSMUSG00000000823  ENSMUST00000108789.8        Gene  0.776790   9.69040\nENSMUSG00000000826 ENSMUST00000072334.11        Gene  0.991148  11.54446\nENSMUSG00000000827  ENSMUST00000184588.7        Gene -0.557763   9.55700\nENSMUSG00000000876 ENSMUST00000000896.10        Gene  0.304488   7.07357\n                           F      PValue      qvalue\n                   <numeric>   <numeric>   <numeric>\nENSMUSG00000000194 137.26552 8.72516e-05 0.000834921\nENSMUSG00000000247  11.86742 1.87646e-02 0.033322641\nENSMUSG00000000305 504.51658 3.72434e-06 0.000490337\nENSMUSG00000000308 420.96960 5.79582e-06 0.000490337\nENSMUSG00000000359   2.67341 1.64139e-01 0.211786009\nENSMUSG00000000392  82.37588 2.92695e-04 0.001579555\nENSMUSG00000000823  21.64298 5.77573e-03 0.012874947\nENSMUSG00000000826  77.71581 3.35396e-04 0.001683051\nENSMUSG00000000827  46.64975 1.08655e-03 0.003701948\nENSMUSG00000000876   4.36632 9.17564e-02 0.127276923\n```\n\n\n:::\n\n```{.r .cell-code}\nrowRanges(rna_subset)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGRanges object with 10 ranges and 18 metadata columns:\n                     seqnames              ranges strand |          Row.names\n                        <Rle>           <IRanges>  <Rle> |        <character>\n  ENSMUSG00000000194     chr2   31152316-31218775      + | ENSMUSG00000000194\n  ENSMUSG00000000247     chr2   38339281-38369733      + | ENSMUSG00000000247\n  ENSMUSG00000000305     chr2 179442431-179899373      + | ENSMUSG00000000305\n  ENSMUSG00000000308     chr2 121357714-121363737      + | ENSMUSG00000000308\n  ENSMUSG00000000359     chr2 152626951-152635198      + | ENSMUSG00000000359\n  ENSMUSG00000000392     chr2   62500943-62574075      - | ENSMUSG00000000392\n  ENSMUSG00000000823     chr2 181582103-181592803      - | ENSMUSG00000000823\n  ENSMUSG00000000826     chr2 181520485-181555133      + | ENSMUSG00000000826\n  ENSMUSG00000000827     chr2 181497142-181517966      + | ENSMUSG00000000827\n  ENSMUSG00000000876     chr2 154585758-154603708      - | ENSMUSG00000000876\n                         gene_id      SYMBOL               GENENAME\n                     <character> <character>            <character>\n  ENSMUSG00000000194      277463      Gpr107 G protein-coupled re..\n  ENSMUSG00000000247       16870        Lhx2 LIM homeobox protein 2\n  ENSMUSG00000000305       12561        Cdh4             cadherin 4\n  ENSMUSG00000000308       12716       Ckmt1 creatine kinase, mit..\n  ENSMUSG00000000359       19700        Rem1 rad and gem related ..\n  ENSMUSG00000000392       14089         Fap fibroblast activatio..\n  ENSMUSG00000000823      269401     Zfp512b zinc finger protein ..\n  ENSMUSG00000000826       13002      Dnajc5 DnaJ heat shock prot..\n  ENSMUSG00000000827       66314     Tpd52l2 tumor protein D52-li..\n  ENSMUSG00000000876       59038       Pxmp4 peroxisomal membrane..\n                                ENSEMBL geneLength     geneChr geneStart\n                            <character>  <integer> <character> <integer>\n  ENSMUSG00000000194 ENSMUSG00000000194      66460        chr2  31152316\n  ENSMUSG00000000247 ENSMUSG00000000247      30453        chr2  38339281\n  ENSMUSG00000000305 ENSMUSG00000000305     456943        chr2 179442431\n  ENSMUSG00000000308 ENSMUSG00000000308       6024        chr2 121357714\n  ENSMUSG00000000359 ENSMUSG00000000359       8248        chr2 152626951\n  ENSMUSG00000000392 ENSMUSG00000000392      73133        chr2  62500943\n  ENSMUSG00000000823 ENSMUSG00000000823      10701        chr2 181582103\n  ENSMUSG00000000826 ENSMUSG00000000826      34649        chr2 181520485\n  ENSMUSG00000000827 ENSMUSG00000000827      20825        chr2 181497142\n  ENSMUSG00000000876 ENSMUSG00000000876      17951        chr2 154585758\n                       geneEnd  geneStrand      geneId          transcriptId\n                     <integer> <character> <character>           <character>\n  ENSMUSG00000000194  31218775           +      277463  ENSMUST00000056433.6\n  ENSMUSG00000000247  38369733           +       16870  ENSMUST00000143783.8\n  ENSMUSG00000000305 179899373           +       12561 ENSMUST00000000314.12\n  ENSMUSG00000000308 121363737           +       12716  ENSMUST00000125812.7\n  ENSMUSG00000000359 152635198           +       19700  ENSMUST00000000369.3\n  ENSMUSG00000000392  62574075           -       14089  ENSMUST00000102732.9\n  ENSMUSG00000000823 181592803           -      269401  ENSMUST00000108789.8\n  ENSMUSG00000000826 181555133           +       13002 ENSMUST00000072334.11\n  ENSMUSG00000000827 181517966           +       66314  ENSMUST00000184588.7\n  ENSMUSG00000000876 154603708           -       59038 ENSMUST00000000896.10\n                            anno     logFC    logCPM         F      PValue\n                     <character> <numeric> <numeric> <numeric>   <numeric>\n  ENSMUSG00000000194        Gene  1.123717   8.74812 137.26552 8.72516e-05\n  ENSMUSG00000000247        Gene -1.608592   5.40640  11.86742 1.87646e-02\n  ENSMUSG00000000305        Gene  2.118219   9.25294 504.51658 3.72434e-06\n  ENSMUSG00000000308        Gene  3.798256   8.63364 420.96960 5.79582e-06\n  ENSMUSG00000000359        Gene  1.908545   3.12253   2.67341 1.64139e-01\n  ENSMUSG00000000392        Gene -2.102269   6.02595  82.37588 2.92695e-04\n  ENSMUSG00000000823        Gene  0.776790   9.69040  21.64298 5.77573e-03\n  ENSMUSG00000000826        Gene  0.991148  11.54446  77.71581 3.35396e-04\n  ENSMUSG00000000827        Gene -0.557763   9.55700  46.64975 1.08655e-03\n  ENSMUSG00000000876        Gene  0.304488   7.07357   4.36632 9.17564e-02\n                          qvalue\n                       <numeric>\n  ENSMUSG00000000194 0.000834921\n  ENSMUSG00000000247 0.033322641\n  ENSMUSG00000000305 0.000490337\n  ENSMUSG00000000308 0.000490337\n  ENSMUSG00000000359 0.211786009\n  ENSMUSG00000000392 0.001579555\n  ENSMUSG00000000823 0.012874947\n  ENSMUSG00000000826 0.001683051\n  ENSMUSG00000000827 0.003701948\n  ENSMUSG00000000876 0.127276923\n  -------\n  seqinfo: 66 sequences from an unspecified genome; no seqlengths\n```\n\n\n:::\n:::\n\n\n:::\n\n\n## Question 3\n\n**Try to run all other commands from the following image on other `SE` objects as well**\n\n![](../assets/images/se.svg)\n\n---\n\n## ðŸ§ª Exercise 2: Working with `GRanges`\n\n### 1. Extract and Inspect `GRanges` from ATAC-seq\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngr <- rowRanges(atac)\ngr\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGRanges object with 3656 ranges and 18 metadata columns:\n         seqnames              ranges strand |             annotation   geneChr\n            <Rle>           <IRanges>  <Rle> |            <character> <integer>\n     [1]     chr1     3670547-3672665      * |       Promoter (<=1kb)         1\n     [2]     chr1     4332510-4332710      * | Intron (ENSMUST00000..         1\n     [3]     chr1     4491755-4492573      * |       Promoter (1-2kb)         1\n     [4]     chr1     4571186-4572423      * |      Distal Intergenic         1\n     [5]     chr1     4785062-4786325      * |       Promoter (<=1kb)         1\n     ...      ...                 ...    ... .                    ...       ...\n  [3652]     chr2 181764664-181764891      * |       Promoter (1-2kb)         2\n  [3653]     chr2 181766881-181767875      * |       Promoter (<=1kb)         2\n  [3654]     chr2 181837244-181838655      * |       Promoter (<=1kb)         2\n  [3655]     chr2 181863853-181865066      * |       Promoter (<=1kb)         2\n  [3656]     chr2 181918525-181918853      * |      Distal Intergenic         2\n         geneStart   geneEnd geneLength geneStrand      geneId\n         <integer> <integer>  <integer>  <integer> <character>\n     [1]   3214482   3671498     457017          2      497097\n     [2]   4344146   4360314      16169          2       19888\n     [3]   4492465   4493735       1271          2       20671\n     [4]   4491390   4497354       5965          2       20671\n     [5]   4773206   4785710      12505          2       27395\n     ...       ...       ...        ...        ...         ...\n  [3652] 181763332 181827797      64466          1       17932\n  [3653] 181767029 181795892      28864          1       17932\n  [3654] 181837854 181857461      19608          1      245867\n  [3655] 181864337 181870830       6494          1       67005\n  [3656] 181864360 181866209       1850          1       67005\n                  transcriptId distanceToTSS            ENSEMBL      SYMBOL\n                   <character>     <numeric>        <character> <character>\n     [1]  ENSMUST00000070533.4             0 ENSMUSG00000051951        Xkr4\n     [2]  ENSMUST00000027032.5         27604 ENSMUSG00000025900         Rp1\n     [3]  ENSMUST00000191939.1          1162 ENSMUSG00000025902       Sox17\n     [4]  ENSMUST00000192650.5        -73832 ENSMUSG00000025902       Sox17\n     [5]  ENSMUST00000130201.7             0 ENSMUSG00000033845      Mrpl15\n     ...                   ...           ...                ...         ...\n  [3652] ENSMUST00000081125.10          1332 ENSMUSG00000010505        Myt1\n  [3653]  ENSMUST00000156190.7             0 ENSMUSG00000010505        Myt1\n  [3654] ENSMUST00000029116.13             0 ENSMUSG00000027589      Pcmtd2\n  [3655]  ENSMUST00000039551.8             0 ENSMUSG00000038628      Polr3k\n  [3656]  ENSMUST00000153214.1         54165 ENSMUSG00000038628      Polr3k\n                       GENENAME        anno     logFC    logCPM         F\n                    <character> <character> <numeric> <numeric> <numeric>\n     [1] X-linked Kx blood gr..    Promoter  0.602984  10.45378  41.78446\n     [2] retinitis pigmentosa..      Intron  0.855748   5.18424   3.68371\n     [3] SRY (sex determining..    Promoter -0.620926   7.13469   9.14522\n     [4] SRY (sex determining..  Intergenic -0.511046   8.90885  15.15688\n     [5] mitochondrial riboso..    Promoter  0.540908   8.63469  15.08892\n     ...                    ...         ...       ...       ...       ...\n  [3652] myelin transcription..    Promoter -1.275275   5.54135  10.44866\n  [3653] myelin transcription..    Promoter  0.477658   7.56969   6.03877\n  [3654] protein-L-isoasparta..    Promoter  0.689247   7.92175  16.67881\n  [3655] polymerase (RNA) III..    Promoter  0.241693   9.05746   4.06676\n  [3656] polymerase (RNA) III..  Intergenic  0.394577   6.84745   2.73331\n              PValue      qvalue\n           <numeric>   <numeric>\n     [1] 6.58453e-08 4.81983e-07\n     [2] 6.13517e-02 9.28785e-02\n     [3] 4.12368e-03 8.38540e-03\n     [4] 3.27158e-04 8.67115e-04\n     [5] 3.36058e-04 8.82634e-04\n     ...         ...         ...\n  [3652] 0.002309221  0.00497558\n  [3653] 0.017945118  0.03116850\n  [3654] 0.000181039  0.00051468\n  [3655] 0.049773014  0.07677364\n  [3656] 0.105289776  0.15077925\n  -------\n  seqinfo: 21 sequences from an unspecified genome; no seqlengths\n```\n\n\n:::\n:::\n\n\n### 2. Subset Regions on chr1 with Width > 1000 bp\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsubset_gr <- gr[seqnames(gr) == \"chr1\" & width(gr) > 1000]\nsubset_gr\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGRanges object with 838 ranges and 18 metadata columns:\n        seqnames              ranges strand |        annotation   geneChr\n           <Rle>           <IRanges>  <Rle> |       <character> <integer>\n    [1]     chr1     3670547-3672665      * |  Promoter (<=1kb)         1\n    [2]     chr1     4571186-4572423      * | Distal Intergenic         1\n    [3]     chr1     4785062-4786325      * |  Promoter (<=1kb)         1\n    [4]     chr1     4807268-4808558      * |  Promoter (<=1kb)         1\n    [5]     chr1     4857303-4858480      * |  Promoter (<=1kb)         1\n    ...      ...                 ...    ... .               ...       ...\n  [834]     chr1 193968000-193969035      * | Distal Intergenic         1\n  [835]     chr1 194160689-194161978      * | Distal Intergenic         1\n  [836]     chr1 194619386-194621007      * |  Promoter (<=1kb)         1\n  [837]     chr1 194879295-194880523      * | Distal Intergenic         1\n  [838]     chr1 194976000-194977461      * |  Promoter (<=1kb)         1\n        geneStart   geneEnd geneLength geneStrand      geneId\n        <integer> <integer>  <integer>  <integer> <character>\n    [1]   3214482   3671498     457017          2      497097\n    [2]   4491390   4497354       5965          2       20671\n    [3]   4773206   4785710      12505          2       27395\n    [4]   4807788   4848410      40623          1       18777\n    [5]   4857814   4897905      40092          1       21399\n    ...       ...       ...        ...        ...         ...\n  [834] 194212187 194222759      10573          2       74942\n  [835] 194212187 194222759      10573          2       74942\n  [836] 194619825 194816869     197045          1       18845\n  [837] 194822001 194822064         64          1   100628615\n  [838] 194955759 194976960      21202          2      320400\n                 transcriptId distanceToTSS            ENSEMBL        SYMBOL\n                  <character>     <numeric>        <character>   <character>\n    [1]  ENSMUST00000070533.4             0 ENSMUSG00000051951          Xkr4\n    [2]  ENSMUST00000192650.5        -73832 ENSMUSG00000025902         Sox17\n    [3]  ENSMUST00000130201.7             0 ENSMUSG00000033845        Mrpl15\n    [4]  ENSMUST00000134384.7             0 ENSMUSG00000025903        Lypla1\n    [5] ENSMUST00000081551.13             0 ENSMUSG00000033813         Tcea1\n    ...                   ...           ...                ...           ...\n  [834]  ENSMUST00000193395.1        253724 ENSMUSG00000103692 4930503O07Rik\n  [835]  ENSMUST00000193395.1         60781 ENSMUSG00000103692 4930503O07Rik\n  [836] ENSMUST00000027952.11             0 ENSMUSG00000026640        Plxna2\n  [837]  ENSMUST00000174892.1         57294 ENSMUSG00000092633       Mir3962\n  [838]  ENSMUST00000180780.2             0 ENSMUSG00000097325       Gm16897\n                      GENENAME        anno      logFC    logCPM         F\n                   <character> <character>  <numeric> <numeric> <numeric>\n    [1] X-linked Kx blood gr..    Promoter  0.6029841  10.45378 41.784460\n    [2] SRY (sex determining..  Intergenic -0.5110459   8.90885 15.156883\n    [3] mitochondrial riboso..    Promoter  0.5409079   8.63469 15.088922\n    [4]    lysophospholipase 1    Promoter  0.0485083   9.02241  0.158018\n    [5] transcription elonga..    Promoter  0.4092797   9.92134 14.681270\n    ...                    ...         ...        ...       ...       ...\n  [834] RIKEN cDNA 4930503O0..  Intergenic   1.789029   6.37400  36.41420\n  [835] RIKEN cDNA 4930503O0..  Intergenic  -2.621150   7.53898 143.60529\n  [836]              plexin A2    Promoter  -0.444863   9.24715  14.79019\n  [837]          microRNA 3962  Intergenic  -1.195438   6.95062  28.66158\n  [838]  predicted gene, 16897    Promoter  -0.246053   8.75503   3.60378\n             PValue      qvalue\n          <numeric>   <numeric>\n    [1] 6.58453e-08 4.81983e-07\n    [2] 3.27158e-04 8.67115e-04\n    [3] 3.36058e-04 8.82634e-04\n    [4] 6.92882e-01 7.45491e-01\n    [5] 3.95063e-04 1.01572e-03\n    ...         ...         ...\n  [834] 2.85224e-07 1.73797e-06\n  [835] 1.50833e-15 1.77316e-13\n  [836] 3.78302e-04 9.79514e-04\n  [837] 2.86565e-06 1.28866e-05\n  [838] 6.41228e-02 9.63951e-02\n  -------\n  seqinfo: 21 sequences from an unspecified genome; no seqlengths\n```\n\n\n:::\n:::\n\n\n### 3. Plot Width Distribution of Genomic Ranges\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_gr <- as.data.frame(gr)\n\nggplot(df_gr, aes(x = width)) +\n  geom_histogram(bins = 50, fill = \"#3366cc\", color = \"white\") +\n  theme_minimal() +\n  labs(title = \"Width Distribution of Genomic Ranges\",\n       x = \"Width (bp)\", y = \"Count\")\n```\n\n::: {.cell-output-display}\n![](day1-1_dataset_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n---\n\n## ðŸ”Ž Bonus: Heatmap of H3K27ac Signal\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmat <- assay(h3k27ac)\n\nHeatmap(mat[1:50, ],\n        name = \"H3K27ac\",\n        show_row_names = FALSE,\n        show_column_names = TRUE,\n        cluster_rows = TRUE,\n        cluster_columns = TRUE)\n```\n\n::: {.cell-output-display}\n![](day1-1_dataset_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n## Question 4\n\n**Try to run all other commands from the following image on other `GRanges` from `SE` objects as well**\n\n![](../assets/images/gr.png)\n\n\n::: {.callout-important}\nUnderstanding how different omics layers are represented in `SE` and `GRanges` objects is essential for multi-omics integration, visualization, and downstream analysis.\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}