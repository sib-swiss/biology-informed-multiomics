{
  "hash": "5e7ca907ac5dac95296aab59c323ff94",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Exercise 7\"\neditor_options: \n  chunk_output_type: console\nformat: docx\n---\n\n# Enrichment analysis\n\n## Load Libraries\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rGREAT)\nlibrary(TxDb.Mmusculus.UCSC.mm10.knownGene)\nlibrary(org.Mm.eg.db)\nlibrary(simplifyEnrichment)\nlibrary(flexclust)\n```\n:::\n\n\n\n## OverlapMatrix\n\n::: {.cell}\n\n```{.r .cell-code}\noverlap <- readRDS(\"output/overlap_anno2.rds\")\n```\n:::\n\n\n## Running enrichment analysis\n\n::: {.cell}\n\n```{.r .cell-code}\ngr <- overlap[overlap$ATAC_RNA == \"Active Promoters\"]\nres <- great(gr, \"BP\", \"mm10\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n* TSS source: TxDb.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n* check whether TxDb package 'TxDb.Mmusculus.UCSC.mm10.knownGene' is installed.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n* gene ID type in the extended TSS is 'Entrez Gene ID'.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n* restrict chromosomes to 'chr1, chr2, chr3, chr4, chr5, chr6, chr7, chr8, chr9, chr10,\n    chr11, chr12, chr13, chr14, chr15, chr16, chr17, chr18, chr19, chrX, chrY, chrM'.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n* 20593/24515 protein-coding genes left.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n* update seqinfo to the selected chromosomes.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n* TSS extension mode is 'basalPlusExt'.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n* construct the basal domains by extending 5000bp to upstream and 1000bp to downsteram of TSS.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n* calculate distances to neighbour regions.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n* extend to both sides until reaching the neighbour genes or to the maximal extension.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n* use GO:BP ontology with 15445 gene sets (source: org.Mm.eg.db).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n* check gene ID type in `gene_sets` and in `extended_tss`.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n* use whole genome as background.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n* remove excluded regions from background.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n* overlap `gr` to background regions (based on midpoint).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n* in total 99 `gr`.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n* overlap extended TSS to background regions.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n* check which genes are in the gene sets.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n* only take gene sets with size >= 5.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n* in total 9412 gene sets.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n* overlap `gr` to every extended TSS.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n* perform binomial test for each biological term.\n```\n\n\n:::\n\n```{.r .cell-code}\nplotVolcano(res)\n```\n\n::: {.cell-output-display}\n![](day2-4_enrichment_analysis_files/figure-docx/unnamed-chunk-3-1.png)\n:::\n\n```{.r .cell-code}\nplotRegionGeneAssociations(res)\n```\n\n::: {.cell-output-display}\n![](day2-4_enrichment_analysis_files/figure-docx/unnamed-chunk-3-2.png)\n:::\n\n```{.r .cell-code}\ngetRegionGeneAssociations(res)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGRanges object with 99 ranges and 112 metadata columns:\n            seqnames              ranges strand |        ATAC_annotation\n               <Rle>           <IRanges>  <Rle> |            <character>\n     peak_1     chr1     3670547-3672665      * |       Promoter (<=1kb)\n    peak_14     chr1     9298449-9300284      * |       Promoter (<=1kb)\n    peak_69     chr1   25228208-25229714      * |       Promoter (<=1kb)\n    peak_70     chr1   25504015-25505076      * | Exon (ENSMUST0000014..\n    peak_83     chr1   34578812-34580363      * |       Promoter (<=1kb)\n        ...      ...                 ...    ... .                    ...\n  peak_1902     chr2 178175169-178175887      * |       Promoter (<=1kb)\n  peak_1922     chr2 181134082-181135787      * |       Promoter (<=1kb)\n  peak_1923     chr2 181156149-181157204      * |       Promoter (<=1kb)\n  peak_1925     chr2 181313272-181314836      * |       Promoter (<=1kb)\n  peak_1930     chr2 181714476-181715931      * |       Promoter (<=1kb)\n            ATAC_geneChr ATAC_geneStart ATAC_geneEnd ATAC_geneLength\n               <integer>      <integer>    <integer>       <integer>\n     peak_1            1        3214482      3671498          457017\n    peak_14            1        8361475      9298573          937099\n    peak_69            1       25067476     25228826          161351\n    peak_70            1       25276404     25277954            1551\n    peak_83            1       34579657     34590944           11288\n        ...          ...            ...          ...             ...\n  peak_1902            2      178175349    178336491          161143\n  peak_1922            2      181075579    181135214           59636\n  peak_1923            2      181147653    181157014            9362\n  peak_1925            2      181306459    181314500            8042\n  peak_1930            2      181715016    181720985            5970\n            ATAC_geneStrand ATAC_geneId     ATAC_transcriptId\n                  <integer> <character>           <character>\n     peak_1               2      497097  ENSMUST00000070533.4\n    peak_14               2       71096  ENSMUST00000132064.7\n    peak_69               2      210933  ENSMUST00000126626.7\n    peak_70               2   100504323  ENSMUST00000193138.1\n    peak_83               1      211383 ENSMUST00000052670.10\n        ...             ...         ...                   ...\n  peak_1902               1       74189  ENSMUST00000108915.7\n  peak_1922               2       16536  ENSMUST00000149964.8\n  peak_1923               2       13628  ENSMUST00000055990.7\n  peak_1925               2       20262  ENSMUST00000103045.3\n  peak_1930               1       18389  ENSMUST00000071585.9\n            ATAC_distanceToTSS       ATAC_ENSEMBL ATAC_SYMBOL\n                     <numeric>        <character> <character>\n     peak_1                  0 ENSMUSG00000051951        Xkr4\n    peak_14                  0 ENSMUSG00000025909       Sntg1\n    peak_69                  0 ENSMUSG00000033569      Adgrb3\n    peak_70            -226061 ENSMUSG00000104257     Gm20172\n    peak_83                  0 ENSMUSG00000045174       Amer3\n        ...                ...                ...         ...\n  peak_1902                  0 ENSMUSG00000027525     Phactr3\n  peak_1922                  0 ENSMUSG00000016346       Kcnq2\n  peak_1923                  0 ENSMUSG00000016349      Eef1a2\n  peak_1925                  0 ENSMUSG00000027581       Stmn3\n  peak_1930                  0 ENSMUSG00000027584       Oprl1\n                     ATAC_GENENAME   ATAC_anno ATAC_logFC ATAC_logCPM    ATAC_F\n                       <character> <character>  <numeric>   <numeric> <numeric>\n     peak_1 X-linked Kx blood gr..    Promoter   0.602984    10.45378  41.78446\n    peak_14    syntrophin, gamma 1    Promoter   0.960798     8.76438  46.46418\n    peak_69 adhesion G protein-c..    Promoter   0.986539     8.25070  40.79772\n    peak_70  predicted gene, 20172        Exon   0.802232     6.45404   8.85783\n    peak_83 APC membrane recruit..    Promoter   1.376255     8.69661  86.70410\n        ...                    ...         ...        ...         ...       ...\n  peak_1902 phosphatase and acti..    Promoter   0.714177     6.72118   8.78683\n  peak_1922 potassium voltage-ga..    Promoter   0.912713     8.10930  32.69152\n  peak_1923 eukaryotic translati..    Promoter   1.338590     7.82461  54.99971\n  peak_1925        stathmin-like 3    Promoter   0.892601     8.12151  30.64904\n  peak_1930 opioid receptor-like 1    Promoter   1.213349     7.47748  37.29439\n            ATAC_PValue ATAC_qvalue      RNA_Row.names RNA_gene_id  RNA_SYMBOL\n              <numeric>   <numeric>        <character> <character> <character>\n     peak_1 6.58453e-08 4.81983e-07 ENSMUSG00000051951      497097        Xkr4\n    peak_14 1.97965e-08 1.70296e-07 ENSMUSG00000025909       71096       Sntg1\n    peak_69 8.55724e-08 6.07481e-07 ENSMUSG00000033569      210933      Adgrb3\n    peak_70 4.69864e-03 9.38854e-03 ENSMUSG00000033569      210933      Adgrb3\n    peak_83 4.98564e-12 1.57133e-10 ENSMUSG00000045174      211383       Amer3\n        ...         ...         ...                ...         ...         ...\n  peak_1902 4.85335e-03 9.67494e-03 ENSMUSG00000027525       74189     Phactr3\n  peak_1922 8.37488e-07 4.46335e-06 ENSMUSG00000016346       16536       Kcnq2\n  peak_1923 2.58482e-09 2.97631e-08 ENSMUSG00000016349       13628      Eef1a2\n  peak_1925 1.54857e-06 7.67150e-06 ENSMUSG00000027581       20262       Stmn3\n  peak_1930 2.22741e-07 1.40677e-06 ENSMUSG00000027584       18389       Oprl1\n                      RNA_GENENAME        RNA_ENSEMBL RNA_geneLength\n                       <character>        <character>      <integer>\n     peak_1 X-linked Kx blood gr.. ENSMUSG00000051951         457017\n    peak_14    syntrophin, gamma 1 ENSMUSG00000025909         938404\n    peak_69 adhesion G protein-c.. ENSMUSG00000033569         762232\n    peak_70 adhesion G protein-c.. ENSMUSG00000033569         762232\n    peak_83 APC membrane recruit.. ENSMUSG00000045174          11288\n        ...                    ...                ...            ...\n  peak_1902 phosphatase and acti.. ENSMUSG00000027525         219518\n  peak_1922 potassium voltage-ga.. ENSMUSG00000016346          59722\n  peak_1923 eukaryotic translati.. ENSMUSG00000016349           9362\n  peak_1925        stathmin-like 3 ENSMUSG00000027581           8042\n  peak_1930 opioid receptor-like 1 ENSMUSG00000027584           5970\n            RNA_geneChr RNA_geneStart RNA_geneEnd RNA_geneStrand  RNA_geneId\n            <character>     <integer>   <integer>    <character> <character>\n     peak_1        chr1       3214482     3671498              -      497097\n    peak_14        chr1       8361475     9299878              -       71096\n    peak_69        chr1      25067476    25829707              -      210933\n    peak_70        chr1      25067476    25829707              -      210933\n    peak_83        chr1      34579657    34590944              +      211383\n        ...         ...           ...         ...            ...         ...\n  peak_1902        chr2     178118975   178338492              +       74189\n  peak_1922        chr2     181075579   181135300              -       16536\n  peak_1923        chr2     181147653   181157014              -       13628\n  peak_1925        chr2     181306459   181314500              -       20262\n  peak_1930        chr2     181715016   181720985              +       18389\n                 RNA_transcriptId    RNA_anno RNA_logFC RNA_logCPM     RNA_F\n                      <character> <character> <numeric>  <numeric> <numeric>\n     peak_1  ENSMUST00000070533.4        Gene   1.37498    5.62452   33.7077\n    peak_14  ENSMUST00000132064.7        Gene   4.03266    5.98830  192.7039\n    peak_69  ENSMUST00000126626.7        Gene   1.96492    8.73183  107.5339\n    peak_70  ENSMUST00000126626.7        Gene   1.96492    8.73183  107.5339\n    peak_83 ENSMUST00000052670.10        Gene   2.29007    8.17011  191.9172\n        ...                   ...         ...       ...        ...       ...\n  peak_1902  ENSMUST00000108917.7        Gene   1.75721    7.97049  103.8623\n  peak_1922  ENSMUST00000149964.8        Gene   1.08069    9.08113   43.8401\n  peak_1923  ENSMUST00000055990.7        Gene   4.06536    6.16441  278.0522\n  peak_1925  ENSMUST00000103045.3        Gene   1.87268   12.05944  135.2780\n  peak_1930  ENSMUST00000071585.9        Gene   1.87383    9.02372  145.0766\n             RNA_PValue  RNA_qvalue     H3K4me3_annotation H3K4me3_geneChr\n              <numeric>   <numeric>            <character>       <integer>\n     peak_1 2.24273e-03 0.006288707       Promoter (<=1kb)               1\n    peak_14 3.88128e-05 0.000618058       Promoter (<=1kb)               1\n    peak_69 1.56060e-04 0.001091928       Promoter (<=1kb)               1\n    peak_70 1.56060e-04 0.001091928 Exon (ENSMUST0000014..               1\n    peak_83 3.90118e-05 0.000618058       Promoter (<=1kb)               1\n        ...         ...         ...                    ...             ...\n  peak_1902 1.69461e-04 0.001152960       Promoter (<=1kb)               2\n  peak_1922 1.25004e-03 0.004047574       Promoter (<=1kb)               2\n  peak_1923 1.59710e-05 0.000490337       Promoter (<=1kb)               2\n  peak_1925 9.03474e-05 0.000834961       Promoter (<=1kb)               2\n  peak_1930 7.64282e-05 0.000816625       Promoter (<=1kb)               2\n            H3K4me3_geneStart H3K4me3_geneEnd H3K4me3_geneLength\n                    <integer>       <integer>          <integer>\n     peak_1           3214482         3671498             457017\n    peak_14           8361475         9298573             937099\n    peak_69          25067476        25228826             161351\n    peak_70          25276404        25277954               1551\n    peak_83          34579657        34590944              11288\n        ...               ...             ...                ...\n  peak_1902         178175349       178336491             161143\n  peak_1922         181075579       181135214              59636\n  peak_1923         181147653       181157014               9362\n  peak_1925         181306459       181314500               8042\n  peak_1930         181715016       181720985               5970\n            H3K4me3_geneStrand H3K4me3_geneId  H3K4me3_transcriptId\n                     <integer>    <character>           <character>\n     peak_1                  2         497097  ENSMUST00000070533.4\n    peak_14                  2          71096  ENSMUST00000132064.7\n    peak_69                  2         210933  ENSMUST00000126626.7\n    peak_70                  2      100504323  ENSMUST00000193138.1\n    peak_83                  1         211383 ENSMUST00000052670.10\n        ...                ...            ...                   ...\n  peak_1902                  1          74189  ENSMUST00000108915.7\n  peak_1922                  2          16536  ENSMUST00000149964.8\n  peak_1923                  2          13628  ENSMUST00000055990.7\n  peak_1925                  2          20262  ENSMUST00000103045.3\n  peak_1930                  1          18389  ENSMUST00000071585.9\n            H3K4me3_distanceToTSS    H3K4me3_ENSEMBL H3K4me3_SYMBOL\n                        <numeric>        <character>    <character>\n     peak_1                     0 ENSMUSG00000051951           Xkr4\n    peak_14                     0 ENSMUSG00000025909          Sntg1\n    peak_69                     0 ENSMUSG00000033569         Adgrb3\n    peak_70               -226252 ENSMUSG00000104257        Gm20172\n    peak_83                     0 ENSMUSG00000045174          Amer3\n        ...                   ...                ...            ...\n  peak_1902                    56 ENSMUSG00000027525        Phactr3\n  peak_1922                     0 ENSMUSG00000016346          Kcnq2\n  peak_1923                     0 ENSMUSG00000016349         Eef1a2\n  peak_1925                     0 ENSMUSG00000027581          Stmn3\n  peak_1930                     0 ENSMUSG00000027584          Oprl1\n                  H3K4me3_GENENAME H3K4me3_anno H3K4me3_logFC H3K4me3_logCPM\n                       <character>  <character>     <numeric>      <numeric>\n     peak_1 X-linked Kx blood gr..     Promoter      0.607114        9.26749\n    peak_14    syntrophin, gamma 1     Promoter      0.787977        8.64434\n    peak_69 adhesion G protein-c..     Promoter      1.205708        7.52475\n    peak_70  predicted gene, 20172         Exon      2.657731        2.48914\n    peak_83 APC membrane recruit..     Promoter      1.158232        8.07772\n        ...                    ...          ...           ...            ...\n  peak_1902 phosphatase and acti..     Promoter      1.655324        3.89074\n  peak_1922 potassium voltage-ga..     Promoter      0.750262        8.80515\n  peak_1923 eukaryotic translati..     Promoter      1.819209        7.73711\n  peak_1925        stathmin-like 3     Promoter      0.615019        8.78460\n  peak_1930 opioid receptor-like 1     Promoter      1.978607        7.54088\n            H3K4me3_F H3K4me3_PValue H3K4me3_qvalue H3K4me1_annotation\n            <numeric>      <numeric>      <numeric>        <character>\n     peak_1 135.44293    4.65079e-31    1.28968e-29               <NA>\n    peak_14 149.35508    4.76345e-34    1.46952e-32               <NA>\n    peak_69 146.70663    1.76407e-33    5.27723e-32               <NA>\n    peak_70   6.77423    9.26510e-03    2.58814e-02               <NA>\n    peak_83 203.92865    1.03211e-45    4.76122e-44               <NA>\n        ...       ...            ...            ...                ...\n  peak_1902    14.963    1.10494e-04    4.90024e-04               <NA>\n  peak_1922   151.440    1.69973e-34    5.34388e-33               <NA>\n  peak_1923   332.565    7.40439e-73    6.76816e-71   Promoter (<=1kb)\n  peak_1925   103.048    4.54823e-24    9.80353e-23   Promoter (<=1kb)\n  peak_1930   325.324    2.42880e-71    2.10325e-69   Promoter (<=1kb)\n            H3K4me1_geneChr H3K4me1_geneStart H3K4me1_geneEnd\n                  <integer>         <integer>       <integer>\n     peak_1            <NA>              <NA>            <NA>\n    peak_14            <NA>              <NA>            <NA>\n    peak_69            <NA>              <NA>            <NA>\n    peak_70            <NA>              <NA>            <NA>\n    peak_83            <NA>              <NA>            <NA>\n        ...             ...               ...             ...\n  peak_1902            <NA>              <NA>            <NA>\n  peak_1922            <NA>              <NA>            <NA>\n  peak_1923               2         181147653       181157014\n  peak_1925               2         181306459       181314500\n  peak_1930               2         181715703       181719372\n            H3K4me1_geneLength H3K4me1_geneStrand H3K4me1_geneId\n                     <integer>          <integer>    <character>\n     peak_1               <NA>               <NA>           <NA>\n    peak_14               <NA>               <NA>           <NA>\n    peak_69               <NA>               <NA>           <NA>\n    peak_70               <NA>               <NA>           <NA>\n    peak_83               <NA>               <NA>           <NA>\n        ...                ...                ...            ...\n  peak_1902               <NA>               <NA>           <NA>\n  peak_1922               <NA>               <NA>           <NA>\n  peak_1923               9362                  2          13628\n  peak_1925               8042                  2          20262\n  peak_1930               3670                  1          18389\n            H3K4me1_transcriptId H3K4me1_distanceToTSS    H3K4me1_ENSEMBL\n                     <character>             <numeric>        <character>\n     peak_1                 <NA>                    NA               <NA>\n    peak_14                 <NA>                    NA               <NA>\n    peak_69                 <NA>                    NA               <NA>\n    peak_70                 <NA>                    NA               <NA>\n    peak_83                 <NA>                    NA               <NA>\n        ...                  ...                   ...                ...\n  peak_1902                 <NA>                    NA               <NA>\n  peak_1922                 <NA>                    NA               <NA>\n  peak_1923 ENSMUST00000055990.7                   -64 ENSMUSG00000016349\n  peak_1925 ENSMUST00000103045.3                   911 ENSMUSG00000027581\n  peak_1930 ENSMUST00000184127.1                    38 ENSMUSG00000027584\n            H3K4me1_SYMBOL       H3K4me1_GENENAME H3K4me1_anno H3K4me1_logFC\n               <character>            <character>  <character>     <numeric>\n     peak_1           <NA>                   <NA>         <NA>             0\n    peak_14           <NA>                   <NA>         <NA>             0\n    peak_69           <NA>                   <NA>         <NA>             0\n    peak_70           <NA>                   <NA>         <NA>             0\n    peak_83           <NA>                   <NA>         <NA>             0\n        ...            ...                    ...          ...           ...\n  peak_1902           <NA>                   <NA>         <NA>      0.000000\n  peak_1922           <NA>                   <NA>         <NA>      0.000000\n  peak_1923         Eef1a2 eukaryotic translati..     Promoter      0.932761\n  peak_1925          Stmn3        stathmin-like 3     Promoter      0.612051\n  peak_1930          Oprl1 opioid receptor-like 1     Promoter      1.086359\n            H3K4me1_logCPM H3K4me1_F H3K4me1_PValue H3K4me1_qvalue\n                 <numeric> <numeric>      <numeric>      <numeric>\n     peak_1             NA        NA             NA             NA\n    peak_14             NA        NA             NA             NA\n    peak_69             NA        NA             NA             NA\n    peak_70             NA        NA             NA             NA\n    peak_83             NA        NA             NA             NA\n        ...            ...       ...            ...            ...\n  peak_1902             NA        NA             NA             NA\n  peak_1922             NA        NA             NA             NA\n  peak_1923        5.74097   20.7805    5.22563e-06    2.25916e-04\n  peak_1925        6.38866   15.0376    1.06225e-04    2.45541e-03\n  peak_1930        6.13490   36.7670    1.39101e-09    1.90365e-07\n            H3K27me3_annotation H3K27me3_geneChr H3K27me3_geneStart\n                    <character>        <integer>          <integer>\n     peak_1                <NA>             <NA>               <NA>\n    peak_14    Promoter (<=1kb)                1            8361475\n    peak_69                <NA>             <NA>               <NA>\n    peak_70                <NA>             <NA>               <NA>\n    peak_83    Promoter (<=1kb)                1           34579657\n        ...                 ...              ...                ...\n  peak_1902                <NA>             <NA>               <NA>\n  peak_1922    Promoter (<=1kb)                2          181080503\n  peak_1923    Promoter (<=1kb)                2          181147653\n  peak_1925    Promoter (<=1kb)                2          181306459\n  peak_1930                <NA>             <NA>               <NA>\n            H3K27me3_geneEnd H3K27me3_geneLength H3K27me3_geneStrand\n                   <integer>           <integer>           <integer>\n     peak_1             <NA>                <NA>                <NA>\n    peak_14          9299238              937764                   2\n    peak_69             <NA>                <NA>                <NA>\n    peak_70             <NA>                <NA>                <NA>\n    peak_83         34590944               11288                   1\n        ...              ...                 ...                 ...\n  peak_1902             <NA>                <NA>                <NA>\n  peak_1922        181134922               54420                   2\n  peak_1923        181157014                9362                   2\n  peak_1925        181314500                8042                   2\n  peak_1930             <NA>                <NA>                <NA>\n            H3K27me3_geneId H3K27me3_transcriptId H3K27me3_distanceToTSS\n                <character>           <character>              <numeric>\n     peak_1            <NA>                  <NA>                     NA\n    peak_14           71096  ENSMUST00000140295.7                      0\n    peak_69            <NA>                  <NA>                     NA\n    peak_70            <NA>                  <NA>                     NA\n    peak_83          211383 ENSMUST00000052670.10                   -733\n        ...             ...                   ...                    ...\n  peak_1902            <NA>                  <NA>                     NA\n  peak_1922           16536  ENSMUST00000103049.9                      0\n  peak_1923           13628  ENSMUST00000055990.7                      0\n  peak_1925           20262  ENSMUST00000103045.3                   -125\n  peak_1930            <NA>                  <NA>                     NA\n              H3K27me3_ENSEMBL H3K27me3_SYMBOL      H3K27me3_GENENAME\n                   <character>     <character>            <character>\n     peak_1               <NA>            <NA>                   <NA>\n    peak_14 ENSMUSG00000025909           Sntg1    syntrophin, gamma 1\n    peak_69               <NA>            <NA>                   <NA>\n    peak_70               <NA>            <NA>                   <NA>\n    peak_83 ENSMUSG00000045174           Amer3 APC membrane recruit..\n        ...                ...             ...                    ...\n  peak_1902               <NA>            <NA>                   <NA>\n  peak_1922 ENSMUSG00000016346           Kcnq2 potassium voltage-ga..\n  peak_1923 ENSMUSG00000016349          Eef1a2 eukaryotic translati..\n  peak_1925 ENSMUSG00000027581           Stmn3        stathmin-like 3\n  peak_1930               <NA>            <NA>                   <NA>\n            H3K27me3_anno H3K27me3_logFC H3K27me3_logCPM H3K27me3_F\n              <character>      <numeric>       <numeric>  <numeric>\n     peak_1          <NA>       0.000000              NA         NA\n    peak_14      Promoter      -0.578443         7.07069    8.17212\n    peak_69          <NA>       0.000000              NA         NA\n    peak_70          <NA>       0.000000              NA         NA\n    peak_83      Promoter      -0.926854         5.73161    7.12230\n        ...           ...            ...             ...        ...\n  peak_1902          <NA>        0.00000              NA         NA\n  peak_1922      Promoter       -1.01484         9.08503    81.5584\n  peak_1923      Promoter       -1.18230         8.57170    84.1744\n  peak_1925      Promoter       -1.14450         6.24934    16.4223\n  peak_1930          <NA>        0.00000              NA         NA\n            H3K27me3_PValue H3K27me3_qvalue     H3K27ac_annotation\n                  <numeric>       <numeric>            <character>\n     peak_1              NA              NA       Promoter (<=1kb)\n    peak_14      0.00426473       0.0616407       Promoter (<=1kb)\n    peak_69              NA              NA       Promoter (<=1kb)\n    peak_70              NA              NA Exon (ENSMUST0000014..\n    peak_83      0.00762819       0.0899976       Promoter (<=1kb)\n        ...             ...             ...                    ...\n  peak_1902              NA              NA       Promoter (<=1kb)\n  peak_1922     2.09500e-19     7.17349e-17       Promoter (<=1kb)\n  peak_1923     5.65224e-20     2.06724e-17       Promoter (<=1kb)\n  peak_1925     5.11572e-05     1.99691e-03       Promoter (<=1kb)\n  peak_1930              NA              NA       Promoter (<=1kb)\n            H3K27ac_geneChr H3K27ac_geneStart H3K27ac_geneEnd\n                  <integer>         <integer>       <integer>\n     peak_1               1           3214482         3671498\n    peak_14               1           8361475         9298573\n    peak_69               1          25067476        25228826\n    peak_70               1          25276404        25277954\n    peak_83               1          34579657        34590944\n        ...             ...               ...             ...\n  peak_1902               2         178175349       178336491\n  peak_1922               2         181080503       181134922\n  peak_1923               2         181147653       181157014\n  peak_1925               2         181306459       181314500\n  peak_1930               2         181715016       181720985\n            H3K27ac_geneLength H3K27ac_geneStrand H3K27ac_geneId\n                     <integer>          <integer>    <character>\n     peak_1             457017                  2         497097\n    peak_14             937099                  2          71096\n    peak_69             161351                  2         210933\n    peak_70               1551                  2      100504323\n    peak_83              11288                  1         211383\n        ...                ...                ...            ...\n  peak_1902             161143                  1          74189\n  peak_1922              54420                  2          16536\n  peak_1923               9362                  2          13628\n  peak_1925               8042                  2          20262\n  peak_1930               5970                  1          18389\n             H3K27ac_transcriptId H3K27ac_distanceToTSS    H3K27ac_ENSEMBL\n                      <character>             <numeric>        <character>\n     peak_1  ENSMUST00000070533.4                     0 ENSMUSG00000051951\n    peak_14  ENSMUST00000132064.7                     0 ENSMUSG00000025909\n    peak_69  ENSMUST00000126626.7                     0 ENSMUSG00000033569\n    peak_70  ENSMUST00000193138.1               -226214 ENSMUSG00000104257\n    peak_83 ENSMUST00000052670.10                     0 ENSMUSG00000045174\n        ...                   ...                   ...                ...\n  peak_1902  ENSMUST00000108915.7                     0 ENSMUSG00000027525\n  peak_1922  ENSMUST00000103049.9                     0 ENSMUSG00000016346\n  peak_1923  ENSMUST00000055990.7                     0 ENSMUSG00000016349\n  peak_1925  ENSMUST00000103045.3                     0 ENSMUSG00000027581\n  peak_1930  ENSMUST00000071585.9                     0 ENSMUSG00000027584\n            H3K27ac_SYMBOL       H3K27ac_GENENAME H3K27ac_anno H3K27ac_logFC\n               <character>            <character>  <character>     <numeric>\n     peak_1           Xkr4 X-linked Kx blood gr..     Promoter       1.25269\n    peak_14          Sntg1    syntrophin, gamma 1     Promoter       2.25132\n    peak_69         Adgrb3 adhesion G protein-c..     Promoter       1.71288\n    peak_70        Gm20172  predicted gene, 20172         Exon       2.45135\n    peak_83          Amer3 APC membrane recruit..     Promoter       1.44331\n        ...            ...                    ...          ...           ...\n  peak_1902        Phactr3 phosphatase and acti..     Promoter      1.382198\n  peak_1922          Kcnq2 potassium voltage-ga..     Promoter      0.909119\n  peak_1923         Eef1a2 eukaryotic translati..     Promoter      1.426917\n  peak_1925          Stmn3        stathmin-like 3     Promoter      1.337649\n  peak_1930          Oprl1 opioid receptor-like 1     Promoter      1.363849\n            H3K27ac_logCPM H3K27ac_F H3K27ac_PValue H3K27ac_qvalue        name\n                 <numeric> <numeric>      <numeric>      <numeric> <character>\n     peak_1        8.81735  151.4959    1.67395e-34    4.08130e-32      peak_1\n    peak_14        7.44136  188.6314    1.91288e-42    6.62156e-40     peak_14\n    peak_69        7.75798  148.3754    7.82086e-34    1.80483e-31     peak_69\n    peak_70        5.04358   34.5321    4.36085e-09    1.34796e-07     peak_70\n    peak_83        7.35920   86.0818    2.18441e-20    2.14293e-18     peak_83\n        ...            ...       ...            ...            ...         ...\n  peak_1902        6.22622   35.9816    2.07855e-09    6.74235e-08   peak_1902\n  peak_1922        8.31643   64.4153    1.15104e-15    7.72601e-14   peak_1922\n  peak_1923        7.39512   86.2073    2.05151e-20    2.03730e-18   peak_1923\n  peak_1925        8.00741  111.4177    7.08864e-26    1.02853e-23   peak_1925\n  peak_1930        7.84616  104.9298    1.79151e-24    2.34334e-22   peak_1930\n                    ATAC_RNA   annotated_genes    dist_to_TSS\n                 <character>   <CharacterList>  <IntegerList>\n     peak_1 Active Promoters              Xkr4              0\n    peak_14 Active Promoters             Sntg1              0\n    peak_69 Active Promoters    Lmbrd1,Gm20172   549578,48240\n    peak_70 Active Promoters    Gm20172,Adgrb3 -226061,324631\n    peak_83 Active Promoters             Amer3              0\n        ...              ...               ...            ...\n  peak_1902 Active Promoters     Phactr3,Sycp2   56194,231798\n  peak_1922 Active Promoters      Chrna4,Kcnq2       -90536,0\n  peak_1923 Active Promoters            Eef1a2              0\n  peak_1925 Active Promoters Gmeb2,Stmn3,Rtel1 -25237,0,-4903\n  peak_1930 Active Promoters             Oprl1              0\n  -------\n  seqinfo: 21 sequences from an unspecified genome; no seqlengths\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshinyReport(res)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntb = getEnrichmentTable(res)\nsig_go_ids = tb$id[tb$p_adjust < 0.05]\ncl = simplifyGO(mat = sig_go_ids)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nYou haven't provided value for `ont`, guess it as `BP`.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nrelations: is_a, part_of, regulates, negatively_regulates, positively_regulates\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nIC_method: IC_annotation\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nterm_sim_method: Sim_XGraSM_2013\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nIC_method: IC_annotation\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCluster 33 terms by 'binary_cut'... 4 clusters, used 0.111398 secs.\n'magick' package is suggested to install to give better rasterization.\n\nSet `ht_opt$message = FALSE` to turn off this message.\nPerform keywords enrichment for 4 GO lists...\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](day2-4_enrichment_analysis_files/figure-docx/unnamed-chunk-5-1.png)\n:::\n:::\n\n\n### Output\n:::{.callout-important}\n- The heatmap shows clear clustering of GO terms into two main clusters, indicating distinct functional groups.\n\n- The GO terms on the right highlight biological processes relevant to neuronal and ion transport functions, such as transport, inorganic cation ion, exocytosis, synaptic, neurotransmitter, and behavior learning.\n\n- The cluster with terms like cytosolic concentration, calcium ion suggests a calcium-related signaling or ion homeostasis process at play.\n\n- The color gradient and similarity scores (up to ~0.6) indicate moderate similarity within clusters, which is reasonable for GO term groupings.\n:::\n\n### Interpretation\n:::{.callout-important}\n- E11.5 to E15.5 is a key window in neural development involving neuronal differentiation, synapse formation, and active signaling.\n\n- Active promoters linked to ion transport, synaptic transmission, calcium signaling are expected to be regulated during this developmental stage.\n\n- The clustering separating signaling and transport-related terms from behavior and learning terms also aligns with early neural circuit formation and functional maturation.\n:::\n\n\n## Question\n\n**Perform enrichment analysis of any other category.**",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}